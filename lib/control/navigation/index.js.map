{"version":3,"file":"index.js","sources":["src/components/control/navigation/icon/VcIconSvg.vue?rollup-plugin-vue=script.js","src/components/control/navigation/icon/VcIconSvg.vue","src/components/control/navigation/icon/compass-outer.js","src/components/control/navigation/icon/compass-inner.js","src/components/control/navigation/icon/compass-rotation-marker.js","src/components/control/navigation/VcCompass.vue?rollup-plugin-vue=script.js","src/components/control/navigation/VcCompass.vue","src/components/control/navigation/icon/increase.js","src/components/control/navigation/icon/decrease.js","src/components/control/navigation/icon/refresh.js","src/components/control/navigation/VcZoomControl.vue?rollup-plugin-vue=script.js","src/components/control/navigation/VcDistanceLegend.vue?rollup-plugin-vue=script.js","src/components/control/navigation/VcDistanceLegend.vue","src/components/control/navigation/VcLocationBar.vue?rollup-plugin-vue=script.js","src/components/control/navigation/VcLocationBar.vue","src/components/control/navigation/icon/share.js","src/components/control/navigation/VcPrintView.vue?rollup-plugin-vue=script.js","src/components/control/navigation/VcPrintView.vue","src/components/control/navigation/VcPrintViewBtn.vue?rollup-plugin-vue=script.js","src/components/control/navigation/VcPrintViewBtn.vue","src/components/control/navigation/icon/geolocation.js","src/components/control/navigation/VcMyLocation.vue?rollup-plugin-vue=script.js","src/components/control/navigation/VcMyLocation.vue","src/components/control/navigation/VcNavigation.vue?rollup-plugin-vue=script.js","src/components/control/navigation/VcNavigation.vue","src/components/control/navigation/index.js"],"sourcesContent":["//\n//\n//\n//\n\nconst icons = {}\nlet notLoadedIcons = []\nlet defaultWidth = ''\nlet defaultHeight = ''\nlet classPrefix = 'vc-svg'\nlet isStroke = false\nlet isOriginalDefault = false\n\nexport default {\n  name: 'svgicon',\n  data () {\n    return {\n      loaded: false\n    }\n  },\n  props: {\n    icon: String,\n    name: String,\n    width: {\n      type: String,\n      default: ''\n    },\n    height: {\n      type: String,\n      default: ''\n    },\n    scale: String,\n    dir: String,\n    fill: {\n      type: Boolean,\n      default: function () {\n        return !isStroke\n      }\n    },\n    color: String,\n    original: {\n      type: Boolean,\n      default: function () {\n        return isOriginalDefault\n      }\n    },\n    title: String\n  },\n\n  computed: {\n    clazz () {\n      let clazz = `${classPrefix}-icon`\n\n      if (this.fill) {\n        clazz += ` ${classPrefix}-fill`\n      }\n\n      if (this.dir) {\n        clazz += ` ${classPrefix}-${this.dir}`\n      }\n\n      return clazz\n    },\n\n    iconName () {\n      return this.name || this.icon\n    },\n\n    iconData () {\n      const iconData = icons[this.iconName]\n      if (iconData || this.loaded) {\n        return iconData\n      }\n\n      return null\n    },\n\n    colors () {\n      if (this.color) {\n        return this.color.split(' ')\n      }\n      return []\n    },\n\n    path () {\n      let pathData = ''\n      if (this.iconData) {\n        pathData = this.iconData.data\n\n        pathData = this.setTitle(pathData)\n\n        // use original color\n        if (this.original) {\n          pathData = this.addOriginalColor(pathData)\n        }\n\n        if (this.colors.length > 0) {\n          pathData = this.addColor(pathData)\n        }\n      } else {\n        // if no iconData, push to notLoadedIcons\n        notLoadedIcons.push({\n          name: this.iconName,\n          component: this\n        })\n      }\n\n      return this.getValidPathData(pathData)\n    },\n\n    box () {\n      const width = this.width || 16\n      const height = this.width || 16\n\n      if (this.iconData) {\n        if (this.iconData.viewBox) {\n          return this.iconData.viewBox\n        }\n        return `0 0 ${this.iconData.width} ${this.iconData.height}`\n      }\n\n      return `0 0 ${parseFloat(width)} ${parseFloat(height)}`\n    },\n\n    style () {\n      const digitReg = /^\\d+$/\n      const scale = Number(this.scale)\n      let width\n      let height\n\n      // apply scale\n      if (!isNaN(scale) && this.iconData) {\n        width = Number(this.iconData.width) * scale + 'px'\n        height = Number(this.iconData.height) * scale + 'px'\n      } else {\n        width = digitReg.test(this.width)\n          ? this.width + 'px'\n          : this.width || defaultWidth\n        height = digitReg.test(this.height)\n          ? this.height + 'px'\n          : this.height || defaultHeight\n      }\n\n      const style = {}\n\n      if (width) {\n        style.width = width\n      }\n\n      if (height) {\n        style.height = height\n      }\n      return style\n    }\n  },\n\n  created () {\n    if (icons[this.iconName]) {\n      this.loaded = true\n    }\n  },\n\n  methods: {\n    addColor (data) {\n      const reg = /<(path|rect|circle|polygon|line|polyline|ellipse)\\s/gi\n      let i = 0\n      return data.replace(reg, match => {\n        let color =\n          this.colors[i++] || this.colors[this.colors.length - 1]\n        let fill = this.fill\n\n        // if color is '_', ignore it\n        if (color && color === '_') {\n          return match\n        }\n\n        // if color start with 'r-', reverse the fill value\n        if (color && color.indexOf('r-') === 0) {\n          fill = !fill\n          color = color.split('r-')[1]\n        }\n\n        const style = fill ? 'fill' : 'stroke'\n        const reverseStyle = fill ? 'stroke' : 'fill'\n        return match + `${style}=\"${color}\" ${reverseStyle}=\"none\" `\n      })\n    },\n\n    addOriginalColor (data) {\n      const styleReg = /_fill=\"|_stroke=\"/gi\n      return data.replace(styleReg, styleName => {\n        return styleName && styleName.slice(1)\n      })\n    },\n\n    getValidPathData (pathData) {\n      // If use original and colors, clear double fill or stroke\n      if (this.original && this.colors.length > 0) {\n        // eslint-disable-next-line no-useless-escape\n        const reg = /<(path|rect|circle|polygon|line|polyline|ellipse)(\\sfill|\\sstroke)([=\"\\w\\s\\.\\-\\+#\\$\\&>]+)(fill|stroke)/gi\n        pathData = pathData.replace(reg, (match, p1, p2, p3, p4) => {\n          return `<${p1}${p2}${p3}_${p4}`\n        })\n      }\n\n      return pathData\n    },\n\n    setTitle (pathData) {\n      if (this.title) {\n        const title = this.title\n          // eslint-disable-next-line no-useless-escape\n          .replace(/\\</gi, '&lt;')\n          .replace(/>/gi, '&gt;')\n          .replace(/&/g, '&amp;')\n        return `<title>${title}</title>` + pathData\n      }\n      return pathData\n    },\n\n    onClick (e) {\n      this.$emit('click', e)\n    }\n  },\n\n  install (Vue, options = {}) {\n    const tagName = options.tagName || 'svgicon'\n\n    if (options.classPrefix) {\n      classPrefix = options.classPrefix\n    }\n\n    isStroke = !!options.isStroke\n    isOriginalDefault = !!options.isOriginalDefault\n\n    // default size\n    options.defaultWidth && (defaultWidth = options.defaultWidth)\n    options.defaultHeight && (defaultHeight = options.defaultHeight)\n\n    Vue.component(tagName, this)\n  },\n\n  // register icons\n  register (data) {\n    for (const name in data) {\n      if (!icons[name]) {\n        icons[name] = data[name]\n      }\n\n      // check new register icon is not loaded, and set loaded to true\n      notLoadedIcons = notLoadedIcons.filter((v, ix) => {\n        if (v.name === name) {\n          v.component.$set(v.component, 'loaded', true)\n        }\n\n        return v.name !== name\n      })\n    }\n  },\n\n  icons\n}\n","<template>\n  <svg :class=\"clazz\" :style=\"style\" :viewBox=\"box\" @click=\"onClick\" v-html=\"path\" version=\"1.1\" />\n</template>\n\n<script>\nconst icons = {}\nlet notLoadedIcons = []\nlet defaultWidth = ''\nlet defaultHeight = ''\nlet classPrefix = 'vc-svg'\nlet isStroke = false\nlet isOriginalDefault = false\n\nexport default {\n  name: 'svgicon',\n  data () {\n    return {\n      loaded: false\n    }\n  },\n  props: {\n    icon: String,\n    name: String,\n    width: {\n      type: String,\n      default: ''\n    },\n    height: {\n      type: String,\n      default: ''\n    },\n    scale: String,\n    dir: String,\n    fill: {\n      type: Boolean,\n      default: function () {\n        return !isStroke\n      }\n    },\n    color: String,\n    original: {\n      type: Boolean,\n      default: function () {\n        return isOriginalDefault\n      }\n    },\n    title: String\n  },\n\n  computed: {\n    clazz () {\n      let clazz = `${classPrefix}-icon`\n\n      if (this.fill) {\n        clazz += ` ${classPrefix}-fill`\n      }\n\n      if (this.dir) {\n        clazz += ` ${classPrefix}-${this.dir}`\n      }\n\n      return clazz\n    },\n\n    iconName () {\n      return this.name || this.icon\n    },\n\n    iconData () {\n      const iconData = icons[this.iconName]\n      if (iconData || this.loaded) {\n        return iconData\n      }\n\n      return null\n    },\n\n    colors () {\n      if (this.color) {\n        return this.color.split(' ')\n      }\n      return []\n    },\n\n    path () {\n      let pathData = ''\n      if (this.iconData) {\n        pathData = this.iconData.data\n\n        pathData = this.setTitle(pathData)\n\n        // use original color\n        if (this.original) {\n          pathData = this.addOriginalColor(pathData)\n        }\n\n        if (this.colors.length > 0) {\n          pathData = this.addColor(pathData)\n        }\n      } else {\n        // if no iconData, push to notLoadedIcons\n        notLoadedIcons.push({\n          name: this.iconName,\n          component: this\n        })\n      }\n\n      return this.getValidPathData(pathData)\n    },\n\n    box () {\n      const width = this.width || 16\n      const height = this.width || 16\n\n      if (this.iconData) {\n        if (this.iconData.viewBox) {\n          return this.iconData.viewBox\n        }\n        return `0 0 ${this.iconData.width} ${this.iconData.height}`\n      }\n\n      return `0 0 ${parseFloat(width)} ${parseFloat(height)}`\n    },\n\n    style () {\n      const digitReg = /^\\d+$/\n      const scale = Number(this.scale)\n      let width\n      let height\n\n      // apply scale\n      if (!isNaN(scale) && this.iconData) {\n        width = Number(this.iconData.width) * scale + 'px'\n        height = Number(this.iconData.height) * scale + 'px'\n      } else {\n        width = digitReg.test(this.width)\n          ? this.width + 'px'\n          : this.width || defaultWidth\n        height = digitReg.test(this.height)\n          ? this.height + 'px'\n          : this.height || defaultHeight\n      }\n\n      const style = {}\n\n      if (width) {\n        style.width = width\n      }\n\n      if (height) {\n        style.height = height\n      }\n      return style\n    }\n  },\n\n  created () {\n    if (icons[this.iconName]) {\n      this.loaded = true\n    }\n  },\n\n  methods: {\n    addColor (data) {\n      const reg = /<(path|rect|circle|polygon|line|polyline|ellipse)\\s/gi\n      let i = 0\n      return data.replace(reg, match => {\n        let color =\n          this.colors[i++] || this.colors[this.colors.length - 1]\n        let fill = this.fill\n\n        // if color is '_', ignore it\n        if (color && color === '_') {\n          return match\n        }\n\n        // if color start with 'r-', reverse the fill value\n        if (color && color.indexOf('r-') === 0) {\n          fill = !fill\n          color = color.split('r-')[1]\n        }\n\n        const style = fill ? 'fill' : 'stroke'\n        const reverseStyle = fill ? 'stroke' : 'fill'\n        return match + `${style}=\"${color}\" ${reverseStyle}=\"none\" `\n      })\n    },\n\n    addOriginalColor (data) {\n      const styleReg = /_fill=\"|_stroke=\"/gi\n      return data.replace(styleReg, styleName => {\n        return styleName && styleName.slice(1)\n      })\n    },\n\n    getValidPathData (pathData) {\n      // If use original and colors, clear double fill or stroke\n      if (this.original && this.colors.length > 0) {\n        // eslint-disable-next-line no-useless-escape\n        const reg = /<(path|rect|circle|polygon|line|polyline|ellipse)(\\sfill|\\sstroke)([=\"\\w\\s\\.\\-\\+#\\$\\&>]+)(fill|stroke)/gi\n        pathData = pathData.replace(reg, (match, p1, p2, p3, p4) => {\n          return `<${p1}${p2}${p3}_${p4}`\n        })\n      }\n\n      return pathData\n    },\n\n    setTitle (pathData) {\n      if (this.title) {\n        const title = this.title\n          // eslint-disable-next-line no-useless-escape\n          .replace(/\\</gi, '&lt;')\n          .replace(/>/gi, '&gt;')\n          .replace(/&/g, '&amp;')\n        return `<title>${title}</title>` + pathData\n      }\n      return pathData\n    },\n\n    onClick (e) {\n      this.$emit('click', e)\n    }\n  },\n\n  install (Vue, options = {}) {\n    const tagName = options.tagName || 'svgicon'\n\n    if (options.classPrefix) {\n      classPrefix = options.classPrefix\n    }\n\n    isStroke = !!options.isStroke\n    isOriginalDefault = !!options.isOriginalDefault\n\n    // default size\n    options.defaultWidth && (defaultWidth = options.defaultWidth)\n    options.defaultHeight && (defaultHeight = options.defaultHeight)\n\n    Vue.component(tagName, this)\n  },\n\n  // register icons\n  register (data) {\n    for (const name in data) {\n      if (!icons[name]) {\n        icons[name] = data[name]\n      }\n\n      // check new register icon is not loaded, and set loaded to true\n      notLoadedIcons = notLoadedIcons.filter((v, ix) => {\n        if (v.name === name) {\n          v.component.$set(v.component, 'loaded', true)\n        }\n\n        return v.name !== name\n      })\n    }\n  },\n\n  icons\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.vc-svg-icon {\n  display: block;\n}\n</style>\n","import VcIconSvg from './VcIconSvg.vue'\nVcIconSvg.register({\n  'compass-outer': {\n    width: 162,\n    height: 162,\n    viewBox: '0 0 162 162',\n    data: `\n    <!-- Generator: Sketch 43.2 (39069) - http://www.bohemiancoding.com/sketch -->\n    <!-- <title>compass-outer</title> -->\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\">\n      <g id=\"compass-outer\" fill-rule=\"nonzero\">\n        <path d=\"M80.8410544,161.682109 C36.1937731,161.682109 0,125.488336 0,80.8410544 C0,36.1937731 36.1937731,0 80.8410544,0 C125.488336,0 161.682109,36.1937731 161.682109,80.8410544 C161.682109,125.488336 125.488336,161.682109 80.8410544,161.682109 Z M81.1836011,134.620909 C110.696211,134.620909 134.620909,110.696211 134.620909,81.1836011 C134.620909,51.6709916 110.696211,27.7462941 81.1836011,27.7462941 C51.6709916,27.7462941 27.7462941,51.6709916 27.7462941,81.1836011 C27.7462941,110.696211 51.6709916,134.620909 81.1836011,134.620909 Z\" id=\"Oval-108\"></path>\n        <circle id=\"Oval-74\" fill=\"#FFFFFF\" cx=\"129.493683\" cy=\"127.952092\" r=\"1.54159147\"></circle>\n        <circle id=\"Oval-74-Copy-3\" fill=\"#FFFFFF\" cx=\"129.493683\" cy=\"35.4566038\" r=\"1.54159147\"></circle>\n        <circle id=\"Oval-74-Copy-5\" fill=\"#FFFFFF\" cx=\"30.8318294\" cy=\"127.952092\" r=\"1.54159147\"></circle>\n        <circle id=\"Oval-74-Copy-4\" fill=\"#FFFFFF\" cx=\"30.8318294\" cy=\"35.4566038\" r=\"1.54159147\"></circle>\n        <polygon id=\"N\" fill=\"#FFFFFF\" points=\"84.9318072 23.1238721 84.9318072 13.1321362 82.5623385 13.1321362 82.5623385 19.2984646 77.951866 13.1321362 75.7108625 13.1321362 75.7108625 23.1238721 78.0946053 23.1238721 78.0946053 16.9718176 82.6908037 23.1238721\"></polygon>\n        <polygon id=\"Line\" fill=\"#FFFFFF\" points=\"143.368007 82.1093476 152.617555 82.1093476 152.617555 81.2993476 143.368007 81.2993476\"></polygon>\n        <polygon id=\"Line-Copy-8\" fill=\"#FFFFFF\" points=\"9.24954884 82.1093476 18.4990976 82.1093476 18.4990976 81.2993476 9.24954884 81.2993476\"></polygon>\n        <polygon id=\"Line\" fill=\"#FFFFFF\" points=\"81.2993476 143.368007 81.2993476 152.617555 82.1093476 152.617555 82.1093476 143.368007\"></polygon>\n      </g>\n    </g>`\n  }\n})\n","import VcIconSvg from './VcIconSvg.vue'\nVcIconSvg.register({\n  'compass-inner': {\n    width: 17,\n    height: 17,\n    viewBox: '0 0 17 17',\n    data: `\n    <!-- Generator: Sketch 43.2 (39069) - http://www.bohemiancoding.com/sketch -->\n    <!-- <title>compass-inner</title> -->\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\">\n      <g id=\"compass-inner\" fill-rule=\"nonzero\">\n        <path d=\"M8.5,16.5 C4.081722,16.5 0.5,12.918278 0.5,8.5 C0.5,4.081722 4.081722,0.5 8.5,0.5 C12.918278,0.5 16.5,4.081722 16.5,8.5 C16.5,12.918278 12.918278,16.5 8.5,16.5 Z M8.5,15.5 C12.3659932,15.5 15.5,12.3659932 15.5,8.5 C15.5,4.63400675 12.3659932,1.5 8.5,1.5 C4.63400675,1.5 1.5,4.63400675 1.5,8.5 C1.5,12.3659932 4.63400675,15.5 8.5,15.5 Z\" id=\"Oval-96\"></path>\n        <path d=\"M9.92599835,7.09066832 C12.7122872,9.87695712 14.3709388,12.5452228 13.4497471,13.4664145 C12.5285555,14.3876061 9.86028979,12.7289545 7.074001,9.94266568 C4.2877122,7.15637688 2.62906055,4.48811119 3.55025221,3.56691953 C4.47144386,2.64572788 7.13970955,4.30437952 9.92599835,7.09066832 Z M9.21889157,7.7977751 C6.92836458,5.50724811 4.52075769,4.01062761 4.25735899,4.27402631 C3.99396029,4.53742501 5.49058078,6.9450319 7.78110778,9.2355589 C10.0716348,11.5260859 12.4792417,13.0227064 12.7426404,12.7593077 C13.0060391,12.495909 11.5094186,10.0883021 9.21889157,7.7977751 Z\" id=\"Oval-96-Copy-2\"></path>\n        <path d=\"M9.92599835,9.94266568 C7.13970955,12.7289545 4.47144386,14.3876061 3.55025221,13.4664145 C2.62906055,12.5452228 4.2877122,9.87695712 7.074001,7.09066832 C9.86028979,4.30437952 12.5285555,2.64572788 13.4497471,3.56691953 C14.3709388,4.48811119 12.7122872,7.15637688 9.92599835,9.94266568 Z M9.21889157,9.2355589 C11.5094186,6.9450319 13.0060391,4.53742501 12.7426404,4.27402631 C12.4792417,4.01062761 10.0716348,5.50724811 7.78110778,7.7977751 C5.49058078,10.0883021 3.99396029,12.495909 4.25735899,12.7593077 C4.52075769,13.0227064 6.92836458,11.5260859 9.21889157,9.2355589 Z\" id=\"Oval-96-Copy-3\"></path>\n        <path d=\"M15.1464466,1.1464466 L14.3453364,1.94755684 L13.9608692,2.33202401 L14.667976,3.03913077 L15.0524431,2.65466362 L15.8535534,1.8535534 L15.1464466,1.1464466 Z M2.29760014,13.995293 L1.85311902,14.4397742 L1.004311,15.2885822 L1.71141776,15.995689 L2.56022581,15.146881 L3.00470698,14.7023998 L2.29760014,13.995293 Z\" id=\"Line\"></path>\n        <circle id=\"Oval-432\" cx=\"16\" cy=\"1\" r=\"1\"></circle>\n        <circle id=\"Oval-432-Copy\" cx=\"1\" cy=\"16\" r=\"1\"></circle>\n      </g>\n    </g>\n    `\n  }\n})\n","import VcIconSvg from './VcIconSvg.vue'\nVcIconSvg.register({\n  'compass-rotation-marker': {\n    width: 53,\n    height: 53,\n    viewBox: '0 0 53 53',\n    data: `\n    <!-- Generator: Sketch 3.4.3 (16044) - http://www.bohemiancoding.com/sketch -->\n    <!-- <title>compass-rotation-marker</title> -->\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n      <g id=\"compass-rotation-marker\">\n        <path d=\"M52.4399986,26.2199993 C52.4399986,11.7390936 40.7009051,0 26.2199993,0 C11.7390936,0 0,11.7390936 0,26.2199993 C0,40.7009051 11.7390936,52.4399986 26.2199993,52.4399986 C40.7009051,52.4399986 52.4399986,40.7009051 52.4399986,26.2199993 Z\" id=\"rotator\" stroke-opacity=\"0.135841259\" stroke=\"#E2A549\" stroke-width=\"9\" opacity=\"0.201434235\"></path>\n        <path d=\"M0,26.2199993 C0,11.7390936 11.7390936,0 26.2199993,0 L26.2199993,9 C16.7096563,9 9,16.7096563 9,26.2199993\" id=\"Shape\" opacity=\"0.634561567\" fill=\"#4990E2\"></path>\n      </g>\n    </g>`\n  }\n})\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport './icon/compass-outer'\nimport './icon/compass-inner'\nimport './icon/compass-rotation-marker'\nimport '../../../assets/styles/components/compass.scss'\nimport VcIconSvg from './icon/VcIconSvg.vue'\nimport CameraFlightPath from '../../../exts/CameraFlightPath'\nconst vectorScratch = {}\nconst oldTransformScratch = {}\nconst newTransformScratch = {}\nconst centerScratch = {}\nexport default {\n  name: 'vc-compass',\n  props: {\n    enableCompassOuterRing: Boolean\n  },\n  data () {\n    return {\n      heading: 0,\n      orbitCursorAngle: 0,\n      orbitCursorOpacity: 0\n    }\n  },\n  components: {\n    VcIconSvg\n  },\n  computed: {\n    outerCircleStyle: function () {\n      return {\n        transform: 'rotate(-' + this.heading + 'rad)',\n        WebkitTransform: 'rotate(-' + this.heading + 'rad)',\n        opacity: ''\n      }\n    },\n    rotationMarkerStyle: function () {\n      return {\n        transform: 'rotate(-' + this.orbitCursorAngle + 'rad)',\n        WebkitTransform: 'rotate(-' + this.orbitCursorAngle + 'rad)',\n        opacity: this.orbitCursorOpacity\n      }\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer, cesiumObject }) => {\n      this.viewer = viewer\n      this._unsubscribeFromViewerChange = this.viewer.afterViewerChanged.addEventListener(() => viewerChange(this))\n      viewerChange(this)\n    })\n  },\n  destroyed () {\n    document.removeEventListener('mousemove', this.orbitMouseMoveFunction, false)\n    document.removeEventListener('mouseup', this.orbitMouseUpFunction, false)\n    document.removeEventListener('touchmove', this.orbitMouseMoveFunction, false)\n    document.removeEventListener('touchend', this.orbitMouseUpFunction, false)\n    this._unsubscribeFromClockTick && this._unsubscribeFromClockTick()\n    this._unsubscribeFromPostRender && this._unsubscribeFromPostRender()\n    this._unsubscribeFromViewerChange && this._unsubscribeFromViewerChange()\n  },\n  methods: {\n    handleMouseDown (e) {\n      if (e.stopPropagation) e.stopPropagation()\n      if (e.preventDefault) e.preventDefault()\n      const { SceneMode } = Cesium\n      const scene = this.viewer.scene\n      if (scene.mode === SceneMode.MORPHING) {\n        return true\n      }\n      const { Cartesian2 } = Cesium\n      const compassElement = e.currentTarget\n      const compassRectangle = e.currentTarget.getBoundingClientRect()\n      const maxDistance = compassRectangle.width / 2.0\n      const center = new Cartesian2(\n        (compassRectangle.right - compassRectangle.left) / 2.0,\n        (compassRectangle.bottom - compassRectangle.top) / 2.0\n      )\n      const clickLocation =\n        event.type === 'mousedown'\n          ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n          : new Cartesian2(\n            event.changedTouches[0].clientX - compassRectangle.left,\n            event.changedTouches[0].clientY - compassRectangle.top\n          )\n      const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n      const distanceFromCenter = Cartesian2.magnitude(vector)\n\n      const distanceFraction = distanceFromCenter / maxDistance\n\n      const nominalTotalRadius = 145\n      const norminalGyroRadius = 50\n\n      if (distanceFraction < norminalGyroRadius / nominalTotalRadius) {\n        orbit(this, compassElement, vector)\n      } else if (distanceFraction < 1.0) {\n        rotate(this, compassElement, vector)\n      } else {\n        return true\n      }\n    },\n    handleDoubleClick (e) {\n      const { Cartesian2, Cartesian3, defined, Matrix4, Ray, SceneMode, Transforms } = Cesium\n\n      const scene = this.viewer.scene\n      const camera = scene.camera\n      const sscc = scene.screenSpaceCameraController\n\n      if (scene.mode === SceneMode.MORPHING || !sscc.enableInputs) {\n        return true\n      }\n      if (scene.mode === SceneMode.COLUMBUS_VIEW && !sscc.enableTranslate) {\n        return\n      }\n      if (scene.mode === SceneMode.SCENE3D || scene.mode === SceneMode.COLUMBUS_VIEW) {\n        if (!sscc.enableLook) {\n          return\n        }\n\n        if (scene.mode === SceneMode.SCENE3D) {\n          if (!sscc.enableRotate) {\n            return\n          }\n        }\n      }\n\n      const windowPosition = new Cartesian2()\n      windowPosition.x = scene.canvas.clientWidth / 2\n      windowPosition.y = scene.canvas.clientHeight / 2\n      const pickRayScratch = new Ray()\n      const ray = camera.getPickRay(windowPosition, pickRayScratch)\n\n      const center = scene.globe.pick(ray, scene, centerScratch)\n      if (!defined(center)) {\n        // Globe is barely visible, so reset to home view.\n        this.viewer.camera.flyHome()\n        return\n      }\n\n      const rotateFrame = Transforms.eastNorthUpToFixedFrame(center, this.viewer.scene.globe.ellipsoid)\n\n      const lookVector = Cartesian3.subtract(center, camera.position, new Cartesian3())\n\n      const flight = CameraFlightPath.createTween(scene, {\n        destination: Matrix4.multiplyByPoint(\n          rotateFrame,\n          new Cartesian3(0.0, 0.0, Cartesian3.magnitude(lookVector)),\n          new Cartesian3()\n        ),\n        direction: Matrix4.multiplyByPointAsVector(rotateFrame, new Cartesian3(0.0, 0.0, -1.0), new Cartesian3()),\n        up: Matrix4.multiplyByPointAsVector(rotateFrame, new Cartesian3(0.0, 1.0, 0.0), new Cartesian3()),\n        duration: 1.5\n      })\n      scene.tweens.add(flight)\n    },\n    resetRotater () {\n      this.orbitCursorOpacity = 0\n      this.orbitCursorAngle = 0\n    }\n  }\n}\n\nfunction viewerChange (viewModel) {\n  const { defined } = Cesium\n  if (defined(viewModel.viewer)) {\n    if (viewModel._unsubscribeFromPostRender) {\n      viewModel._unsubscribeFromPostRender()\n      viewModel._unsubscribeFromPostRender = undefined\n    }\n\n    viewModel._unsubscribeFromPostRender = viewModel.viewer.scene.postRender.addEventListener(function () {\n      viewModel.heading = viewModel.viewer.scene.camera.heading\n    })\n  } else {\n    if (viewModel._unsubscribeFromPostRender) {\n      viewModel._unsubscribeFromPostRender()\n      viewModel._unsubscribeFromPostRender = undefined\n    }\n    viewModel.showCompass = false\n  }\n}\n\nfunction orbit (viewModel, compassElement, cursorVector) {\n  const { Cartesian2, Cartesian3, defined, getTimestamp, Math: CesiumMath, Matrix4, Ray, SceneMode, Transforms } = Cesium\n  let scene = viewModel.viewer.scene\n  let camera = scene.camera\n  const sscc = scene.screenSpaceCameraController\n  // do not orbit if it is disabled\n  if (scene.mode === SceneMode.MORPHING || !sscc.enableInputs) {\n    return\n  }\n  switch (scene.mode) {\n    case SceneMode.COLUMBUS_VIEW:\n      if (sscc.enableLook) {\n        break\n      }\n      if (!sscc.enableTranslate || !sscc.enableTilt) {\n        return\n      }\n      break\n    case SceneMode.SCENE3D:\n      if (sscc.enableLook) {\n        break\n      }\n      if (!sscc.enableTilt || !sscc.enableRotate) {\n        return\n      }\n      break\n    case Cesium.SceneMode.SCENE2D:\n      if (!sscc.enableTranslate) {\n        return\n      }\n      break\n  }\n  // Remove existing event handlers, if any.\n  document.removeEventListener('mousemove', viewModel.orbitMouseMoveFunction, false)\n  document.removeEventListener('mouseup', viewModel.orbitMouseUpFunction, false)\n  document.removeEventListener('touchmove', viewModel.orbitMouseMoveFunction, false)\n  document.removeEventListener('touchend', viewModel.orbitMouseUpFunction, false)\n\n  if (defined(viewModel.orbitTickFunction)) {\n    viewModel.viewer.clock.onTick.removeEventListener(viewModel.orbitTickFunction)\n  }\n\n  viewModel.orbitMouseMoveFunction = undefined\n  viewModel.orbitMouseUpFunction = undefined\n  viewModel.orbitTickFunction = undefined\n\n  viewModel.isOrbiting = true\n  viewModel.orbitLastTimestamp = getTimestamp()\n\n  const windowPosition = new Cartesian2()\n  windowPosition.x = scene.canvas.clientWidth / 2\n  windowPosition.y = scene.canvas.clientHeight / 2\n  const pickRayScratch = new Ray()\n  const ray = camera.getPickRay(windowPosition, pickRayScratch)\n\n  let center = scene.globe.pick(ray, scene, centerScratch)\n  if (!defined(center)) {\n    viewModel.orbitFrame = Transforms.eastNorthUpToFixedFrame(camera.positionWC, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.orbitIsLook = true\n  } else {\n    viewModel.orbitFrame = Transforms.eastNorthUpToFixedFrame(center, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.orbitIsLook = false\n  }\n\n  viewModel.orbitTickFunction = function (e) {\n    const timestamp = getTimestamp()\n    const deltaT = timestamp - viewModel.orbitLastTimestamp\n    const rate = ((viewModel.orbitCursorOpacity - 0.5) * 2.5) / 1000\n    const distance = deltaT * rate\n\n    const angle = viewModel.orbitCursorAngle + CesiumMath.PI_OVER_TWO\n    const x = Math.cos(angle) * distance\n    const y = Math.sin(angle) * distance\n\n    scene = viewModel.viewer.scene\n    camera = scene.camera\n\n    const oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n\n    camera.lookAtTransform(viewModel.orbitFrame)\n\n    if (viewModel.orbitIsLook) {\n      camera.look(Cartesian3.UNIT_Z, -x)\n      camera.look(camera.right, -y)\n    } else {\n      camera.rotateLeft(x)\n      camera.rotateUp(y)\n    }\n\n    camera.lookAtTransform(oldTransform)\n\n    viewModel.orbitLastTimestamp = timestamp\n  }\n\n  function updateAngleAndOpacity (vector, compassWidth) {\n    const angle = Math.atan2(-vector.y, vector.x)\n    viewModel.orbitCursorAngle = CesiumMath.zeroToTwoPi(angle - CesiumMath.PI_OVER_TWO)\n    const distance = Cartesian2.magnitude(vector)\n    const maxDistance = compassWidth / 2.0\n    const distanceFraction = Math.min(distance / maxDistance, 1.0)\n    const easedOpacity = 0.5 * distanceFraction * distanceFraction + 0.5\n    viewModel.orbitCursorOpacity = easedOpacity\n  }\n\n  viewModel.orbitMouseMoveFunction = function (e) {\n    const compassRectangle = compassElement.getBoundingClientRect()\n    center = new Cartesian2(\n      (compassRectangle.right - compassRectangle.left) / 2.0,\n      (compassRectangle.bottom - compassRectangle.top) / 2.0\n    )\n    const clickLocation =\n      event.type === 'mousemove'\n        ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n        : new Cartesian2(\n          event.changedTouches[0].clientX - compassRectangle.left,\n          event.changedTouches[0].clientY - compassRectangle.top\n        )\n    const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n    updateAngleAndOpacity(vector, compassRectangle.width)\n  }\n\n  viewModel.orbitMouseUpFunction = function (e) {\n    // TODO: if mouse didn't move, reset view to looking down, north is up?\n\n    viewModel.isOrbiting = false\n    document.removeEventListener('mousemove', viewModel.orbitMouseMoveFunction, false)\n    document.removeEventListener('mouseup', viewModel.orbitMouseUpFunction, false)\n    document.removeEventListener('touchmove', viewModel.orbitMouseMoveFunction, false)\n    document.removeEventListener('touchend', viewModel.orbitMouseUpFunction, false)\n\n    if (defined(viewModel.orbitTickFunction)) {\n      viewModel.viewer.clock.onTick.removeEventListener(viewModel.orbitTickFunction)\n    }\n\n    viewModel.orbitMouseMoveFunction = undefined\n    viewModel.orbitMouseUpFunction = undefined\n    viewModel.orbitTickFunction = undefined\n  }\n\n  document.addEventListener('mousemove', viewModel.orbitMouseMoveFunction, false)\n  document.addEventListener('mouseup', viewModel.orbitMouseUpFunction, false)\n  document.addEventListener('touchmove', viewModel.orbitMouseMoveFunction, false)\n  document.addEventListener('touchend', viewModel.orbitMouseUpFunction, false)\n  viewModel._unsubscribeFromClockTick = viewModel.viewer.clock.onTick.addEventListener(viewModel.orbitTickFunction)\n\n  updateAngleAndOpacity(cursorVector, compassElement.getBoundingClientRect().width)\n}\n\nfunction rotate (viewModel, compassElement, cursorVector) {\n  if (!viewModel.enableCompassOuterRing) {\n    return\n  }\n\n  const scene = viewModel.viewer.scene\n  let camera = scene.camera\n  const sscc = scene.screenSpaceCameraController\n  // do not rotate in 2D mode or if rotating is disabled\n  if (scene.mode === Cesium.SceneMode.MORPHING || scene.mode === Cesium.SceneMode.SCENE2D || !sscc.enableInputs) {\n    return\n  }\n  if (!sscc.enableLook && (scene.mode === Cesium.SceneMode.COLUMBUS_VIEW || (scene.mode === Cesium.SceneMode.SCENE3D && !sscc.enableRotate))) {\n    return\n  }\n  // Remove existing event handlers, if any.\n  document.removeEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n  document.removeEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n  document.removeEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n  document.removeEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n  const { Cartesian2, Cartesian3, defined, Math: CesiumMath, Matrix4, Ray, Transforms } = Cesium\n  viewModel.rotateMouseMoveFunction = undefined\n  viewModel.rotateMouseUpFunction = undefined\n\n  viewModel.isRotating = true\n  viewModel.rotateInitialCursorAngle = Math.atan2(-cursorVector.y, cursorVector.x)\n\n  const windowPosition = new Cartesian2()\n  windowPosition.x = scene.canvas.clientWidth / 2\n  windowPosition.y = scene.canvas.clientHeight / 2\n  const pickRayScratch = new Ray()\n  const ray = camera.getPickRay(windowPosition, pickRayScratch)\n\n  const viewCenter = scene.globe.pick(ray, scene, centerScratch)\n  if (!defined(viewCenter)) {\n    viewModel.rotateFrame = Transforms.eastNorthUpToFixedFrame(camera.positionWC, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.rotateIsLook = true\n  } else {\n    viewModel.rotateFrame = Transforms.eastNorthUpToFixedFrame(viewCenter, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.rotateIsLook = false\n  }\n\n  let oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n  camera.lookAtTransform(viewModel.rotateFrame)\n  viewModel.rotateInitialCameraAngle = Math.atan2(camera.position.y, camera.position.x)\n  viewModel.rotateInitialCameraDistance = Cartesian3.magnitude(new Cartesian3(camera.position.x, camera.position.y, 0.0))\n  camera.lookAtTransform(oldTransform)\n\n  viewModel.rotateMouseMoveFunction = function (e) {\n    const compassRectangle = compassElement.getBoundingClientRect()\n    const center = new Cartesian2(\n      (compassRectangle.right - compassRectangle.left) / 2.0,\n      (compassRectangle.bottom - compassRectangle.top) / 2.0\n    )\n    const clickLocation =\n      event.type === 'mousedown' || event.type === 'mousemove'\n        ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n        : new Cartesian2(\n          event.changedTouches[0].clientX - compassRectangle.left,\n          event.changedTouches[0].clientY - compassRectangle.top\n        )\n    const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n    const angle = Math.atan2(-vector.y, vector.x)\n\n    const angleDifference = angle - viewModel.rotateInitialCursorAngle\n    const newCameraAngle = CesiumMath.zeroToTwoPi(viewModel.rotateInitialCameraAngle - angleDifference)\n\n    camera = viewModel.viewer.scene.camera\n\n    oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n    camera.lookAtTransform(viewModel.rotateFrame)\n    const currentCameraAngle = Math.atan2(camera.position.y, camera.position.x)\n    camera.rotateRight(newCameraAngle - currentCameraAngle)\n    camera.lookAtTransform(oldTransform)\n  }\n\n  viewModel.rotateMouseUpFunction = function (e) {\n    viewModel.isRotating = false\n    document.removeEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n    document.removeEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n    document.removeEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n    document.removeEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n\n    viewModel.rotateMouseMoveFunction = undefined\n    viewModel.rotateMouseUpFunction = undefined\n  }\n\n  document.addEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n  document.addEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n  document.addEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n  document.addEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n}\n","<template>\n  <div\n    :title=\"$vc.lang.navigation.compass.description\"\n    @dblclick=\"handleDoubleClick\"\n    @mousedown=\"handleMouseDown\"\n    @mouseup=\"resetRotater\"\n    @touchend=\"resetRotater\"\n    @touchstart=\"handleMouseDown\"\n    class=\"vc-compass\"\n  >\n    <div :style=\"outerCircleStyle\" class=\"vc-compass-outerRing\">\n      <vc-icon-svg name=\"compass-outer\"></vc-icon-svg>\n    </div>\n    <div class=\"vc-compass-innerRing\">\n      <vc-icon-svg name=\"compass-inner\"></vc-icon-svg>\n    </div>\n    <div :style=\"rotationMarkerStyle\" class=\"vc-compass-rotation-marker\">\n      <vc-icon-svg name=\"compass-rotation-marker\"></vc-icon-svg>\n    </div>\n  </div>\n</template>\n<script>\n\nimport './icon/compass-outer'\nimport './icon/compass-inner'\nimport './icon/compass-rotation-marker'\nimport '../../../assets/styles/components/compass.scss'\nimport VcIconSvg from './icon/VcIconSvg.vue'\nimport CameraFlightPath from '../../../exts/CameraFlightPath'\nconst vectorScratch = {}\nconst oldTransformScratch = {}\nconst newTransformScratch = {}\nconst centerScratch = {}\nexport default {\n  name: 'vc-compass',\n  props: {\n    enableCompassOuterRing: Boolean\n  },\n  data () {\n    return {\n      heading: 0,\n      orbitCursorAngle: 0,\n      orbitCursorOpacity: 0\n    }\n  },\n  components: {\n    VcIconSvg\n  },\n  computed: {\n    outerCircleStyle: function () {\n      return {\n        transform: 'rotate(-' + this.heading + 'rad)',\n        WebkitTransform: 'rotate(-' + this.heading + 'rad)',\n        opacity: ''\n      }\n    },\n    rotationMarkerStyle: function () {\n      return {\n        transform: 'rotate(-' + this.orbitCursorAngle + 'rad)',\n        WebkitTransform: 'rotate(-' + this.orbitCursorAngle + 'rad)',\n        opacity: this.orbitCursorOpacity\n      }\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer, cesiumObject }) => {\n      this.viewer = viewer\n      this._unsubscribeFromViewerChange = this.viewer.afterViewerChanged.addEventListener(() => viewerChange(this))\n      viewerChange(this)\n    })\n  },\n  destroyed () {\n    document.removeEventListener('mousemove', this.orbitMouseMoveFunction, false)\n    document.removeEventListener('mouseup', this.orbitMouseUpFunction, false)\n    document.removeEventListener('touchmove', this.orbitMouseMoveFunction, false)\n    document.removeEventListener('touchend', this.orbitMouseUpFunction, false)\n    this._unsubscribeFromClockTick && this._unsubscribeFromClockTick()\n    this._unsubscribeFromPostRender && this._unsubscribeFromPostRender()\n    this._unsubscribeFromViewerChange && this._unsubscribeFromViewerChange()\n  },\n  methods: {\n    handleMouseDown (e) {\n      if (e.stopPropagation) e.stopPropagation()\n      if (e.preventDefault) e.preventDefault()\n      const { SceneMode } = Cesium\n      const scene = this.viewer.scene\n      if (scene.mode === SceneMode.MORPHING) {\n        return true\n      }\n      const { Cartesian2 } = Cesium\n      const compassElement = e.currentTarget\n      const compassRectangle = e.currentTarget.getBoundingClientRect()\n      const maxDistance = compassRectangle.width / 2.0\n      const center = new Cartesian2(\n        (compassRectangle.right - compassRectangle.left) / 2.0,\n        (compassRectangle.bottom - compassRectangle.top) / 2.0\n      )\n      const clickLocation =\n        event.type === 'mousedown'\n          ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n          : new Cartesian2(\n            event.changedTouches[0].clientX - compassRectangle.left,\n            event.changedTouches[0].clientY - compassRectangle.top\n          )\n      const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n      const distanceFromCenter = Cartesian2.magnitude(vector)\n\n      const distanceFraction = distanceFromCenter / maxDistance\n\n      const nominalTotalRadius = 145\n      const norminalGyroRadius = 50\n\n      if (distanceFraction < norminalGyroRadius / nominalTotalRadius) {\n        orbit(this, compassElement, vector)\n      } else if (distanceFraction < 1.0) {\n        rotate(this, compassElement, vector)\n      } else {\n        return true\n      }\n    },\n    handleDoubleClick (e) {\n      const { Cartesian2, Cartesian3, defined, Matrix4, Ray, SceneMode, Transforms } = Cesium\n\n      const scene = this.viewer.scene\n      const camera = scene.camera\n      const sscc = scene.screenSpaceCameraController\n\n      if (scene.mode === SceneMode.MORPHING || !sscc.enableInputs) {\n        return true\n      }\n      if (scene.mode === SceneMode.COLUMBUS_VIEW && !sscc.enableTranslate) {\n        return\n      }\n      if (scene.mode === SceneMode.SCENE3D || scene.mode === SceneMode.COLUMBUS_VIEW) {\n        if (!sscc.enableLook) {\n          return\n        }\n\n        if (scene.mode === SceneMode.SCENE3D) {\n          if (!sscc.enableRotate) {\n            return\n          }\n        }\n      }\n\n      const windowPosition = new Cartesian2()\n      windowPosition.x = scene.canvas.clientWidth / 2\n      windowPosition.y = scene.canvas.clientHeight / 2\n      const pickRayScratch = new Ray()\n      const ray = camera.getPickRay(windowPosition, pickRayScratch)\n\n      const center = scene.globe.pick(ray, scene, centerScratch)\n      if (!defined(center)) {\n        // Globe is barely visible, so reset to home view.\n        this.viewer.camera.flyHome()\n        return\n      }\n\n      const rotateFrame = Transforms.eastNorthUpToFixedFrame(center, this.viewer.scene.globe.ellipsoid)\n\n      const lookVector = Cartesian3.subtract(center, camera.position, new Cartesian3())\n\n      const flight = CameraFlightPath.createTween(scene, {\n        destination: Matrix4.multiplyByPoint(\n          rotateFrame,\n          new Cartesian3(0.0, 0.0, Cartesian3.magnitude(lookVector)),\n          new Cartesian3()\n        ),\n        direction: Matrix4.multiplyByPointAsVector(rotateFrame, new Cartesian3(0.0, 0.0, -1.0), new Cartesian3()),\n        up: Matrix4.multiplyByPointAsVector(rotateFrame, new Cartesian3(0.0, 1.0, 0.0), new Cartesian3()),\n        duration: 1.5\n      })\n      scene.tweens.add(flight)\n    },\n    resetRotater () {\n      this.orbitCursorOpacity = 0\n      this.orbitCursorAngle = 0\n    }\n  }\n}\n\nfunction viewerChange (viewModel) {\n  const { defined } = Cesium\n  if (defined(viewModel.viewer)) {\n    if (viewModel._unsubscribeFromPostRender) {\n      viewModel._unsubscribeFromPostRender()\n      viewModel._unsubscribeFromPostRender = undefined\n    }\n\n    viewModel._unsubscribeFromPostRender = viewModel.viewer.scene.postRender.addEventListener(function () {\n      viewModel.heading = viewModel.viewer.scene.camera.heading\n    })\n  } else {\n    if (viewModel._unsubscribeFromPostRender) {\n      viewModel._unsubscribeFromPostRender()\n      viewModel._unsubscribeFromPostRender = undefined\n    }\n    viewModel.showCompass = false\n  }\n}\n\nfunction orbit (viewModel, compassElement, cursorVector) {\n  const { Cartesian2, Cartesian3, defined, getTimestamp, Math: CesiumMath, Matrix4, Ray, SceneMode, Transforms } = Cesium\n  let scene = viewModel.viewer.scene\n  let camera = scene.camera\n  const sscc = scene.screenSpaceCameraController\n  // do not orbit if it is disabled\n  if (scene.mode === SceneMode.MORPHING || !sscc.enableInputs) {\n    return\n  }\n  switch (scene.mode) {\n    case SceneMode.COLUMBUS_VIEW:\n      if (sscc.enableLook) {\n        break\n      }\n      if (!sscc.enableTranslate || !sscc.enableTilt) {\n        return\n      }\n      break\n    case SceneMode.SCENE3D:\n      if (sscc.enableLook) {\n        break\n      }\n      if (!sscc.enableTilt || !sscc.enableRotate) {\n        return\n      }\n      break\n    case Cesium.SceneMode.SCENE2D:\n      if (!sscc.enableTranslate) {\n        return\n      }\n      break\n  }\n  // Remove existing event handlers, if any.\n  document.removeEventListener('mousemove', viewModel.orbitMouseMoveFunction, false)\n  document.removeEventListener('mouseup', viewModel.orbitMouseUpFunction, false)\n  document.removeEventListener('touchmove', viewModel.orbitMouseMoveFunction, false)\n  document.removeEventListener('touchend', viewModel.orbitMouseUpFunction, false)\n\n  if (defined(viewModel.orbitTickFunction)) {\n    viewModel.viewer.clock.onTick.removeEventListener(viewModel.orbitTickFunction)\n  }\n\n  viewModel.orbitMouseMoveFunction = undefined\n  viewModel.orbitMouseUpFunction = undefined\n  viewModel.orbitTickFunction = undefined\n\n  viewModel.isOrbiting = true\n  viewModel.orbitLastTimestamp = getTimestamp()\n\n  const windowPosition = new Cartesian2()\n  windowPosition.x = scene.canvas.clientWidth / 2\n  windowPosition.y = scene.canvas.clientHeight / 2\n  const pickRayScratch = new Ray()\n  const ray = camera.getPickRay(windowPosition, pickRayScratch)\n\n  let center = scene.globe.pick(ray, scene, centerScratch)\n  if (!defined(center)) {\n    viewModel.orbitFrame = Transforms.eastNorthUpToFixedFrame(camera.positionWC, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.orbitIsLook = true\n  } else {\n    viewModel.orbitFrame = Transforms.eastNorthUpToFixedFrame(center, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.orbitIsLook = false\n  }\n\n  viewModel.orbitTickFunction = function (e) {\n    const timestamp = getTimestamp()\n    const deltaT = timestamp - viewModel.orbitLastTimestamp\n    const rate = ((viewModel.orbitCursorOpacity - 0.5) * 2.5) / 1000\n    const distance = deltaT * rate\n\n    const angle = viewModel.orbitCursorAngle + CesiumMath.PI_OVER_TWO\n    const x = Math.cos(angle) * distance\n    const y = Math.sin(angle) * distance\n\n    scene = viewModel.viewer.scene\n    camera = scene.camera\n\n    const oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n\n    camera.lookAtTransform(viewModel.orbitFrame)\n\n    if (viewModel.orbitIsLook) {\n      camera.look(Cartesian3.UNIT_Z, -x)\n      camera.look(camera.right, -y)\n    } else {\n      camera.rotateLeft(x)\n      camera.rotateUp(y)\n    }\n\n    camera.lookAtTransform(oldTransform)\n\n    viewModel.orbitLastTimestamp = timestamp\n  }\n\n  function updateAngleAndOpacity (vector, compassWidth) {\n    const angle = Math.atan2(-vector.y, vector.x)\n    viewModel.orbitCursorAngle = CesiumMath.zeroToTwoPi(angle - CesiumMath.PI_OVER_TWO)\n    const distance = Cartesian2.magnitude(vector)\n    const maxDistance = compassWidth / 2.0\n    const distanceFraction = Math.min(distance / maxDistance, 1.0)\n    const easedOpacity = 0.5 * distanceFraction * distanceFraction + 0.5\n    viewModel.orbitCursorOpacity = easedOpacity\n  }\n\n  viewModel.orbitMouseMoveFunction = function (e) {\n    const compassRectangle = compassElement.getBoundingClientRect()\n    center = new Cartesian2(\n      (compassRectangle.right - compassRectangle.left) / 2.0,\n      (compassRectangle.bottom - compassRectangle.top) / 2.0\n    )\n    const clickLocation =\n      event.type === 'mousemove'\n        ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n        : new Cartesian2(\n          event.changedTouches[0].clientX - compassRectangle.left,\n          event.changedTouches[0].clientY - compassRectangle.top\n        )\n    const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n    updateAngleAndOpacity(vector, compassRectangle.width)\n  }\n\n  viewModel.orbitMouseUpFunction = function (e) {\n    // TODO: if mouse didn't move, reset view to looking down, north is up?\n\n    viewModel.isOrbiting = false\n    document.removeEventListener('mousemove', viewModel.orbitMouseMoveFunction, false)\n    document.removeEventListener('mouseup', viewModel.orbitMouseUpFunction, false)\n    document.removeEventListener('touchmove', viewModel.orbitMouseMoveFunction, false)\n    document.removeEventListener('touchend', viewModel.orbitMouseUpFunction, false)\n\n    if (defined(viewModel.orbitTickFunction)) {\n      viewModel.viewer.clock.onTick.removeEventListener(viewModel.orbitTickFunction)\n    }\n\n    viewModel.orbitMouseMoveFunction = undefined\n    viewModel.orbitMouseUpFunction = undefined\n    viewModel.orbitTickFunction = undefined\n  }\n\n  document.addEventListener('mousemove', viewModel.orbitMouseMoveFunction, false)\n  document.addEventListener('mouseup', viewModel.orbitMouseUpFunction, false)\n  document.addEventListener('touchmove', viewModel.orbitMouseMoveFunction, false)\n  document.addEventListener('touchend', viewModel.orbitMouseUpFunction, false)\n  viewModel._unsubscribeFromClockTick = viewModel.viewer.clock.onTick.addEventListener(viewModel.orbitTickFunction)\n\n  updateAngleAndOpacity(cursorVector, compassElement.getBoundingClientRect().width)\n}\n\nfunction rotate (viewModel, compassElement, cursorVector) {\n  if (!viewModel.enableCompassOuterRing) {\n    return\n  }\n\n  const scene = viewModel.viewer.scene\n  let camera = scene.camera\n  const sscc = scene.screenSpaceCameraController\n  // do not rotate in 2D mode or if rotating is disabled\n  if (scene.mode === Cesium.SceneMode.MORPHING || scene.mode === Cesium.SceneMode.SCENE2D || !sscc.enableInputs) {\n    return\n  }\n  if (!sscc.enableLook && (scene.mode === Cesium.SceneMode.COLUMBUS_VIEW || (scene.mode === Cesium.SceneMode.SCENE3D && !sscc.enableRotate))) {\n    return\n  }\n  // Remove existing event handlers, if any.\n  document.removeEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n  document.removeEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n  document.removeEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n  document.removeEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n  const { Cartesian2, Cartesian3, defined, Math: CesiumMath, Matrix4, Ray, Transforms } = Cesium\n  viewModel.rotateMouseMoveFunction = undefined\n  viewModel.rotateMouseUpFunction = undefined\n\n  viewModel.isRotating = true\n  viewModel.rotateInitialCursorAngle = Math.atan2(-cursorVector.y, cursorVector.x)\n\n  const windowPosition = new Cartesian2()\n  windowPosition.x = scene.canvas.clientWidth / 2\n  windowPosition.y = scene.canvas.clientHeight / 2\n  const pickRayScratch = new Ray()\n  const ray = camera.getPickRay(windowPosition, pickRayScratch)\n\n  const viewCenter = scene.globe.pick(ray, scene, centerScratch)\n  if (!defined(viewCenter)) {\n    viewModel.rotateFrame = Transforms.eastNorthUpToFixedFrame(camera.positionWC, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.rotateIsLook = true\n  } else {\n    viewModel.rotateFrame = Transforms.eastNorthUpToFixedFrame(viewCenter, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.rotateIsLook = false\n  }\n\n  let oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n  camera.lookAtTransform(viewModel.rotateFrame)\n  viewModel.rotateInitialCameraAngle = Math.atan2(camera.position.y, camera.position.x)\n  viewModel.rotateInitialCameraDistance = Cartesian3.magnitude(new Cartesian3(camera.position.x, camera.position.y, 0.0))\n  camera.lookAtTransform(oldTransform)\n\n  viewModel.rotateMouseMoveFunction = function (e) {\n    const compassRectangle = compassElement.getBoundingClientRect()\n    const center = new Cartesian2(\n      (compassRectangle.right - compassRectangle.left) / 2.0,\n      (compassRectangle.bottom - compassRectangle.top) / 2.0\n    )\n    const clickLocation =\n      event.type === 'mousedown' || event.type === 'mousemove'\n        ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n        : new Cartesian2(\n          event.changedTouches[0].clientX - compassRectangle.left,\n          event.changedTouches[0].clientY - compassRectangle.top\n        )\n    const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n    const angle = Math.atan2(-vector.y, vector.x)\n\n    const angleDifference = angle - viewModel.rotateInitialCursorAngle\n    const newCameraAngle = CesiumMath.zeroToTwoPi(viewModel.rotateInitialCameraAngle - angleDifference)\n\n    camera = viewModel.viewer.scene.camera\n\n    oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n    camera.lookAtTransform(viewModel.rotateFrame)\n    const currentCameraAngle = Math.atan2(camera.position.y, camera.position.x)\n    camera.rotateRight(newCameraAngle - currentCameraAngle)\n    camera.lookAtTransform(oldTransform)\n  }\n\n  viewModel.rotateMouseUpFunction = function (e) {\n    viewModel.isRotating = false\n    document.removeEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n    document.removeEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n    document.removeEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n    document.removeEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n\n    viewModel.rotateMouseMoveFunction = undefined\n    viewModel.rotateMouseUpFunction = undefined\n  }\n\n  document.addEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n  document.addEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n  document.addEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n  document.addEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n}\n</script>\n","import VcIconSvg from './VcIconSvg.vue'\nVcIconSvg.register({\n  increase: {\n    width: 50,\n    height: 50,\n    viewBox: '0 0 50 50',\n    data: `\n    <!-- Generator: Sketch 3.4.3 (16044) - http://www.bohemiancoding.com/sketch -->\n    <!-- <title>increase</title> -->\n    <path d=\"M0,25 C0,25.3514939 0.131810207,25.659051 0.373462207,25.900703 C0.615114207,26.142355 0.922671379,26.2741652 1.27416517,26.2741652 L23.7258348,26.2741652 L23.7258348,48.7258348 C23.7258348,49.0773286 23.857645,49.3848858 24.099297,49.6265378 C24.3189807,49.8462214 24.6485061,50 25,50 C25.7029877,50 26.2741652,49.4288225 26.2741652,48.7258348 L26.2741652,26.2741652 L48.7258348,26.2741652 C49.4288225,26.2741652 50,25.7029877 50,25 C50,24.2970123 49.4288225,23.7258348 48.7258348,23.7258348 L26.2741652,23.7258348 L26.2741652,1.27416517 C26.2741652,0.571177517 25.7029877,0 25,0 C24.2970123,0 23.7258348,0.571177517 23.7258348,1.27416517 L23.7258348,23.7258348 L1.27416517,23.7258348 C0.571177517,23.7258348 0,24.2970123 0,25 L0,25 L0,25 L0,25 Z\" id=\"Shape\"></path>`\n  }\n})\n","import VcIconSvg from './VcIconSvg.vue'\nVcIconSvg.register({\n  decrease: {\n    width: 50,\n    height: 6,\n    viewBox: '0 0 50 6',\n    data: `\n    <!-- Generator: Sketch 3.4.3 (16044) - http://www.bohemiancoding.com/sketch -->\n    <!-- <title>decrease</title> -->\n    <path d=\"M46.6183575,0.657894737 L3.30112724,0.657894737 C1.44927539,0.657894737 0,1.66880618 0,2.96052632 C0,4.25224645 1.44927539,5.26315789 3.30112724,5.26315789 L46.6988728,5.26315789 C48.5507246,5.26315789 50,4.25224645 50,2.96052632 C49.9194847,1.66880618 48.4702093,0.657894737 46.6183575,0.657894737 L46.6183575,0.657894737 L46.6183575,0.657894737 Z\" id=\"Shape\"></path>`\n  }\n})\n","import VcIconSvg from './VcIconSvg.vue'\nVcIconSvg.register({\n  refresh: {\n    width: 50,\n    height: 50,\n    viewBox: '0 0 50 50',\n    data: `\n    <!-- Generator: Sketch 3.4.3 (16044) - http://www.bohemiancoding.com/sketch -->\n    <!-- <title>refresh</title>  -->\n    <path d=\"M48.2758621,0 C47.2844828,0 46.5086207,0.775193846 46.5086207,1.76571923 L46.5086207,12.2308355 C42.0689655,4.78036173 34.0086207,0 25,0 C11.2068965,0 0,11.1972438 0,25.0215332 C0,38.8458226 11.2068965,50 25,50 C38.7931035,50 50,38.8027562 50,25.0215332 C50,24.0310078 49.2241379,23.2558139 48.2327587,23.2558139 C47.2413793,23.2558139 46.4655172,24.0310078 46.4655172,25.0215332 C46.4655172,36.8647717 36.8103448,46.5116279 24.9568965,46.5116279 C13.1034483,46.5116279 3.49137933,36.8217054 3.49137933,24.9784668 C3.49137933,13.1352283 13.1465517,3.48837212 25,3.48837212 C33.4913793,3.48837212 41.0775862,8.44099913 44.5258621,16.0206718 L32.1551724,16.0206718 C31.1637931,16.0206718 30.3879311,16.7958657 30.3879311,17.7863911 C30.3879311,18.7769164 31.1637931,19.5521103 32.1551724,19.5521103 L48.2327587,19.5521103 C49.2241379,19.5521103 50,18.7769164 50,17.7863911 L50,1.72265288 C50,0.775193846 49.2241379,0 48.2758621,0 L48.2758621,0 L48.2758621,0 Z\" id=\"Shape\"></path>`\n  }\n})\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport './icon/increase'\nimport './icon/decrease'\nimport './icon/refresh'\nimport '../../../assets/styles/components/zoomControl.scss'\nimport VcIconSvg from './icon/VcIconSvg.vue'\nexport default {\n  name: 'vc-zoomControl',\n  components: {\n    VcIconSvg\n  },\n  props: {\n    defaultResetView: Object,\n    zoomAmount: Number,\n    overrideCamera: Boolean\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer, cesiumObject }) => {\n      this.viewer = viewer\n      if (this.overrideCamera) {\n        const resetView = this.defaultResetView\n        if (resetView && resetView.lng) {\n          viewer.camera.setView({\n            destination: Cesium.Cartesian3.fromDegrees(resetView.lng, resetView.lat, resetView.height, viewer.scene.globe.ellipsoid),\n            orientation: {\n              heading: Cesium.Math.toRadians(resetView.heading || 360),\n              pitch: Cesium.Math.toRadians(resetView.pitch || -90),\n              roll: Cesium.Math.toRadians(resetView.roll || 0)\n            }\n          })\n        } else if (resetView && resetView.west) {\n          try {\n            const rectangle = Cesium.Rectangle.fromDegrees(resetView.west, resetView.south, resetView.east, resetView.north)\n            Cesium.Rectangle.validate(rectangle)\n            viewer.camera.setView({\n              destination: rectangle,\n              orientation: {\n                heading: Cesium.Math.toRadians(5.729578)\n              }\n            })\n          } catch (e) {\n            console.error('[VueCesium] ERROR: options.defaultResetView Cesium rectangle is  invalid!')\n          }\n        }\n      }\n    })\n  },\n  methods: {\n    zoomIn () {\n      this.zoom(1 / this.zoomAmount)\n    },\n    zoomOut () {\n      this.zoom(this.zoomAmount)\n    },\n    zoom (relativeAmount) {\n      const { Cartesian3, defined, IntersectionTests, Ray, SceneMode } = Cesium\n      if (defined(this.viewer)) {\n        const scene = this.viewer.scene\n        const sscc = scene.screenSpaceCameraController\n        // do not zoom if it is disabled\n        if (!sscc.enableInputs || !sscc.enableZoom) {\n          return\n        }\n        // TODO\n        //            if(scene.mode == SceneMode.COLUMBUS_VIEW && !sscc.enableTranslate) {\n        //                return;\n        //            }\n\n        const camera = scene.camera\n        let orientation\n\n        switch (scene.mode) {\n          case SceneMode.MORPHING: {\n            break\n          }\n          case SceneMode.SCENE2D: {\n            camera.zoomIn(camera.positionCartographic.height * (1 - relativeAmount))\n            break\n          }\n          default: {\n            let focus\n\n            if (defined(this.viewer.trackedEntity)) {\n              focus = new Cesium.Cartesian3()\n            } else {\n              focus = this.getCameraFocus(this.viewer, false)\n            }\n\n            if (!Cesium.defined(focus)) {\n              // Camera direction is not pointing at the globe, so use the ellipsoid horizon point as\n              // the focal point.\n              const ray = new Ray(\n                camera.worldToCameraCoordinatesPoint(scene.globe.ellipsoid.cartographicToCartesian(camera.positionCartographic)),\n                camera.directionWC\n              )\n              focus = IntersectionTests.grazingAltitudeLocation(ray, scene.globe.ellipsoid)\n\n              orientation = {\n                heading: camera.heading,\n                pitch: camera.pitch,\n                roll: camera.roll\n              }\n            } else {\n              orientation = {\n                direction: camera.direction,\n                up: camera.up\n              }\n            }\n            const cartesian3Scratch = new Cartesian3()\n            const direction = Cartesian3.subtract(camera.position, focus, cartesian3Scratch)\n            const movementVector = Cartesian3.multiplyByScalar(direction, relativeAmount, direction)\n            const endPosition = Cartesian3.add(focus, movementVector, focus)\n\n            if (Cesium.defined(this.viewer.trackedEntity) || scene.mode === SceneMode.COLUMBUS_VIEW) {\n              // sometimes flyTo does not work (jumps to wrong position) so just set the position without any animation\n              // do not use flyTo when tracking an entity because during animatiuon the position of the entity may change\n              camera.position = endPosition\n            } else {\n              camera.flyTo({\n                destination: endPosition,\n                orientation: orientation,\n                duration: 0.5,\n                convert: false\n              })\n            }\n          }\n        }\n      }\n    },\n    zoomReset () {\n      const scene = this.viewer.scene\n      const sscc = scene.screenSpaceCameraController\n      if (!sscc.enableInputs) {\n        return\n      }\n      const { Cartesian3, Math: CesiumMath, Rectangle } = Cesium\n      const camera = scene.camera\n\n      if (Cesium.defined(this.viewer.trackedEntity)) {\n        // when tracking do not reset to default view but to default view of tracked entity\n        const trackedEntity = this.viewer.trackedEntity\n        this.viewer.trackedEntity = undefined\n        this.viewer.trackedEntity = trackedEntity\n      } else {\n        // reset to a default position or view defined in the options\n        const resetView = this.defaultResetView\n        if (resetView && resetView.lng) {\n          camera.flyTo({\n            destination: Cartesian3.fromDegrees(resetView.lng, resetView.lat, resetView.height, this.viewer.scene.globe.ellipsoid),\n            orientation: {\n              heading: Cesium.Math.toRadians(resetView.heading || 360),\n              pitch: Cesium.Math.toRadians(resetView.pitch || -90),\n              roll: Cesium.Math.toRadians(resetView.roll || 0)\n            }\n          })\n        } else if (resetView && resetView.west) {\n          try {\n            const rectangle = Rectangle.fromDegrees(resetView.west, resetView.south, resetView.east, resetView.north)\n            Rectangle.validate(rectangle)\n            camera.flyTo({\n              destination: rectangle,\n              orientation: {\n                heading: CesiumMath.toRadians(5.729578)\n              }\n            })\n          } catch (e) {\n            console.error('[VueCesium] ERROR: options.defaultResetView Cesium rectangle is  invalid!')\n          }\n        } else {\n          camera.flyTo({\n            destination: Cartesian3.fromDegrees(105, 29.999999999999993, 19059568.497290563, this.viewer.scene.globe.ellipsoid)\n          })\n        }\n      }\n    },\n    getCameraFocus (scene) {\n      const { defined, IntersectionTests, Ray } = Cesium\n      const ray = new Ray(scene.camera.positionWC, scene.camera.directionWC)\n      const intersections = IntersectionTests.rayEllipsoid(ray, this.viewer.scene.globe.ellipsoid)\n      if (defined(intersections)) {\n        return Ray.getPoint(ray, intersections.start)\n      }\n      // Camera direction is not pointing at the globe, so use the ellipsoid horizon point as\n      // the focal point.\n      return IntersectionTests.grazingAltitudeLocation(ray, this.viewer.scene.globe.ellipsoid)\n    }\n  }\n}\n","//\n//\n//\n//\n//\n//\n//\n\nimport '../../../assets/styles/components/legend.scss'\nexport default {\n  name: 'vc-legend-distance',\n  data () {\n    return {\n      barWidth: 0,\n      distance: 0,\n      distanceLabel: undefined\n    }\n  },\n  computed: {\n    barStyle: function () {\n      return {\n        width: this.barWidth + 'px',\n        left: 5 + (125 - this.barWidth) / 2 + 'px',\n        height: '2px'\n      }\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.viewerSubscriptions = []\n      this.removeUpdateSubscription = undefined\n      this._lastLegendUpdate = undefined\n\n      this.viewerSubscriptions.push(\n        this.viewer.beforeViewerChanged.addEventListener(() => {\n          if (Cesium.defined(this.removeUpdateSubscription)) {\n            this.removeUpdateSubscription()\n            this.removeUpdateSubscription = undefined\n          }\n        })\n      )\n\n      this.addUpdateSubscription()\n\n      this.viewerSubscriptions.push(\n        this.viewer.afterViewerChanged.addEventListener(() => {\n          this.addUpdateSubscription()\n        })\n      )\n    })\n  },\n  methods: {\n    addUpdateSubscription () {\n      // const that = this\n      const { defined } = Cesium\n      if (defined(this.viewer)) {\n        const scene = this.viewer.scene\n        this.removeUpdateSubscription = scene.postRender.addEventListener(() => {\n          this.updateDistanceLegendCesium(scene)\n        })\n      }\n    },\n    updateDistanceLegendCesium (scene) {\n      const { Cartesian2, defined, getTimestamp } = Cesium\n      const now = getTimestamp()\n      if (now < this._lastLegendUpdate + 250) {\n        return\n      }\n\n      this._lastLegendUpdate = now\n      const geodesic = new Cesium.EllipsoidGeodesic()\n      // Find the distance between two pixels at the bottom center of the screen.\n      const width = scene.canvas.clientWidth\n      const height = scene.canvas.clientHeight\n\n      const left = scene.camera.getPickRay(\n        new Cartesian2((width / 2) | 0, height - 1)\n      )\n      const right = scene.camera.getPickRay(\n        new Cartesian2((1 + width / 2) | 0, height - 1)\n      )\n\n      const globe = scene.globe\n      const leftPosition = globe.pick(left, scene)\n      const rightPosition = globe.pick(right, scene)\n\n      if (!defined(leftPosition) || !defined(rightPosition)) {\n        this.barWidth = undefined\n        this.distanceLabel = undefined\n        return\n      }\n\n      const leftCartographic = globe.ellipsoid.cartesianToCartographic(\n        leftPosition\n      )\n      const rightCartographic = globe.ellipsoid.cartesianToCartographic(\n        rightPosition\n      )\n\n      geodesic.setEndPoints(leftCartographic, rightCartographic)\n      const pixelDistance = geodesic.surfaceDistance\n\n      // Find the first distance that makes the scale bar less than 100 pixels.\n      const maxBarWidth = 100\n      let distance\n      for (let i = distances.length - 1; !defined(distance) && i >= 0; --i) {\n        if (distances[i] / pixelDistance < maxBarWidth) {\n          distance = distances[i]\n          if (this.distance !== distance) {\n            this.distance = distance\n            this.$emit('legendChanged', distance)\n          }\n        }\n      }\n\n      if (defined(distance)) {\n        let label\n        if (distance >= 1000) {\n          label = (distance / 1000).toString() + ' km'\n        } else {\n          label = distance.toString() + ' m'\n        }\n\n        this.barWidth = (distance / pixelDistance) | 0\n        this.distanceLabel = label\n      } else {\n        this.barWidth = undefined\n        this.distanceLabel = undefined\n      }\n    }\n  }\n}\nconst distances = [\n  1,\n  2,\n  3,\n  5,\n  10,\n  20,\n  30,\n  50,\n  100,\n  200,\n  300,\n  500,\n  1000,\n  2000,\n  3000,\n  5000,\n  10000,\n  20000,\n  30000,\n  50000,\n  100000,\n  200000,\n  300000,\n  500000,\n  1000000,\n  2000000,\n  3000000,\n  5000000,\n  10000000,\n  20000000,\n  30000000,\n  50000000\n]\n","<template>\n  <div class=\"vc-legend vc-legend-distance\" v-if=\"distanceLabel\">\n    <label>{{distanceLabel}}</label>\n    <div :style=\"barStyle\" class=\"vc-bar\" />\n  </div>\n</template>\n\n<script>\nimport '../../../assets/styles/components/legend.scss'\nexport default {\n  name: 'vc-legend-distance',\n  data () {\n    return {\n      barWidth: 0,\n      distance: 0,\n      distanceLabel: undefined\n    }\n  },\n  computed: {\n    barStyle: function () {\n      return {\n        width: this.barWidth + 'px',\n        left: 5 + (125 - this.barWidth) / 2 + 'px',\n        height: '2px'\n      }\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.viewerSubscriptions = []\n      this.removeUpdateSubscription = undefined\n      this._lastLegendUpdate = undefined\n\n      this.viewerSubscriptions.push(\n        this.viewer.beforeViewerChanged.addEventListener(() => {\n          if (Cesium.defined(this.removeUpdateSubscription)) {\n            this.removeUpdateSubscription()\n            this.removeUpdateSubscription = undefined\n          }\n        })\n      )\n\n      this.addUpdateSubscription()\n\n      this.viewerSubscriptions.push(\n        this.viewer.afterViewerChanged.addEventListener(() => {\n          this.addUpdateSubscription()\n        })\n      )\n    })\n  },\n  methods: {\n    addUpdateSubscription () {\n      // const that = this\n      const { defined } = Cesium\n      if (defined(this.viewer)) {\n        const scene = this.viewer.scene\n        this.removeUpdateSubscription = scene.postRender.addEventListener(() => {\n          this.updateDistanceLegendCesium(scene)\n        })\n      }\n    },\n    updateDistanceLegendCesium (scene) {\n      const { Cartesian2, defined, getTimestamp } = Cesium\n      const now = getTimestamp()\n      if (now < this._lastLegendUpdate + 250) {\n        return\n      }\n\n      this._lastLegendUpdate = now\n      const geodesic = new Cesium.EllipsoidGeodesic()\n      // Find the distance between two pixels at the bottom center of the screen.\n      const width = scene.canvas.clientWidth\n      const height = scene.canvas.clientHeight\n\n      const left = scene.camera.getPickRay(\n        new Cartesian2((width / 2) | 0, height - 1)\n      )\n      const right = scene.camera.getPickRay(\n        new Cartesian2((1 + width / 2) | 0, height - 1)\n      )\n\n      const globe = scene.globe\n      const leftPosition = globe.pick(left, scene)\n      const rightPosition = globe.pick(right, scene)\n\n      if (!defined(leftPosition) || !defined(rightPosition)) {\n        this.barWidth = undefined\n        this.distanceLabel = undefined\n        return\n      }\n\n      const leftCartographic = globe.ellipsoid.cartesianToCartographic(\n        leftPosition\n      )\n      const rightCartographic = globe.ellipsoid.cartesianToCartographic(\n        rightPosition\n      )\n\n      geodesic.setEndPoints(leftCartographic, rightCartographic)\n      const pixelDistance = geodesic.surfaceDistance\n\n      // Find the first distance that makes the scale bar less than 100 pixels.\n      const maxBarWidth = 100\n      let distance\n      for (let i = distances.length - 1; !defined(distance) && i >= 0; --i) {\n        if (distances[i] / pixelDistance < maxBarWidth) {\n          distance = distances[i]\n          if (this.distance !== distance) {\n            this.distance = distance\n            this.$emit('legendChanged', distance)\n          }\n        }\n      }\n\n      if (defined(distance)) {\n        let label\n        if (distance >= 1000) {\n          label = (distance / 1000).toString() + ' km'\n        } else {\n          label = distance.toString() + ' m'\n        }\n\n        this.barWidth = (distance / pixelDistance) | 0\n        this.distanceLabel = label\n      } else {\n        this.barWidth = undefined\n        this.distanceLabel = undefined\n      }\n    }\n  }\n}\nconst distances = [\n  1,\n  2,\n  3,\n  5,\n  10,\n  20,\n  30,\n  50,\n  100,\n  200,\n  300,\n  500,\n  1000,\n  2000,\n  3000,\n  5000,\n  10000,\n  20000,\n  30000,\n  50000,\n  100000,\n  200000,\n  300000,\n  500000,\n  1000000,\n  2000000,\n  3000000,\n  5000000,\n  10000000,\n  20000000,\n  30000000,\n  50000000\n]\n</script>\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport '../../../assets/styles/components/legend.scss'\nexport default {\n  name: 'vc-bar-location',\n  data () {\n    return {\n      cameraHeight: 0\n    }\n  },\n  props: {\n    showUtmZone: {\n      type: Boolean,\n      default: true\n    },\n    mouseCoords: Object\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.lastMouseX = -1\n      this.lastMouseY = -1\n      this.viewer._element.addEventListener('mousemove', this.onMouseMove, false)\n      this.viewer._element.addEventListener('touchmove', this.onMouseMove, false)\n      this.cameraHeight = this.viewer.camera.positionCartographic.height.toFixed(2)\n      this.viewer.camera.changed.addEventListener(() => {\n        this.cameraHeight = this.viewer.camera.positionCartographic.height.toFixed(2)\n      })\n      extend()\n    })\n  },\n  methods: {\n    toggleUseProjection () {\n      this.mouseCoords.toggleUseProjection()\n    },\n    onMouseMove (event) {\n      const { Cartesian2 } = Cesium\n\n      const clientX = event.type === 'mousemove' ? event.clientX : event.changedTouches[0].clientX\n      const clientY = event.type === 'mousemove' ? event.clientY : event.changedTouches[0].clientY\n      if (clientX === this.lastMouseX && clientY === this.lastMouseY) {\n        return\n      }\n\n      this.lastMouseX = clientX\n      this.lastMouseY = clientY\n\n      if (this.viewer) {\n        const rect = this.viewer._element.getBoundingClientRect()\n        const position = new Cartesian2(clientX - rect.left, clientY - rect.top)\n        this.mouseCoords.updateCoordinatesFromCesium(this.viewer, position)\n      }\n    }\n  },\n  destroyed () {\n    this.viewer._element.removeEventListener('mousemove', this.onMouseMove, false)\n    this.viewer._element.removeEventListener('touchmove', this.onMouseMove, false)\n  }\n}\n\nconst scratchArray = []\nconst scratchSphereIntersectionResult = {\n  start: 0.0,\n  stop: 0.0\n}\n\nconst scratchV0 = {}\nconst scratchV1 = {}\nconst scratchV2 = {}\nconst scratchResult = {}\nfunction extend () {\n  const {\n    Globe,\n    GlobeSurfaceTile,\n    BoundingSphere,\n    defaultValue,\n    Cartesian3,\n    defined,\n    DeveloperError,\n    IntersectionTests,\n    SceneMode\n  } = Cesium\n  Globe.prototype.pickTriangle =\n    Globe.prototype.pickTriangle ||\n    function (ray, scene, cullBackFaces, result) {\n      // >>includeStart('debug', pragmas.debug);\n      if (!defined(ray)) {\n        throw new DeveloperError('ray is required')\n      }\n      if (!defined(scene)) {\n        throw new DeveloperError('scene is required')\n      }\n      // >>includeEnd('debug');\n\n      cullBackFaces = defaultValue(cullBackFaces, true)\n\n      const mode = scene.mode\n      const projection = scene.mapProjection\n\n      const sphereIntersections = scratchArray\n      sphereIntersections.length = 0\n\n      const tilesToRender = this._surface._tilesToRender\n      let length = tilesToRender.length\n\n      let tile\n      let i\n\n      for (i = 0; i < length; ++i) {\n        tile = tilesToRender[i]\n        const surfaceTile = tile.data\n\n        if (!defined(surfaceTile)) {\n          continue\n        }\n\n        const boundingVolume = surfaceTile.pickBoundingSphere\n        if (mode !== SceneMode.SCENE3D) {\n          BoundingSphere.fromRectangleWithHeights2D(\n            tile.rectangle,\n            projection,\n            surfaceTile.minimumHeight,\n            surfaceTile.maximumHeight,\n            boundingVolume\n          )\n          Cartesian3.fromElements(\n            boundingVolume.center.z,\n            boundingVolume.center.x,\n            boundingVolume.center.y,\n            boundingVolume.center\n          )\n        } else {\n          BoundingSphere.clone(surfaceTile.boundingSphere3D, boundingVolume)\n        }\n\n        const boundingSphereIntersection = IntersectionTests.raySphere(ray, boundingVolume, scratchSphereIntersectionResult)\n        if (defined(boundingSphereIntersection)) {\n          sphereIntersections.push(tile)\n        }\n      }\n\n      sphereIntersections.sort(createComparePickTileFunction(ray.origin))\n\n      let intersection\n      length = sphereIntersections.length\n      for (i = 0; i < length; ++i) {\n        intersection = sphereIntersections[i].data.pickTriangle(ray, scene.mode, scene.mapProjection, cullBackFaces, result)\n        if (defined(intersection)) {\n          intersection.tile = sphereIntersections[i]\n          break\n        }\n      }\n\n      return intersection\n    }\n\n  GlobeSurfaceTile.prototype.pickTriangle =\n    GlobeSurfaceTile.prototype.pickTriangle ||\n    function (ray, mode, projection, cullBackFaces) {\n      const mesh = this.renderedMesh\n      if (!defined(mesh)) {\n        return undefined\n      }\n\n      const vertices = mesh.vertices\n      const indices = mesh.indices\n      const encoding = mesh.encoding\n\n      const length = indices.length\n      for (let i = 0; i < length; i += 3) {\n        const i0 = indices[i]\n        const i1 = indices[i + 1]\n        const i2 = indices[i + 2]\n\n        const v0 = getPosition(encoding, mode, projection, vertices, i0, scratchV0)\n        const v1 = getPosition(encoding, mode, projection, vertices, i1, scratchV1)\n        const v2 = getPosition(encoding, mode, projection, vertices, i2, scratchV2)\n\n        const intersection = IntersectionTests.rayTriangle(ray, v0, v1, v2, cullBackFaces, scratchResult)\n        if (defined(intersection)) {\n          return {\n            intersection: intersection,\n            v0: v0,\n            v1: v1,\n            v2: v2\n          }\n        }\n      }\n\n      return undefined\n    }\n}\n\nfunction createComparePickTileFunction (rayOrigin) {\n  const { BoundingSphere } = Cesium\n  return function (a, b) {\n    const aDist = BoundingSphere.distanceSquaredTo(a.data.pickBoundingSphere, rayOrigin)\n    const bDist = BoundingSphere.distanceSquaredTo(b.data.pickBoundingSphere, rayOrigin)\n\n    return aDist - bDist\n  }\n}\n\nfunction getPosition (encoding, mode, projection, vertices, index, result) {\n  encoding.decodePosition(vertices, index, result)\n  const { Cartesian3, defined, SceneMode } = Cesium\n  if (defined(mode) && mode !== SceneMode.SCENE3D) {\n    const ellipsoid = projection.ellipsoid\n    const positionCart = ellipsoid.cartesianToCartographic(result)\n    projection.project(positionCart, result)\n    Cartesian3.fromElements(result.z, result.x, result.y, result)\n  }\n\n  return result\n}\n","<template>\n  <button @click=\"toggleUseProjection\" class=\"vc-legend vc-bar-location\" type=\"button\">\n    <template v-if=\"!mouseCoords.useProjection\">\n      <div class=\"vc-section\">\n        <span>{{ $vc.lang.navigation.legend.lon }}</span>\n        <span>{{ mouseCoords.longitude }}</span>\n      </div>\n      <div class=\"vc-section\">\n        <span>{{ $vc.lang.navigation.legend.lat }}</span>\n        <span>{{ mouseCoords.latitude }}</span>\n      </div>\n    </template>\n    <template v-else>\n      <div class=\"vc-section-short\">\n        <span>{{ $vc.lang.navigation.legend.zone }}</span>\n        <span>{{ mouseCoords.utmZone }}</span>\n      </div>\n      <div class=\"vc-section\">\n        <span>{{ $vc.lang.navigation.legend.e }}</span>\n        <span>{{ mouseCoords.east }}</span>\n      </div>\n      <div class=\"vc-section\">\n        <span>{{ $vc.lang.navigation.legend.n }}</span>\n        <span>{{ mouseCoords.north }}</span>\n      </div>\n    </template>\n    <div class=\"vc-section-long\" v-if=\"mouseCoords.elevation\">\n      <span>{{ $vc.lang.navigation.legend.elev }}</span>\n      <span>{{ mouseCoords.elevation }}</span>\n    </div>\n    <div class=\"vc-section-long\" v-if=\"cameraHeight < 20000000\">\n      <span>{{ $vc.lang.navigation.legend.cameraHeight }}</span>\n      <span>{{ cameraHeight }}</span>\n    </div>\n  </button>\n</template>\n\n<script>\nimport '../../../assets/styles/components/legend.scss'\nexport default {\n  name: 'vc-bar-location',\n  data () {\n    return {\n      cameraHeight: 0\n    }\n  },\n  props: {\n    showUtmZone: {\n      type: Boolean,\n      default: true\n    },\n    mouseCoords: Object\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.lastMouseX = -1\n      this.lastMouseY = -1\n      this.viewer._element.addEventListener('mousemove', this.onMouseMove, false)\n      this.viewer._element.addEventListener('touchmove', this.onMouseMove, false)\n      this.cameraHeight = this.viewer.camera.positionCartographic.height.toFixed(2)\n      this.viewer.camera.changed.addEventListener(() => {\n        this.cameraHeight = this.viewer.camera.positionCartographic.height.toFixed(2)\n      })\n      extend()\n    })\n  },\n  methods: {\n    toggleUseProjection () {\n      this.mouseCoords.toggleUseProjection()\n    },\n    onMouseMove (event) {\n      const { Cartesian2 } = Cesium\n\n      const clientX = event.type === 'mousemove' ? event.clientX : event.changedTouches[0].clientX\n      const clientY = event.type === 'mousemove' ? event.clientY : event.changedTouches[0].clientY\n      if (clientX === this.lastMouseX && clientY === this.lastMouseY) {\n        return\n      }\n\n      this.lastMouseX = clientX\n      this.lastMouseY = clientY\n\n      if (this.viewer) {\n        const rect = this.viewer._element.getBoundingClientRect()\n        const position = new Cartesian2(clientX - rect.left, clientY - rect.top)\n        this.mouseCoords.updateCoordinatesFromCesium(this.viewer, position)\n      }\n    }\n  },\n  destroyed () {\n    this.viewer._element.removeEventListener('mousemove', this.onMouseMove, false)\n    this.viewer._element.removeEventListener('touchmove', this.onMouseMove, false)\n  }\n}\n\nconst scratchArray = []\nconst scratchSphereIntersectionResult = {\n  start: 0.0,\n  stop: 0.0\n}\n\nconst scratchV0 = {}\nconst scratchV1 = {}\nconst scratchV2 = {}\nconst scratchResult = {}\nfunction extend () {\n  const {\n    Globe,\n    GlobeSurfaceTile,\n    BoundingSphere,\n    defaultValue,\n    Cartesian3,\n    defined,\n    DeveloperError,\n    IntersectionTests,\n    SceneMode\n  } = Cesium\n  Globe.prototype.pickTriangle =\n    Globe.prototype.pickTriangle ||\n    function (ray, scene, cullBackFaces, result) {\n      // >>includeStart('debug', pragmas.debug);\n      if (!defined(ray)) {\n        throw new DeveloperError('ray is required')\n      }\n      if (!defined(scene)) {\n        throw new DeveloperError('scene is required')\n      }\n      // >>includeEnd('debug');\n\n      cullBackFaces = defaultValue(cullBackFaces, true)\n\n      const mode = scene.mode\n      const projection = scene.mapProjection\n\n      const sphereIntersections = scratchArray\n      sphereIntersections.length = 0\n\n      const tilesToRender = this._surface._tilesToRender\n      let length = tilesToRender.length\n\n      let tile\n      let i\n\n      for (i = 0; i < length; ++i) {\n        tile = tilesToRender[i]\n        const surfaceTile = tile.data\n\n        if (!defined(surfaceTile)) {\n          continue\n        }\n\n        const boundingVolume = surfaceTile.pickBoundingSphere\n        if (mode !== SceneMode.SCENE3D) {\n          BoundingSphere.fromRectangleWithHeights2D(\n            tile.rectangle,\n            projection,\n            surfaceTile.minimumHeight,\n            surfaceTile.maximumHeight,\n            boundingVolume\n          )\n          Cartesian3.fromElements(\n            boundingVolume.center.z,\n            boundingVolume.center.x,\n            boundingVolume.center.y,\n            boundingVolume.center\n          )\n        } else {\n          BoundingSphere.clone(surfaceTile.boundingSphere3D, boundingVolume)\n        }\n\n        const boundingSphereIntersection = IntersectionTests.raySphere(ray, boundingVolume, scratchSphereIntersectionResult)\n        if (defined(boundingSphereIntersection)) {\n          sphereIntersections.push(tile)\n        }\n      }\n\n      sphereIntersections.sort(createComparePickTileFunction(ray.origin))\n\n      let intersection\n      length = sphereIntersections.length\n      for (i = 0; i < length; ++i) {\n        intersection = sphereIntersections[i].data.pickTriangle(ray, scene.mode, scene.mapProjection, cullBackFaces, result)\n        if (defined(intersection)) {\n          intersection.tile = sphereIntersections[i]\n          break\n        }\n      }\n\n      return intersection\n    }\n\n  GlobeSurfaceTile.prototype.pickTriangle =\n    GlobeSurfaceTile.prototype.pickTriangle ||\n    function (ray, mode, projection, cullBackFaces) {\n      const mesh = this.renderedMesh\n      if (!defined(mesh)) {\n        return undefined\n      }\n\n      const vertices = mesh.vertices\n      const indices = mesh.indices\n      const encoding = mesh.encoding\n\n      const length = indices.length\n      for (let i = 0; i < length; i += 3) {\n        const i0 = indices[i]\n        const i1 = indices[i + 1]\n        const i2 = indices[i + 2]\n\n        const v0 = getPosition(encoding, mode, projection, vertices, i0, scratchV0)\n        const v1 = getPosition(encoding, mode, projection, vertices, i1, scratchV1)\n        const v2 = getPosition(encoding, mode, projection, vertices, i2, scratchV2)\n\n        const intersection = IntersectionTests.rayTriangle(ray, v0, v1, v2, cullBackFaces, scratchResult)\n        if (defined(intersection)) {\n          return {\n            intersection: intersection,\n            v0: v0,\n            v1: v1,\n            v2: v2\n          }\n        }\n      }\n\n      return undefined\n    }\n}\n\nfunction createComparePickTileFunction (rayOrigin) {\n  const { BoundingSphere } = Cesium\n  return function (a, b) {\n    const aDist = BoundingSphere.distanceSquaredTo(a.data.pickBoundingSphere, rayOrigin)\n    const bDist = BoundingSphere.distanceSquaredTo(b.data.pickBoundingSphere, rayOrigin)\n\n    return aDist - bDist\n  }\n}\n\nfunction getPosition (encoding, mode, projection, vertices, index, result) {\n  encoding.decodePosition(vertices, index, result)\n  const { Cartesian3, defined, SceneMode } = Cesium\n  if (defined(mode) && mode !== SceneMode.SCENE3D) {\n    const ellipsoid = projection.ellipsoid\n    const positionCart = ellipsoid.cartesianToCartographic(result)\n    projection.project(positionCart, result)\n    Cartesian3.fromElements(result.z, result.x, result.y, result)\n  }\n\n  return result\n}\n</script>\n","import VcIconSvg from './VcIconSvg.vue'\nVcIconSvg.register({\n  share: {\n    width: 16,\n    height: 16,\n    viewBox: '0 0 16 16',\n    data: `\n    <!-- Generator: Sketch 43.2 (39069) - http://www.bohemiancoding.com/sketch -->\n    <!-- <title>Mask</title> -->\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\">\n      <g id=\"share-20\" fill-rule=\"nonzero\">\n        <g id=\"Mask\">\n            <path d=\"M5.97733131,7.62936833 C5.99229467,7.75081434 6,7.87450733 6,8 C6,8.1254927 5.99229467,8.2491857 5.97733131,8.3706317 L10.9173886,10.8406603 C11.456951,10.3201529 12.1910876,10 13,10 C14.6568542,10 16,11.3431458 16,13 C16,14.6568542 14.6568542,16 13,16 C11.3431458,16 10,14.6568542 10,13 C10,12.8745073 10.0077053,12.7508143 10.0226687,12.6293683 L5.08261143,10.1593397 C4.54304902,10.6798471 3.80891237,11 3,11 C1.34314575,11 0,9.6568542 0,8 C0,6.34314575 1.34314575,5 3,5 C3.80891237,5 4.54304902,5.32015293 5.08261143,5.84066029 L10.0226687,3.37063167 C10.0077053,3.24918566 10,3.12549267 10,3 C10,1.34314575 11.3431458,0 13,0 C14.6568542,0 16,1.34314575 16,3 C16,4.65685425 14.6568542,6 13,6 C12.1910876,6 11.456951,5.67984707 10.9173886,5.15933971 L5.97733131,7.62936833 Z M13,14 C13.5522847,14 14,13.5522847 14,13 C14,12.4477153 13.5522847,12 13,12 C12.4477153,12 12,12.4477153 12,13 C12,13.5522847 12.4477153,14 13,14 Z M13,4 C13.5522847,4 14,3.55228475 14,3 C14,2.44771525 13.5522847,2 13,2 C12.4477153,2 12,2.44771525 12,3 C12,3.55228475 12.4477153,4 13,4 Z M3,9 C3.55228475,9 4,8.5522847 4,8 C4,7.44771525 3.55228475,7 3,7 C2.44771525,7 2,7.44771525 2,8 C2,8.5522847 2.44771525,9 3,9 Z\" id=\"path-1\"></path>\n        </g>\n      </g>\n    </g>`\n  }\n})\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { captureScreenshot, getAllAttribution } from '../../../utils/util'\nexport default {\n  props: {\n    options: Object\n  },\n  data () {\n    return {\n      mapImageDataUrl: undefined,\n      ready: false,\n      credits: []\n    }\n  },\n  mounted () {\n    captureScreenshot(this.options.viewer).then(mapImageDataUrl => {\n      // We need to periodically check whether all images are loaded.\n      // We can theoretically do that either with a setInterval on the original TerriaJS window,\n      // or on the print view window. But:\n      //    * Chrome (as of v66.0.3359.139 anyway) seems to aggressively suspend setInterval calls in background\n      // tabs, so only a setInterval on the print view window works reliably.\n      //    * Internet Explorer 11 does not seem to allow a cross-window setInterval call, so only a setInterval\n      // on the original TerriaJS window works reliably.\n      // So, we'll do both.\n      const printWindow = this.options.printWindow\n      const mainWindow = window\n\n      const printWindowIntervalId = printWindow.setInterval(\n        this.checkForImagesReady,\n        200\n      )\n      const mainWindowIntervalId = mainWindow.setInterval(\n        this.checkForImagesReady,\n        200\n      )\n\n      this._stopCheckingForImages = () => {\n        printWindow.clearInterval(printWindowIntervalId)\n        mainWindow.clearInterval(mainWindowIntervalId)\n        this._stopCheckingForImages = undefined\n      }\n\n      this.mapImageDataUrl = mapImageDataUrl\n    })\n    this.credits = getAllAttribution(this.options.viewer)\n  },\n  methods: {\n    checkForImagesReady () {\n      if (this.ready) {\n        return\n      }\n      const imageTags = this.options.printWindow.document.getElementsByTagName('img')\n      if (imageTags.length === 0) {\n        return\n      }\n\n      let allImagesReady = true\n      for (let i = 0; allImagesReady && i < imageTags.length; ++i) {\n        allImagesReady = imageTags[i].complete\n      }\n\n      if (allImagesReady) {\n        this.stopCheckingForImages()\n        this.ready = allImagesReady\n        this.$emit('ready', this.options.printWindow)\n      }\n    },\n    stopCheckingForImages () {\n      if (this._stopCheckingForImages) {\n        this._stopCheckingForImages()\n      }\n    }\n  },\n  destroyed () {\n    this.stopCheckingForImages()\n  }\n}\n","<template>\n  <div>\n    <p>\n      <img :src=\"mapImageDataUrl\" alt=\"Map snaphot\" class=\"vc-map-image\" />\n    </p>\n    <h1 v-if=\"credits.length > 0 && options.showCredit\">Map Credits</h1>\n    <ul v-if=\"credits.length > 0 && options.showCredit\">\n      <template v-for=\"(credit, index) in credits \">\n        <li :key=\"'credit' + index\" v-html=\"credit\"></li>\n      </template>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { captureScreenshot, getAllAttribution } from '../../../utils/util'\nexport default {\n  props: {\n    options: Object\n  },\n  data () {\n    return {\n      mapImageDataUrl: undefined,\n      ready: false,\n      credits: []\n    }\n  },\n  mounted () {\n    captureScreenshot(this.options.viewer).then(mapImageDataUrl => {\n      // We need to periodically check whether all images are loaded.\n      // We can theoretically do that either with a setInterval on the original TerriaJS window,\n      // or on the print view window. But:\n      //    * Chrome (as of v66.0.3359.139 anyway) seems to aggressively suspend setInterval calls in background\n      // tabs, so only a setInterval on the print view window works reliably.\n      //    * Internet Explorer 11 does not seem to allow a cross-window setInterval call, so only a setInterval\n      // on the original TerriaJS window works reliably.\n      // So, we'll do both.\n      const printWindow = this.options.printWindow\n      const mainWindow = window\n\n      const printWindowIntervalId = printWindow.setInterval(\n        this.checkForImagesReady,\n        200\n      )\n      const mainWindowIntervalId = mainWindow.setInterval(\n        this.checkForImagesReady,\n        200\n      )\n\n      this._stopCheckingForImages = () => {\n        printWindow.clearInterval(printWindowIntervalId)\n        mainWindow.clearInterval(mainWindowIntervalId)\n        this._stopCheckingForImages = undefined\n      }\n\n      this.mapImageDataUrl = mapImageDataUrl\n    })\n    this.credits = getAllAttribution(this.options.viewer)\n  },\n  methods: {\n    checkForImagesReady () {\n      if (this.ready) {\n        return\n      }\n      const imageTags = this.options.printWindow.document.getElementsByTagName('img')\n      if (imageTags.length === 0) {\n        return\n      }\n\n      let allImagesReady = true\n      for (let i = 0; allImagesReady && i < imageTags.length; ++i) {\n        allImagesReady = imageTags[i].complete\n      }\n\n      if (allImagesReady) {\n        this.stopCheckingForImages()\n        this.ready = allImagesReady\n        this.$emit('ready', this.options.printWindow)\n      }\n    },\n    stopCheckingForImages () {\n      if (this._stopCheckingForImages) {\n        this._stopCheckingForImages()\n      }\n    }\n  },\n  destroyed () {\n    this.stopCheckingForImages()\n  }\n}\n</script>\n","//\n//\n//\n//\n//\n//\n//\n\nimport './icon/share'\nimport printWindow from '../../../exts/printWindow'\nimport '../../../assets/styles/components/toolButton.scss'\nimport VcIconSvg from './icon/VcIconSvg.vue'\nimport VcPrintView from './VcPrintView.vue'\nimport Vue from 'vue'\nexport default {\n  name: 'vc-view-print',\n  components: {\n    VcIconSvg\n  },\n  props: {\n    printAutomatically: Boolean,\n    showCredit: {\n      type: Boolean,\n      default: true\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n    })\n  },\n  methods: {\n    handleCick () {\n      this.createPrintView()\n    },\n    createPrintView () {\n      const { viewer, showCredit, printAutomatically } = this\n      this.creatingPrintView = true\n      if (printAutomatically) {\n        this.iframe = document.createElement('iframe')\n        document.body.appendChild(this.iframe)\n      }\n      const newWindow = createWindow({\n        printWindow: this.iframe ? this.iframe.contentWindow : undefined,\n        closeCallback: (windowToPrint) => {\n          if (printAutomatically) {\n            this.creatingPrintView = false\n          }\n        }\n      })\n\n      const options = {\n        viewer: viewer,\n        printWindow: newWindow,\n        showCredit: showCredit\n      }\n      new Vue({\n        render: h => h(VcPrintView, { props: { options }, on: { ready: this.printViewReady } })\n      }).$mount(newWindow.document.getElementById('print'))\n      if (!printAutomatically) {\n        this.creatingPrintView = false\n      }\n    },\n    printViewReady (windowToPrint) {\n      const { printAutomatically, iframe } = this\n      if (printAutomatically) {\n        printWindow(windowToPrint)\n          .otherwise((e) => {\n            console.error(e)\n          })\n          .always(() => {\n            if (iframe) {\n              document.body.removeChild(iframe)\n            }\n            if (printAutomatically) {\n              this.creatingPrintView = false\n            }\n          })\n      }\n    },\n    printViewClosed (windowToPrint) {\n      if (this.printAutomatically) {\n        this.creatingPrintView = false\n      }\n    }\n  }\n}\n\nfunction createWindow (options) {\n  const { printWindow = window.open(), closeCallback } = options\n  if (closeCallback) {\n    printWindow.addEventListener('unload', () => {\n      closeCallback(printWindow)\n    })\n  }\n\n  // Open and immediately close the document. This works around a problem in Firefox that is\n  // captured here: https://bugzilla.mozilla.org/show_bug.cgi?id=667227.\n  // Essentially, when we first create an iframe, it has no document loaded and asynchronously\n  // starts a load of \"about:blank\". If we access the document object and start manipulating it\n  // before that async load completes, a new document will be automatically created. But then\n  // when the async load completes, the original, automatically-created document gets unloaded\n  // and the new \"about:blank\" gets swapped in. End result: everything we add to the DOM before\n  // the async load complete gets lost and Firefox ends up printing a blank page.\n  // Explicitly opening and then closing a new document _seems_ to avoid this.\n  printWindow.document.open()\n  printWindow.document.close()\n  printWindow.document.head.innerHTML = `\n    <meta charset=\"UTF-8\">\n    <title>VueCesium Print View</title>\n    <style>\n      .background {\n        width: 100%;\n        fill: rgba(255, 255, 255, 1.0);\n      }\n      .map-image {\n        max-width: 95vw;\n        max-height: 95vh;\n      }\n      h1, h2, h3 {\n        clear: both;\n      }\n      </style>\n    `\n  printWindow.document.body.innerHTML = '<div id=\"print\"></div>'\n  return printWindow\n}\n","<template>\n  <div class=\"vc-tool-btn\">\n    <button :title=\"$vc.lang.navigation.printView\" @click=\"handleCick\" class=\"vc-btn\" type=\"button\">\n      <vc-icon-svg name=\"share\"></vc-icon-svg>\n    </button>\n  </div>\n</template>\n<script>\nimport './icon/share'\nimport printWindow from '../../../exts/printWindow'\nimport '../../../assets/styles/components/toolButton.scss'\nimport VcIconSvg from './icon/VcIconSvg.vue'\nimport VcPrintView from './VcPrintView.vue'\nimport Vue from 'vue'\nexport default {\n  name: 'vc-view-print',\n  components: {\n    VcIconSvg\n  },\n  props: {\n    printAutomatically: Boolean,\n    showCredit: {\n      type: Boolean,\n      default: true\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n    })\n  },\n  methods: {\n    handleCick () {\n      this.createPrintView()\n    },\n    createPrintView () {\n      const { viewer, showCredit, printAutomatically } = this\n      this.creatingPrintView = true\n      if (printAutomatically) {\n        this.iframe = document.createElement('iframe')\n        document.body.appendChild(this.iframe)\n      }\n      const newWindow = createWindow({\n        printWindow: this.iframe ? this.iframe.contentWindow : undefined,\n        closeCallback: (windowToPrint) => {\n          if (printAutomatically) {\n            this.creatingPrintView = false\n          }\n        }\n      })\n\n      const options = {\n        viewer: viewer,\n        printWindow: newWindow,\n        showCredit: showCredit\n      }\n      new Vue({\n        render: h => h(VcPrintView, { props: { options }, on: { ready: this.printViewReady } })\n      }).$mount(newWindow.document.getElementById('print'))\n      if (!printAutomatically) {\n        this.creatingPrintView = false\n      }\n    },\n    printViewReady (windowToPrint) {\n      const { printAutomatically, iframe } = this\n      if (printAutomatically) {\n        printWindow(windowToPrint)\n          .otherwise((e) => {\n            console.error(e)\n          })\n          .always(() => {\n            if (iframe) {\n              document.body.removeChild(iframe)\n            }\n            if (printAutomatically) {\n              this.creatingPrintView = false\n            }\n          })\n      }\n    },\n    printViewClosed (windowToPrint) {\n      if (this.printAutomatically) {\n        this.creatingPrintView = false\n      }\n    }\n  }\n}\n\nfunction createWindow (options) {\n  const { printWindow = window.open(), closeCallback } = options\n  if (closeCallback) {\n    printWindow.addEventListener('unload', () => {\n      closeCallback(printWindow)\n    })\n  }\n\n  // Open and immediately close the document. This works around a problem in Firefox that is\n  // captured here: https://bugzilla.mozilla.org/show_bug.cgi?id=667227.\n  // Essentially, when we first create an iframe, it has no document loaded and asynchronously\n  // starts a load of \"about:blank\". If we access the document object and start manipulating it\n  // before that async load completes, a new document will be automatically created. But then\n  // when the async load completes, the original, automatically-created document gets unloaded\n  // and the new \"about:blank\" gets swapped in. End result: everything we add to the DOM before\n  // the async load complete gets lost and Firefox ends up printing a blank page.\n  // Explicitly opening and then closing a new document _seems_ to avoid this.\n  printWindow.document.open()\n  printWindow.document.close()\n  printWindow.document.head.innerHTML = `\n    <meta charset=\"UTF-8\">\n    <title>VueCesium Print View</title>\n    <style>\n      .background {\n        width: 100%;\n        fill: rgba(255, 255, 255, 1.0);\n      }\n      .map-image {\n        max-width: 95vw;\n        max-height: 95vh;\n      }\n      h1, h2, h3 {\n        clear: both;\n      }\n      </style>\n    `\n  printWindow.document.body.innerHTML = '<div id=\"print\"></div>'\n  return printWindow\n}\n</script>\n","import VcIconSvg from './VcIconSvg.vue'\nVcIconSvg.register({\n  geolocation: {\n    width: 50,\n    height: 50,\n    viewBox: '0 0 50 50',\n    data: `\n    <!-- Generator: Sketch 3.4.3 (16044) - http://www.bohemiancoding.com/sketch -->\n    <!-- <title>geolocation</title> -->\n    <path d=\"M25.2083333,40.9848485 L25.2083333,40.9848485 C33.9214621,40.9848485 40.9848485,33.9214621 40.9848485,25.2083333 C40.9848485,16.4952046 33.9214621,9.43181817 25.2083333,9.43181817 C16.4952046,9.43181817 9.43181817,16.4952046 9.43181817,25.2083333 C9.43181817,33.9214621 16.4952046,40.9848485 25.2083333,40.9848485 L25.2083333,40.9848485 L25.2083333,40.9848485 Z M6.485903,23.7069504 C7.21162342,14.5314545 14.5314545,7.21162342 23.7069504,6.485903 C23.7061912,6.46628533 23.7058081,6.44657125 23.7058081,6.42676767 L23.7058081,1.91919192 C23.7058081,1.08937017 24.3785116,0.416666667 25.2083333,0.416666667 C26.0381551,0.416666667 26.7108586,1.08937017 26.7108586,1.91919192 L26.7108586,6.42676767 C26.7108586,6.44657125 26.7104755,6.46628533 26.7097162,6.485903 C35.8852122,7.21162342 43.2050433,14.5314545 43.9307637,23.7069504 C43.9503813,23.7061912 43.9700954,23.7058081 43.989899,23.7058081 L48.4974747,23.7058081 C49.3272965,23.7058081 50,24.3785116 50,25.2083333 C50,26.0381551 49.3272965,26.7108586 48.4974747,26.7108586 L43.989899,26.7108586 C43.9700954,26.7108586 43.9503813,26.7104755 43.9307637,26.7097162 C43.2050433,35.8852122 35.8852122,43.2050433 26.7097162,43.9307637 C26.7104755,43.9503813 26.7108586,43.9700954 26.7108586,43.989899 L26.7108586,48.4974747 C26.7108586,49.3272965 26.0381551,50 25.2083333,50 C24.3785116,50 23.7058081,49.3272965 23.7058081,48.4974747 L23.7058081,43.989899 C23.7058081,43.9700954 23.7061912,43.9503813 23.7069504,43.9307637 C14.5314545,43.2050433 7.21162342,35.8852122 6.485903,26.7097162 C6.46628533,26.7104755 6.44657125,26.7108586 6.42676767,26.7108586 L1.91919192,26.7108586 C1.08937017,26.7108586 0.416666667,26.0381551 0.416666667,25.2083333 C0.416666667,24.3785116 1.08937017,23.7058081 1.91919192,23.7058081 L6.42676767,23.7058081 C6.44657125,23.7058081 6.46628533,23.7061912 6.485903,23.7069504 L6.485903,23.7069504 Z M25.2083333,29.7159091 C27.6977987,29.7159091 29.7159091,27.6977987 29.7159091,25.2083333 C29.7159091,22.718868 27.6977987,20.7007576 25.2083333,20.7007576 C22.718868,20.7007576 20.7007576,22.718868 20.7007576,25.2083333 C20.7007576,27.6977987 22.718868,29.7159091 25.2083333,29.7159091 L25.2083333,29.7159091 Z\" id=\"Shape\"></path>`\n  }\n})\n","//\n//\n//\n//\n//\n//\n//\n//\n\nimport './icon/geolocation'\nimport '../../../assets/styles/components/toolButton.scss'\nimport VcIconSvg from './icon/VcIconSvg.vue'\nimport AMapLoader from '@amap/amap-jsapi-loader'\nexport default {\n  components: {\n    VcIconSvg\n  },\n  props: {\n    enableMyLocation: [Object, Boolean]\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.viewer.dataSources.add(new Cesium.CustomDataSource('vc-myLocation')).then((ds) => {\n        this.datasource = ds\n      })\n      const { enableMyLocation } = this\n      if (enableMyLocation.amap && enableMyLocation.amap.key) {\n        AMapLoader.load({\n          key: enableMyLocation.amap.key,\n          version: '2.0',\n          plugins: ['AMap.Geolocation']\n        }).then((AMap) => {\n          this.AMap = AMap\n          this.amapGeolocation = new AMap.Geolocation({\n            // 是否使用高精度定位，默认：true\n            enableHighAccuracy: true,\n            convert: false,\n            // 设置定位超时时间，默认：无穷大\n            timeout: 20000\n          })\n        }).catch(e => {\n          console.error('[VueCesium] ERROR: ' + e)\n        })\n      }\n    })\n  },\n  destroyed () {\n    this.viewer.dataSources.remove(this.datasource, true)\n    if (this.amapGeolocation) {\n      const scripts = document.getElementsByTagName('script')\n      const removeScripts = []\n      for (const script of scripts) {\n        if (script.src.indexOf('/webapi.amap.com/maps') > -1) {\n          removeScripts.push(script)\n        }\n      }\n      removeScripts.forEach((script) => {\n        document.getElementsByTagName('body')[0].removeChild(script)\n      })\n    }\n  },\n  methods: {\n    handleCick () {\n      const { enableMyLocation, getLocation } = this\n      if (enableMyLocation.amap && enableMyLocation.amap.key) {\n        this.amapGeolocation.getCurrentPosition((status, result) => {\n          if (status === 'complete') {\n            this.$emit('geolocation', result)\n            this.zoomToMyLocation({\n              lng: result.position.lng,\n              lat: result.position.lat\n            })\n          } else {\n            console.error('[VueCesium] ERROR: ' + result.message)\n          }\n        })\n      } else {\n        getLocation()\n      }\n    },\n    getLocation () {\n      if (navigator.geolocation) {\n        const options = {\n          enableHighAccuracy: true,\n          timeout: 5000,\n          maximumAge: 0\n        }\n        navigator.geolocation.getCurrentPosition((position) => {\n          this.$emit('geolocation', position)\n          this.zoomToMyLocation({\n            lng: position.coords.longitude,\n            lat: position.coords.latitude\n          })\n        }, this.handleLocationError, options)\n      } else {\n        console.error('[VueCesium] ERROR: ' + 'Your browser cannot provide your location.')\n      }\n    },\n    // This next function modelled on Cesium.geoJsonDataSource's defaultDescribe.\n    describeWithoutUnderscores (properties, nameProperty) {\n      let html = ''\n      if (properties instanceof Cesium.PropertyBag) {\n        // unwrap the properties from the PropertyBag\n        properties = properties.getValue(Cesium.JulianDate.now())\n      }\n      for (let key in properties) {\n        if (Object.prototype.hasOwnProperty.call(properties, key)) {\n          if (key === nameProperty) {\n            continue\n          }\n          let value = properties[key]\n          if (typeof value === 'object') {\n            value = this.describeWithoutUnderscores(value)\n          } else {\n            // value = formatPropertyValue(value)\n          }\n          key = key.replace(/_/g, ' ')\n          if (Cesium.defined(value)) {\n            html += '<tr><th>' + key + '</th><td>' + value + '</td></tr>'\n          }\n        }\n      }\n      if (html.length > 0) {\n        html = '<table class=\"cesium-infoBox-defaultTable\"><tbody>' + html + '</tbody></table>'\n      }\n      return html\n    },\n    zoomToMyLocation (position) {\n      const longitude = position.lng\n      const latitude = position.lat\n      const { Cartesian3, Rectangle, sampleTerrain, defined, SceneMode } = Cesium\n      const { datasource, describeWithoutUnderscores } = this\n\n      datasource.entities.removeAll()\n      const myPositionEntity = datasource.entities.add({\n        id: 'My Location',\n        position: Cartesian3.fromDegrees(longitude, latitude),\n        point: {\n          color: Cesium.Color.fromCssColorString('#08ABD5'),\n          pixelSize: 25 / 2,\n          outlineWidth: 3,\n          outlineColor: Cesium.Color.fromCssColorString('#ffffff')\n        },\n        description: describeWithoutUnderscores({\n          longitude: longitude,\n          latitude: latitude\n        })\n      })\n\n      const options = {\n        duration: this.duration\n      }\n\n      defined(this.enableMyLocation.maximumHeight) && (options.maximumHeight = this.enableMyLocation.maximumHeight)\n      defined(this.enableMyLocation.hpr) && Array.isArray(this.enableMyLocation.hpr) &&\n        (options.offset = new Cesium.HeadingPitchRange(this.enableMyLocation.hpr[0], this.enableMyLocation.hpr[1], this.enableMyLocation.hpr[2]))\n\n      if (this.viewer.scene.mode === SceneMode.SCENE2D || this.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n        return this.viewer.flyTo(myPositionEntity, options)\n      }\n\n      // west, south, east, north, result\n      const rectangle = Rectangle.fromDegrees(longitude - 0.01, latitude - 0.01, longitude + 0.01, latitude + 0.01)\n      const camera = this.viewer.scene.camera\n      // Work out the destination that the camera would naturally fly to\n      const destinationCartesian = camera.getRectangleCameraCoordinates(rectangle)\n      const destination = this.viewer.scene.globe.ellipsoid.cartesianToCartographic(destinationCartesian)\n      const terrainProvider = this.viewer.scene.globe.terrainProvider\n      const level = 6 // A sufficiently coarse tile level that still has approximately accurate height\n      const positions = [Rectangle.center(rectangle)]\n\n      // Perform an elevation query at the centre of the rectangle\n      return sampleTerrain(terrainProvider, level, positions).then(function (results) {\n        // Add terrain elevation to camera altitude\n        const finalDestinationCartographic = {\n          longitude: destination.longitude,\n          latitude: destination.latitude,\n          height: destination.height + results[0].height\n        }\n        const finalDestination = this.viewer.scene.globe.ellipsoid.cartographicToCartesian(finalDestinationCartographic)\n\n        camera.flyTo({\n          duration: 3,\n          destination: finalDestination\n        })\n      })\n    },\n    handleLocationError (err) {\n      console.error('[VueCesium] ERROR: ' + err.message)\n    }\n  }\n}\n","<template>\n  <div class=\"vc-tool-btn\">\n    <button :title=\"$vc.lang.navigation.centreMap\" @click=\"handleCick\" class=\"vc-btn\" type=\"button\">\n      <vc-icon-svg name=\"geolocation\"></vc-icon-svg>\n    </button>\n  </div>\n</template>\n\n<script>\nimport './icon/geolocation'\nimport '../../../assets/styles/components/toolButton.scss'\nimport VcIconSvg from './icon/VcIconSvg.vue'\nimport AMapLoader from '@amap/amap-jsapi-loader'\nexport default {\n  components: {\n    VcIconSvg\n  },\n  props: {\n    enableMyLocation: [Object, Boolean]\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.viewer.dataSources.add(new Cesium.CustomDataSource('vc-myLocation')).then((ds) => {\n        this.datasource = ds\n      })\n      const { enableMyLocation } = this\n      if (enableMyLocation.amap && enableMyLocation.amap.key) {\n        AMapLoader.load({\n          key: enableMyLocation.amap.key,\n          version: '2.0',\n          plugins: ['AMap.Geolocation']\n        }).then((AMap) => {\n          this.AMap = AMap\n          this.amapGeolocation = new AMap.Geolocation({\n            // 是否使用高精度定位，默认：true\n            enableHighAccuracy: true,\n            convert: false,\n            // 设置定位超时时间，默认：无穷大\n            timeout: 20000\n          })\n        }).catch(e => {\n          console.error('[C_PKG_FULLNAME] ERROR: ' + e)\n        })\n      }\n    })\n  },\n  destroyed () {\n    this.viewer.dataSources.remove(this.datasource, true)\n    if (this.amapGeolocation) {\n      const scripts = document.getElementsByTagName('script')\n      const removeScripts = []\n      for (const script of scripts) {\n        if (script.src.indexOf('/webapi.amap.com/maps') > -1) {\n          removeScripts.push(script)\n        }\n      }\n      removeScripts.forEach((script) => {\n        document.getElementsByTagName('body')[0].removeChild(script)\n      })\n    }\n  },\n  methods: {\n    handleCick () {\n      const { enableMyLocation, getLocation } = this\n      if (enableMyLocation.amap && enableMyLocation.amap.key) {\n        this.amapGeolocation.getCurrentPosition((status, result) => {\n          if (status === 'complete') {\n            this.$emit('geolocation', result)\n            this.zoomToMyLocation({\n              lng: result.position.lng,\n              lat: result.position.lat\n            })\n          } else {\n            console.error('[C_PKG_FULLNAME] ERROR: ' + result.message)\n          }\n        })\n      } else {\n        getLocation()\n      }\n    },\n    getLocation () {\n      if (navigator.geolocation) {\n        const options = {\n          enableHighAccuracy: true,\n          timeout: 5000,\n          maximumAge: 0\n        }\n        navigator.geolocation.getCurrentPosition((position) => {\n          this.$emit('geolocation', position)\n          this.zoomToMyLocation({\n            lng: position.coords.longitude,\n            lat: position.coords.latitude\n          })\n        }, this.handleLocationError, options)\n      } else {\n        console.error('[C_PKG_FULLNAME] ERROR: ' + 'Your browser cannot provide your location.')\n      }\n    },\n    // This next function modelled on Cesium.geoJsonDataSource's defaultDescribe.\n    describeWithoutUnderscores (properties, nameProperty) {\n      let html = ''\n      if (properties instanceof Cesium.PropertyBag) {\n        // unwrap the properties from the PropertyBag\n        properties = properties.getValue(Cesium.JulianDate.now())\n      }\n      for (let key in properties) {\n        if (Object.prototype.hasOwnProperty.call(properties, key)) {\n          if (key === nameProperty) {\n            continue\n          }\n          let value = properties[key]\n          if (typeof value === 'object') {\n            value = this.describeWithoutUnderscores(value)\n          } else {\n            // value = formatPropertyValue(value)\n          }\n          key = key.replace(/_/g, ' ')\n          if (Cesium.defined(value)) {\n            html += '<tr><th>' + key + '</th><td>' + value + '</td></tr>'\n          }\n        }\n      }\n      if (html.length > 0) {\n        html = '<table class=\"cesium-infoBox-defaultTable\"><tbody>' + html + '</tbody></table>'\n      }\n      return html\n    },\n    zoomToMyLocation (position) {\n      const longitude = position.lng\n      const latitude = position.lat\n      const { Cartesian3, Rectangle, sampleTerrain, defined, SceneMode } = Cesium\n      const { datasource, describeWithoutUnderscores } = this\n\n      datasource.entities.removeAll()\n      const myPositionEntity = datasource.entities.add({\n        id: 'My Location',\n        position: Cartesian3.fromDegrees(longitude, latitude),\n        point: {\n          color: Cesium.Color.fromCssColorString('#08ABD5'),\n          pixelSize: 25 / 2,\n          outlineWidth: 3,\n          outlineColor: Cesium.Color.fromCssColorString('#ffffff')\n        },\n        description: describeWithoutUnderscores({\n          longitude: longitude,\n          latitude: latitude\n        })\n      })\n\n      const options = {\n        duration: this.duration\n      }\n\n      defined(this.enableMyLocation.maximumHeight) && (options.maximumHeight = this.enableMyLocation.maximumHeight)\n      defined(this.enableMyLocation.hpr) && Array.isArray(this.enableMyLocation.hpr) &&\n        (options.offset = new Cesium.HeadingPitchRange(this.enableMyLocation.hpr[0], this.enableMyLocation.hpr[1], this.enableMyLocation.hpr[2]))\n\n      if (this.viewer.scene.mode === SceneMode.SCENE2D || this.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n        return this.viewer.flyTo(myPositionEntity, options)\n      }\n\n      // west, south, east, north, result\n      const rectangle = Rectangle.fromDegrees(longitude - 0.01, latitude - 0.01, longitude + 0.01, latitude + 0.01)\n      const camera = this.viewer.scene.camera\n      // Work out the destination that the camera would naturally fly to\n      const destinationCartesian = camera.getRectangleCameraCoordinates(rectangle)\n      const destination = this.viewer.scene.globe.ellipsoid.cartesianToCartographic(destinationCartesian)\n      const terrainProvider = this.viewer.scene.globe.terrainProvider\n      const level = 6 // A sufficiently coarse tile level that still has approximately accurate height\n      const positions = [Rectangle.center(rectangle)]\n\n      // Perform an elevation query at the centre of the rectangle\n      return sampleTerrain(terrainProvider, level, positions).then(function (results) {\n        // Add terrain elevation to camera altitude\n        const finalDestinationCartographic = {\n          longitude: destination.longitude,\n          latitude: destination.latitude,\n          height: destination.height + results[0].height\n        }\n        const finalDestination = this.viewer.scene.globe.ellipsoid.cartographicToCartesian(finalDestinationCartographic)\n\n        camera.flyTo({\n          duration: 3,\n          destination: finalDestination\n        })\n      })\n    },\n    handleLocationError (err) {\n      console.error('[C_PKG_FULLNAME] ERROR: ' + err.message)\n    }\n  }\n}\n</script>\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport '../../../assets/styles/components/navigation.scss'\nimport cmp from '../../../mixins/virtualCmp'\nimport MouseCoords from '../../../exts/MouseCoords'\nimport VcCompass from './VcCompass.vue'\nimport VcZoomControl from './VcZoomControl.vue'\nimport VcDistanceLegend from './VcDistanceLegend.vue'\nimport VcLocationBar from './VcLocationBar.vue'\nimport VcPrintViewBtn from './VcPrintViewBtn.vue'\nimport VcMyLocation from './VcMyLocation.vue'\n\nexport default {\n  name: 'vc-navigation',\n  components: {\n    VcCompass,\n    VcZoomControl,\n    VcDistanceLegend,\n    VcLocationBar,\n    VcPrintViewBtn,\n    VcMyLocation\n  },\n  mixins: [cmp],\n  props: {\n    options: Object\n  },\n  data () {\n    return {\n      defaultOptions: {\n        enableCompass: true,\n        enableCompassOuterRing: true,\n        enableZoomControl: {\n          zoomAmount: 2,\n          defaultResetView: {\n            lng: 105, lat: 29.999999999999993, height: 19059568.497290563\n          },\n          overrideCamera: false\n        },\n        enableDistanceLegend: true,\n        enableLocationBar: {\n          gridFileUrl: 'https://zouyaoji.top/vue-cesium/statics/SampleData/WW15MGH.DAC',\n          proj4Projection: '+proj=utm +ellps=GRS80 +units=m +no_defs',\n          proj4longlat: '+proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees +no_defs',\n          projectionUnits: 'm'\n        },\n        enablePrintView: {\n          showCredit: true,\n          printAutomatically: false\n        },\n        enableMyLocation: {\n          amap: {\n            key: undefined\n          },\n          maximumHeight: undefined,\n          hpr: [0, 0, 3000]\n        }\n      },\n      ldBottom: 2,\n      ldRight: 3,\n      mouseCoords: undefined,\n      canRender: false\n    }\n  },\n  computed: {\n    ldStyle: function () {\n      return {\n        bottom: this.ldBottom + 'px',\n        right: this.ldRight + 'px'\n      }\n    }\n  },\n  watch: {\n    options: {\n      handler () {\n        this.reload().then(() => {\n          this.viewer.widgetResized.raiseEvent()\n        })\n      },\n      deep: true\n    }\n  },\n  methods: {\n    async createCesiumObject () {\n      this.viewer.afterViewerChanged = new Cesium.Event()\n      this.viewer.beforeViewerChanged = new Cesium.Event()\n      this.viewer.widgetResized.addEventListener(this.widgetResized)\n      Object.assign(this.defaultOptions, this.options)\n      this.widgetResized()\n      this.mouseCoords = new MouseCoords({\n        gridFileUrl: this.defaultOptions.enableLocationBar.gridFileUrl,\n        proj4Projection: this.defaultOptions.enableLocationBar.proj4Projection,\n        proj4longlat: this.defaultOptions.enableLocationBar.proj4longlat,\n        projectionUnits: this.defaultOptions.enableLocationBar.projectionUnits\n      })\n      // 避免控件先按默认的参数创建 然后又隐藏 导致视觉上的体验不优雅\n      this.canRender = true\n      this.$nextTick(() => {\n        const viewerContainer = this.viewer._element\n        viewerContainer.appendChild(this.$el)\n        this.viewer.VcNavigationContaner = this.$refs.navigationContainer\n      })\n\n      return this.$el\n    },\n    widgetResized () {\n      this.ldBottom = this.viewer.timeline ? this.viewer.timeline.container.getBoundingClientRect().height + 2 : 2\n      if (this.ldBottom === 2) {\n        let ldRight = 3\n        this.viewer.fullscreenButton && (ldRight += this.viewer.fullscreenButton.container.getBoundingClientRect().width)\n        this.viewer.vrButton && (ldRight += this.viewer.vrButton.container.getBoundingClientRect().width)\n        this.ldRight = ldRight\n      }\n    },\n    async mount () {\n      return true\n    },\n    async unmount () {\n      this.viewer.widgetResized.removeEventListener(this.widgetResized)\n      return true\n    },\n    legendChanged (e) {\n      const listener = this.$listeners.legendChanged\n      listener && this.$emit('legendChanged', e)\n    },\n    geolocation (e) {\n      const listener = this.$listeners.geolocation\n      listener && this.$emit('geolocation', e)\n    }\n  },\n  stubVNode: {\n    empty () {\n      return this.$options.name\n    }\n  },\n  created () {\n    Object.defineProperties(this, {\n      cesiumNavigation: {\n        enumerable: true,\n        get: () => this.cesiumObject\n      }\n    })\n  }\n}\n","<template>\n  <div class=\"vc-navigationContainer\" ref=\"navigationContainer\" v-if=\"canRender\">\n    <div class=\"vc-navigation\">\n      <div class=\"vc-navigation-navs\">\n        <div class=\"vc-navigation-control\" v-if=\"defaultOptions.enableCompass\">\n          <vc-compass :enableCompassOuterRing=\"defaultOptions.enableCompassOuterRing\" ref=\"VcCompass\"></vc-compass>\n        </div>\n        <div class=\"vc-navigation-control\" v-if=\"defaultOptions.enableZoomControl\">\n          <vc-zoom-control\n            :defaultResetView=\"defaultOptions.enableZoomControl.defaultResetView\"\n            :overrideCamera=\"defaultOptions.enableZoomControl.overrideCamera || false\"\n            :zoomAmount=\"defaultOptions.enableZoomControl.zoomAmount || 2\"\n            ref=\"VcZoomControl\"\n          ></vc-zoom-control>\n        </div>\n      </div>\n      <div class=\"vc-navigation-controls\">\n        <div class=\"vc-navigation-control\" v-if=\"defaultOptions.enablePrintView\">\n          <vc-print-view-btn\n            :printAutomatically=\"defaultOptions.enablePrintView.printAutomatically\"\n            :showCredit=\"defaultOptions.enablePrintView.showCredit\"\n            ref=\"VcPrintViewBtn\"\n          ></vc-print-view-btn>\n        </div>\n        <div class=\"vc-navigation-control\" v-if=\"defaultOptions.enableMyLocation\">\n          <vc-my-location :enableMyLocation=\"defaultOptions.enableMyLocation\" @geolocation=\"geolocation\"></vc-my-location>\n        </div>\n      </div>\n    </div>\n    <div :style=\"ldStyle\" class=\"vc-location-distance\">\n      <vc-location-bar\n        :mouseCoords=\"mouseCoords\"\n        ref=\"VcLocationBar\"\n        v-if=\"mouseCoords !== undefined && defaultOptions.enableLocationBar\"\n      ></vc-location-bar>\n      <vc-distance-legend @legendChanged=\"legendChanged\" ref=\"VcDistanceLengend\" v-if=\"defaultOptions.enableDistanceLegend\"></vc-distance-legend>\n    </div>\n  </div>\n</template>\n\n<script>\nimport '../../../assets/styles/components/navigation.scss'\nimport cmp from '../../../mixins/virtualCmp'\nimport MouseCoords from '../../../exts/MouseCoords'\nimport VcCompass from './VcCompass.vue'\nimport VcZoomControl from './VcZoomControl.vue'\nimport VcDistanceLegend from './VcDistanceLegend.vue'\nimport VcLocationBar from './VcLocationBar.vue'\nimport VcPrintViewBtn from './VcPrintViewBtn.vue'\nimport VcMyLocation from './VcMyLocation.vue'\n\nexport default {\n  name: 'vc-navigation',\n  components: {\n    VcCompass,\n    VcZoomControl,\n    VcDistanceLegend,\n    VcLocationBar,\n    VcPrintViewBtn,\n    VcMyLocation\n  },\n  mixins: [cmp],\n  props: {\n    options: Object\n  },\n  data () {\n    return {\n      defaultOptions: {\n        enableCompass: true,\n        enableCompassOuterRing: true,\n        enableZoomControl: {\n          zoomAmount: 2,\n          defaultResetView: {\n            lng: 105, lat: 29.999999999999993, height: 19059568.497290563\n          },\n          overrideCamera: false\n        },\n        enableDistanceLegend: true,\n        enableLocationBar: {\n          gridFileUrl: 'https://zouyaoji.top/vue-cesium/statics/SampleData/WW15MGH.DAC',\n          proj4Projection: '+proj=utm +ellps=GRS80 +units=m +no_defs',\n          proj4longlat: '+proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees +no_defs',\n          projectionUnits: 'm'\n        },\n        enablePrintView: {\n          showCredit: true,\n          printAutomatically: false\n        },\n        enableMyLocation: {\n          amap: {\n            key: undefined\n          },\n          maximumHeight: undefined,\n          hpr: [0, 0, 3000]\n        }\n      },\n      ldBottom: 2,\n      ldRight: 3,\n      mouseCoords: undefined,\n      canRender: false\n    }\n  },\n  computed: {\n    ldStyle: function () {\n      return {\n        bottom: this.ldBottom + 'px',\n        right: this.ldRight + 'px'\n      }\n    }\n  },\n  watch: {\n    options: {\n      handler () {\n        this.reload().then(() => {\n          this.viewer.widgetResized.raiseEvent()\n        })\n      },\n      deep: true\n    }\n  },\n  methods: {\n    async createCesiumObject () {\n      this.viewer.afterViewerChanged = new Cesium.Event()\n      this.viewer.beforeViewerChanged = new Cesium.Event()\n      this.viewer.widgetResized.addEventListener(this.widgetResized)\n      Object.assign(this.defaultOptions, this.options)\n      this.widgetResized()\n      this.mouseCoords = new MouseCoords({\n        gridFileUrl: this.defaultOptions.enableLocationBar.gridFileUrl,\n        proj4Projection: this.defaultOptions.enableLocationBar.proj4Projection,\n        proj4longlat: this.defaultOptions.enableLocationBar.proj4longlat,\n        projectionUnits: this.defaultOptions.enableLocationBar.projectionUnits\n      })\n      // 避免控件先按默认的参数创建 然后又隐藏 导致视觉上的体验不优雅\n      this.canRender = true\n      this.$nextTick(() => {\n        const viewerContainer = this.viewer._element\n        viewerContainer.appendChild(this.$el)\n        this.viewer.VcNavigationContaner = this.$refs.navigationContainer\n      })\n\n      return this.$el\n    },\n    widgetResized () {\n      this.ldBottom = this.viewer.timeline ? this.viewer.timeline.container.getBoundingClientRect().height + 2 : 2\n      if (this.ldBottom === 2) {\n        let ldRight = 3\n        this.viewer.fullscreenButton && (ldRight += this.viewer.fullscreenButton.container.getBoundingClientRect().width)\n        this.viewer.vrButton && (ldRight += this.viewer.vrButton.container.getBoundingClientRect().width)\n        this.ldRight = ldRight\n      }\n    },\n    async mount () {\n      return true\n    },\n    async unmount () {\n      this.viewer.widgetResized.removeEventListener(this.widgetResized)\n      return true\n    },\n    legendChanged (e) {\n      const listener = this.$listeners.legendChanged\n      listener && this.$emit('legendChanged', e)\n    },\n    geolocation (e) {\n      const listener = this.$listeners.geolocation\n      listener && this.$emit('geolocation', e)\n    }\n  },\n  stubVNode: {\n    empty () {\n      return this.$options.name\n    }\n  },\n  created () {\n    Object.defineProperties(this, {\n      cesiumNavigation: {\n        enumerable: true,\n        get: () => this.cesiumObject\n      }\n    })\n  }\n}\n</script>\n","import VcNavigation from './VcNavigation.vue'\n\nfunction plugin (Vue, options = {}) {\n  if (plugin.installed) {\n    return\n  }\n  plugin.installed = true\n\n  Vue.component(VcNavigation.name, VcNavigation)\n}\n\nexport default plugin\n\nexport {\n  VcNavigation,\n  plugin as install\n}\n"],"names":["icons","notLoadedIcons","defaultWidth","defaultHeight","classPrefix","isStroke","isOriginalDefault","name","data","loaded","props","icon","String","width","type","default","height","scale","dir","fill","Boolean","color","original","title","computed","clazz","iconName","iconData","colors","split","path","pathData","setTitle","addOriginalColor","length","addColor","push","component","getValidPathData","box","viewBox","style","digitReg","Number","isNaN","test","created","methods","reg","i","replace","match","indexOf","reverseStyle","styleReg","styleName","slice","p1","p2","p3","p4","onClick","e","$emit","install","Vue","options","tagName","register","filter","v","ix","$set","VcIconSvg","vectorScratch","oldTransformScratch","newTransformScratch","centerScratch","enableCompassOuterRing","heading","orbitCursorAngle","orbitCursorOpacity","components","outerCircleStyle","transform","WebkitTransform","opacity","rotationMarkerStyle","mounted","$parent","createPromise","then","Cesium","viewer","cesiumObject","_unsubscribeFromViewerChange","afterViewerChanged","addEventListener","viewerChange","destroyed","document","removeEventListener","orbitMouseMoveFunction","orbitMouseUpFunction","_unsubscribeFromClockTick","_unsubscribeFromPostRender","handleMouseDown","stopPropagation","preventDefault","SceneMode","scene","mode","MORPHING","Cartesian2","compassElement","currentTarget","compassRectangle","getBoundingClientRect","maxDistance","center","right","left","bottom","top","clickLocation","event","clientX","clientY","changedTouches","vector","subtract","distanceFromCenter","magnitude","distanceFraction","nominalTotalRadius","norminalGyroRadius","orbit","rotate","handleDoubleClick","Cartesian3","defined","Matrix4","Ray","Transforms","camera","sscc","screenSpaceCameraController","enableInputs","COLUMBUS_VIEW","enableTranslate","SCENE3D","enableLook","enableRotate","windowPosition","x","canvas","clientWidth","y","clientHeight","pickRayScratch","ray","getPickRay","globe","pick","flyHome","rotateFrame","eastNorthUpToFixedFrame","ellipsoid","lookVector","position","flight","CameraFlightPath","createTween","destination","multiplyByPoint","direction","multiplyByPointAsVector","up","duration","tweens","add","resetRotater","viewModel","undefined","postRender","showCompass","cursorVector","getTimestamp","CesiumMath","Math","enableTilt","SCENE2D","orbitTickFunction","clock","onTick","isOrbiting","orbitLastTimestamp","orbitFrame","positionWC","orbitIsLook","timestamp","deltaT","rate","distance","angle","PI_OVER_TWO","cos","sin","oldTransform","clone","lookAtTransform","look","UNIT_Z","rotateLeft","rotateUp","updateAngleAndOpacity","compassWidth","atan2","zeroToTwoPi","min","easedOpacity","rotateMouseMoveFunction","rotateMouseUpFunction","isRotating","rotateInitialCursorAngle","viewCenter","rotateIsLook","rotateInitialCameraAngle","rotateInitialCameraDistance","angleDifference","newCameraAngle","currentCameraAngle","rotateRight","increase","decrease","refresh","defaultResetView","Object","zoomAmount","overrideCamera","resetView","lng","setView","fromDegrees","lat","orientation","toRadians","pitch","roll","west","rectangle","Rectangle","south","east","north","validate","console","error","zoomIn","zoom","zoomOut","relativeAmount","IntersectionTests","enableZoom","positionCartographic","focus","trackedEntity","getCameraFocus","worldToCameraCoordinatesPoint","cartographicToCartesian","directionWC","grazingAltitudeLocation","cartesian3Scratch","movementVector","multiplyByScalar","endPosition","flyTo","convert","zoomReset","intersections","rayEllipsoid","getPoint","start","barWidth","distanceLabel","barStyle","viewerSubscriptions","removeUpdateSubscription","_lastLegendUpdate","beforeViewerChanged","addUpdateSubscription","updateDistanceLegendCesium","now","geodesic","EllipsoidGeodesic","leftPosition","rightPosition","leftCartographic","cartesianToCartographic","rightCartographic","setEndPoints","pixelDistance","surfaceDistance","maxBarWidth","distances","label","toString","cameraHeight","showUtmZone","mouseCoords","lastMouseX","lastMouseY","_element","onMouseMove","toFixed","changed","extend","toggleUseProjection","rect","updateCoordinatesFromCesium","scratchArray","scratchSphereIntersectionResult","stop","scratchV0","scratchV1","scratchV2","scratchResult","Globe","GlobeSurfaceTile","BoundingSphere","defaultValue","DeveloperError","prototype","pickTriangle","cullBackFaces","result","projection","mapProjection","sphereIntersections","tilesToRender","_surface","_tilesToRender","tile","surfaceTile","boundingVolume","pickBoundingSphere","fromRectangleWithHeights2D","minimumHeight","maximumHeight","fromElements","z","boundingSphere3D","boundingSphereIntersection","raySphere","sort","createComparePickTileFunction","origin","intersection","mesh","renderedMesh","vertices","indices","encoding","i0","i1","i2","v0","getPosition","v1","v2","rayTriangle","rayOrigin","a","b","aDist","distanceSquaredTo","bDist","index","decodePosition","positionCart","project","share","mapImageDataUrl","ready","credits","captureScreenshot","printWindow","mainWindow","window","printWindowIntervalId","setInterval","checkForImagesReady","mainWindowIntervalId","_stopCheckingForImages","clearInterval","getAllAttribution","imageTags","getElementsByTagName","allImagesReady","complete","stopCheckingForImages","printAutomatically","showCredit","handleCick","createPrintView","creatingPrintView","iframe","createElement","body","appendChild","newWindow","createWindow","contentWindow","closeCallback","windowToPrint","render","h","VcPrintView","on","printViewReady","$mount","getElementById","otherwise","always","removeChild","printViewClosed","open","close","head","innerHTML","geolocation","enableMyLocation","dataSources","CustomDataSource","ds","datasource","amap","key","AMapLoader","load","version","plugins","AMap","amapGeolocation","Geolocation","enableHighAccuracy","timeout","catch","remove","scripts","removeScripts","script","src","forEach","getLocation","getCurrentPosition","status","zoomToMyLocation","message","navigator","maximumAge","coords","longitude","latitude","handleLocationError","describeWithoutUnderscores","properties","nameProperty","html","PropertyBag","getValue","JulianDate","hasOwnProperty","call","value","sampleTerrain","entities","removeAll","myPositionEntity","id","point","Color","fromCssColorString","pixelSize","outlineWidth","outlineColor","description","hpr","Array","isArray","offset","HeadingPitchRange","destinationCartesian","getRectangleCameraCoordinates","terrainProvider","level","positions","results","finalDestinationCartographic","finalDestination","err","VcCompass","VcZoomControl","VcDistanceLegend","VcLocationBar","VcPrintViewBtn","VcMyLocation","mixins","cmp","defaultOptions","enableCompass","enableZoomControl","enableDistanceLegend","enableLocationBar","gridFileUrl","proj4Projection","proj4longlat","projectionUnits","enablePrintView","ldBottom","ldRight","canRender","ldStyle","watch","handler","reload","widgetResized","raiseEvent","deep","createCesiumObject","Event","MouseCoords","$nextTick","viewerContainer","$el","VcNavigationContaner","$refs","navigationContainer","timeline","container","fullscreenButton","vrButton","mount","unmount","legendChanged","listener","$listeners","stubVNode","empty","$options","defineProperties","cesiumNavigation","enumerable","get","plugin","installed","VcNavigation"],"mappings":"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"}