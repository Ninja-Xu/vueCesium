{"version":3,"file":"index.js","sources":["src/components/control/navigationSM/VcCompassSM.vue?rollup-plugin-vue=script.js","src/components/control/navigationSM/VcCompassSM.vue","src/components/control/navigationSM/VcZoomControlSM.vue?rollup-plugin-vue=script.js","src/components/control/navigationSM/VcZoomControlSM.vue","src/components/control/navigationSM/VcNavigationSM.vue?rollup-plugin-vue=script.js","src/components/control/navigationSM/VcNavigationSM.vue","src/components/control/navigationSM/index.js"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport CameraFlightPath from '../../../exts/CameraFlightPath'\nimport { Platform } from '../../../utils/util'\nexport default {\n  name: 'vc-compass-sm',\n  props: {\n    enableCompassOuterRing: Boolean\n  },\n  data () {\n    return {\n      tiltbarLeft: 56,\n      tiltbarTop: 3,\n      heading: 0\n    }\n  },\n  computed: {\n    tiltbarStyle: function () {\n      return {\n        left: this.tiltbarLeft + 'px',\n        top: this.tiltbarTop + 'px'\n      }\n    },\n    outerRingStyle: function () {\n      return {\n        transform: 'rotate(-' + this.heading + 'rad)',\n        '-webkit-transform': 'rotate(-' + this.heading + 'rad)'\n      }\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.heading = viewer.scene.camera.heading\n      this.screenSpaceEventHandler = new Cesium.ScreenSpaceEventHandler(this.$parent.$refs.navigationContainer)\n      this.isRotating = false\n      this.rotateInitialCursorAngle = undefined\n      this.rotateFrame = undefined\n      this.rotateMouseMoveFunction = undefined\n      this.rotateMouseUpFunction = undefined\n      this._unsubcribeFromPostRender = undefined\n      this.isTilting = false\n      this.tiltInitialCursorAngle = 0\n      getTiltbarPosition.call(this)\n      viewerChange(this)\n      if (!Platform().isPc) {\n        document.querySelector('.vc-compass-tiltbar-sm').style.visibility = 'visible'\n        document.querySelector('.vc-compass-arrows-sm').style.visibility = 'visible'\n        document.querySelector('.vc-compass-tilt-sm').style.visibility = 'visible'\n      }\n    })\n  },\n  methods: {\n    handleMouseDown (event) {\n      const { Cartesian2, Math: CesiumMath, SceneMode } = Cesium\n      const scene = this.viewer.scene\n      if (scene.mode === SceneMode.MORPHING) {\n        return true\n      }\n      const compassElement = event.currentTarget\n      const compassRectangle = event.currentTarget.getBoundingClientRect()\n      const center = new Cartesian2(\n        (compassRectangle.right - compassRectangle.left) / 2.0,\n        (compassRectangle.bottom - compassRectangle.top) / 2.0\n      )\n      const clickLocation =\n        event.type === 'mousedown'\n          ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n          : new Cartesian2(\n            event.changedTouches[0].clientX - compassRectangle.left,\n            event.changedTouches[0].clientY - compassRectangle.top\n          )\n      const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n      this.clickStartPosition = new Cartesian2(event.clientX, event.clientY)\n      const distanceFromCenter = Cartesian2.magnitude(vector)\n\n      if (distanceFromCenter > 30 && distanceFromCenter < 45) {\n        rotate(this, compassElement, vector)\n      } else if (!(distanceFromCenter > 50 && distanceFromCenter < 70)) {\n        rotateEast(this, compassElement, vector)\n      } else {\n        const angle = CesiumMath.PI_OVER_TWO - Math.atan2(-vector.y, vector.x)\n        angle >= 0 && angle <= CesiumMath.PI_OVER_TWO && tilt(this, compassElement, vector)\n      }\n    },\n    handleDoubleClick (e) {\n      const { Cartesian2, Cartesian3, defined, Matrix4, Ray, SceneMode, Transforms } = Cesium\n      const scene = this.viewer.scene\n      const camera = scene.camera\n\n      if (scene.mode === SceneMode.MORPHING) {\n        return true\n      }\n      const compassRectangle = e.currentTarget.getBoundingClientRect()\n      const center = new Cartesian2(\n        (compassRectangle.right - compassRectangle.left) / 2.0,\n        (compassRectangle.bottom - compassRectangle.top) / 2.0\n      )\n      const clickLocation =\n        e.type === 'dblclick'\n          ? new Cartesian2(e.clientX - compassRectangle.left, e.clientY - compassRectangle.top)\n          : new Cartesian2(\n            e.changedTouches[0].clientX - compassRectangle.left,\n            e.changedTouches[0].clientY - compassRectangle.top\n          )\n      const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n      this.clickStartPosition = new Cartesian2(e.clientX, e.clientY)\n      const distanceFromCenter = Cartesian2.magnitude(vector)\n\n      if (distanceFromCenter > 30 && distanceFromCenter < 45) {\n        const windowPosition = new Cartesian2()\n        windowPosition.x = scene.canvas.clientWidth / 2\n        windowPosition.y = scene.canvas.clientHeight / 2\n        const pickRayScratch = new Ray()\n        const ray = camera.getPickRay(windowPosition, pickRayScratch)\n\n        const center = scene.globe.pick(ray, scene, centerScratch)\n        if (!defined(center)) {\n          // Globe is barely visible, so reset to home view.\n          return\n        }\n\n        const rotateFrame = Transforms.eastNorthUpToFixedFrame(\n          center,\n          this.viewer.scene.globe.ellipsoid\n        )\n\n        const lookVector = Cartesian3.subtract(\n          center,\n          camera.position,\n          new Cartesian3()\n        )\n\n        const flight = CameraFlightPath.createTween(scene, {\n          destination: Matrix4.multiplyByPoint(\n            rotateFrame,\n            new Cartesian3(0.0, 0.0, Cartesian3.magnitude(lookVector)),\n            new Cartesian3()\n          ),\n          direction: Matrix4.multiplyByPointAsVector(\n            rotateFrame,\n            new Cartesian3(0.0, 0.0, -1.0),\n            new Cartesian3()\n          ),\n          up: Matrix4.multiplyByPointAsVector(\n            rotateFrame,\n            new Cartesian3(0.0, 1.0, 0.0),\n            new Cartesian3()\n          ),\n          duration: 1.5\n        })\n        scene.tweens.add(flight)\n      }\n    },\n    handleMouseUp (event) {\n      const { Cartesian2, Math: CesiumMath } = Cesium\n      const compassRectangle = event.currentTarget.getBoundingClientRect()\n      const center = new Cartesian2(\n        (compassRectangle.right - compassRectangle.left) / 2.0,\n        (compassRectangle.bottom - compassRectangle.top) / 2.0\n      )\n      const clickLocation =\n        event.type === 'mouseup'\n          ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n          : new Cartesian2(\n            event.changedTouches[0].clientX - compassRectangle.left,\n            event.changedTouches[0].clientY - compassRectangle.top\n          )\n      const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n      const magnitude = Cartesian2.magnitude(vector)\n      if (magnitude > 30 && magnitude < 45) {\n        const angle = CesiumMath.toDegrees(Math.atan2(-vector.y, vector.x))\n        const clickStartPosition = new Cartesian2(event.clientX, event.clientY)\n        const dX = clickStartPosition.x - this.clickStartPosition.x\n        const dY = clickStartPosition.y - this.clickStartPosition.y\n        const distance = Math.sqrt(dX * dX + dY * dY)\n        if (distance > 5) {\n          return\n        }\n        const heading = CesiumMath.toDegrees(this.heading)\n        const m = Math.abs(angle - heading)\n        const scene = this.viewer.scene\n        if ((angle > 0 && heading > 0 && heading < 90 && m > 80 && m < 100) || (m > 260 && m < 280)) {\n          scene.camera.flyTo({\n            destination: scene.camera.position,\n            orientation: {\n              heading: 0,\n              pitch: scene.camera.pitch\n            }\n          })\n        }\n      }\n    }\n  },\n  destroyed () {\n    this.screenSpaceEventHandler && this.screenSpaceEventHandler.destroy()\n  }\n}\nconst vectorScratch = {}\nconst oldTransformScratch = {}\nconst newTransformScratch = {}\nconst centerScratch = {}\n\nconst positions = [\n  {\n    x: 56,\n    y: 3\n  },\n  {\n    x: 59,\n    y: 4\n  },\n  {\n    x: 64,\n    y: 5\n  },\n  {\n    x: 69,\n    y: 6\n  },\n  {\n    x: 74,\n    y: 7\n  },\n  {\n    x: 79,\n    y: 9\n  },\n  {\n    x: 84,\n    y: 12\n  },\n  {\n    x: 89,\n    y: 15\n  },\n  {\n    x: 92,\n    y: 19\n  },\n  {\n    x: 94,\n    y: 20\n  },\n  {\n    x: 99,\n    y: 25\n  },\n  {\n    x: 104,\n    y: 34\n  },\n  {\n    x: 106,\n    y: 40\n  },\n  {\n    x: 107,\n    y: 44\n  },\n  {\n    x: 107,\n    y: 46\n  },\n  {\n    x: 107,\n    y: 48\n  },\n  {\n    x: 107,\n    y: 50\n  },\n  {\n    x: 107,\n    y: 52\n  },\n  {\n    x: 107,\n    y: 54\n  },\n  {\n    x: 107,\n    y: 56\n  }\n]\n\nfunction rotate (viewModel, compassElement, cursorVector) {\n  if (!viewModel.enableCompassOuterRing) {\n    return\n  }\n\n  const { Cartesian2, Cartesian3, defined, Math: CesiumMath, Matrix4, Ray, Transforms } = Cesium\n  // Remove existing event handlers, if any.\n  document.removeEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n  document.removeEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n  document.removeEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n  document.removeEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n  viewModel.rotateMouseMoveFunction = undefined\n  viewModel.rotateMouseUpFunction = undefined\n  viewModel.isRotating = true\n  viewModel.rotateInitialCursorAngle = Math.atan2(-cursorVector.y, cursorVector.x)\n  const scene = viewModel.viewer.scene\n  let camera = scene.camera\n  const windowPosition = new Cartesian2()\n  windowPosition.x = scene.canvas.clientWidth / 2\n  windowPosition.y = scene.canvas.clientHeight / 2\n  const pickRayScratch = new Ray()\n  const ray = camera.getPickRay(windowPosition, pickRayScratch)\n  const viewCenter = scene.globe.pick(ray, scene, centerScratch)\n\n  if (!defined(viewCenter)) {\n    viewModel.rotateFrame = Transforms.eastNorthUpToFixedFrame(camera.positionWC, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.rotateIsLook = true\n  } else {\n    viewModel.rotateFrame = Transforms.eastNorthUpToFixedFrame(viewCenter, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.rotateIsLook = false\n  }\n\n  let oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n  camera.lookAtTransform(viewModel.rotateFrame)\n  viewModel.rotateInitialCameraAngle = Math.atan2(camera.position.y, camera.position.x)\n  viewModel.rotateInitialCameraDistance = Cartesian3.magnitude(new Cartesian3(camera.position.x, camera.position.y, 0.0))\n  camera.lookAtTransform(oldTransform)\n  viewModel.rotateMouseMoveFunction = (event) => {\n    const compassRectangle = compassElement.getBoundingClientRect()\n    const center = new Cartesian2(\n      (compassRectangle.right - compassRectangle.left) / 2.0,\n      (compassRectangle.bottom - compassRectangle.top) / 2.0\n    )\n    const clickLocation =\n      event.type === 'mousedown' || event.type === 'mousemove'\n        ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n        : new Cartesian2(\n          event.changedTouches[0].clientX - compassRectangle.left,\n          event.changedTouches[0].clientY - compassRectangle.top\n        )\n    const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n    const angle = Math.atan2(-vector.y, vector.x)\n    const angleDifference = angle - viewModel.rotateInitialCursorAngle\n    const newCameraAngle = CesiumMath.zeroToTwoPi(viewModel.rotateInitialCameraAngle - angleDifference)\n    camera = viewModel.viewer.scene.camera\n\n    oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n    camera.lookAtTransform(viewModel.rotateFrame)\n    const currentCameraAngle = Math.atan2(camera.position.y, camera.position.x)\n    camera.rotateRight(newCameraAngle - currentCameraAngle)\n    camera.lookAtTransform(oldTransform)\n  }\n\n  viewModel.rotateMouseUpFunction = () => {\n    viewModel.isRotating = false\n    document.removeEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n    document.removeEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n    document.removeEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n    document.removeEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n\n    viewModel.rotateMouseMoveFunction = undefined\n    viewModel.rotateMouseUpFunction = undefined\n  }\n\n  document.addEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n  document.addEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n  document.addEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n  document.addEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n}\n\nfunction rotateEast (viewModel, compassElement, cursorVector) {\n  const { defined, getTimestamp, Math: CesiumMath, ScreenSpaceEventType } = Cesium\n  viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n  defined(viewModel.rotateEastTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.rotateEastTickFunction)\n  viewModel.rotateEastMouseUpFunction = undefined\n  viewModel.rotateEastTickFunction = undefined\n  viewModel.isrotateEasting = true\n  viewModel.rotateEastLastTimestamp = getTimestamp()\n  let angle = CesiumMath.PI_OVER_TWO - Math.atan2(-cursorVector.y, cursorVector.x)\n  const a = Math.PI / 4\n  let roateDirection = 0\n  const roateType = {\n    LEFT: 1,\n    RIGHT: 2,\n    UP: 3,\n    DOWN: 4\n  }\n  roateDirection = angle >= -a && a >= angle\n    ? roateType.DOWN\n    : angle >= a && 3 * a >= angle\n      ? roateType.RIGHT\n      : angle >= 3 * a && 5 * a >= angle ? roateType.UP : roateType.LEFT\n  viewModel.rotateEastTickFunction = () => {\n    const scene = viewModel.viewer.scene\n    const camera = scene.camera\n    const timestamp = getTimestamp()\n    angle = 20 * Math.abs(camera.positionCartographic.height / 6378317) * 0.0005\n    switch (roateDirection) {\n      case roateType.LEFT:\n        camera.rotateLeft(angle)\n        break\n      case roateType.RIGHT:\n        camera.rotateRight(angle)\n        break\n      case roateType.UP:\n        camera.rotate(camera.right, -angle)\n        break\n      case roateType.DOWN:\n        camera.rotate(camera.right, angle)\n    }\n    viewModel.rotateEastLastTimestamp = timestamp\n  }\n  viewModel.rotateEastMouseUpFunction = () => {\n    viewModel.isRotateEasting = false\n    viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n    defined(viewModel.rotateEastTickFunction) &&\n      viewModel.viewer.clock.onTick.removeEventListener(viewModel.rotateEastTickFunction)\n    viewModel.rotateEastMouseUpFunction = undefined\n    viewModel.rotateEastTickFunction = undefined\n  }\n\n  viewModel.screenSpaceEventHandler.setInputAction(viewModel.rotateEastMouseUpFunction, ScreenSpaceEventType.LEFT_UP)\n  viewModel.viewer.clock.onTick.addEventListener(viewModel.rotateEastTickFunction)\n}\nfunction tilt (viewModel, compassElement, cursorVector) {\n  const { Cartesian2, defined, Math: CesiumMath, Matrix4, ScreenSpaceEventType, Transforms } = Cesium\n  // Remove existing event handlers, if any.\n  viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.MOUSE_MOVE)\n  viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n  viewModel.tiltMouseMoveFunction = undefined\n  viewModel.tiltMouseUpFunction = undefined\n  let tiltInitialCursorAngle = CesiumMath.PI_OVER_TWO - Math.atan2(-cursorVector.y, cursorVector.x)\n  tiltInitialCursorAngle = tiltInitialCursorAngle < 0 ? 0 : tiltInitialCursorAngle\n  tiltInitialCursorAngle = tiltInitialCursorAngle > CesiumMath.PI_OVER_TWO ? CesiumMath.PI_OVER_TWO : tiltInitialCursorAngle\n  viewModel.tiltInitialCursorAngle = tiltInitialCursorAngle\n  viewModel.isTilting = true\n  const scene = viewModel.viewer.scene\n  const camera = scene.camera\n  const windowPosition = new Cartesian2()\n  windowPosition.x = scene.canvas.clientWidth / 2\n  windowPosition.y = scene.canvas.clientHeight / 2\n  let pickPosition = camera.pickEllipsoid(windowPosition, scene.globe.ellipsoid)\n  if (!defined(pickPosition)) {\n    for (; windowPosition.y < scene.canvas.clientHeight;) {\n      windowPosition.y += 5\n      pickPosition = camera.pickEllipsoid(windowPosition, scene.globe.ellipsoid)\n    }\n  }\n\n  defined(pickPosition) && (viewModel.tiltFrame = Transforms.eastNorthUpToFixedFrame(pickPosition, scene.globe.ellipsoid))\n  viewModel.tiltMouseMoveFunction = (e, n) => {\n    viewModel.isTilting = true\n    const compassRectangle = compassElement.getBoundingClientRect()\n    const center = new Cesium.Cartesian2(\n      (compassRectangle.right - compassRectangle.left) / 2.0,\n      (compassRectangle.bottom - compassRectangle.top) / 2.0\n    )\n    const endPosition = Cartesian2.clone(e.endPosition)\n    const vector = Cartesian2.subtract(endPosition, center, vectorScratch)\n    let angle = CesiumMath.PI_OVER_TWO - Math.atan2(-vector.y, vector.x)\n    angle = angle < 0 ? 0 : angle\n    angle = angle > CesiumMath.PI_OVER_TWO ? CesiumMath.PI_OVER_TWO : angle\n    const camera = viewModel.viewer.scene.camera\n    const oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n    camera.lookAtTransform(viewModel.tiltFrame)\n    const rotateUpAngle = angle - viewModel.tiltInitialCursorAngle\n    camera.rotateUp(rotateUpAngle)\n    viewModel.tiltInitialCursorAngle = angle\n    camera.lookAtTransform(oldTransform)\n    let level = Math.ceil(angle / (Math.PI / 40))\n    level = level > 19 ? 19 : level\n    const position = positions[level]\n    viewModel.tiltbarLeft = position.x\n    viewModel.tiltbarTop = position.y\n  }\n\n  viewModel.tiltMouseUpFunction = function (e) {\n    viewModel.isTilting = false\n    viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.MOUSE_MOVE)\n    viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n    viewModel.tiltMouseMoveFunction = undefined\n    viewModel.tiltMouseUpFunction = undefined\n  }\n\n  viewModel.screenSpaceEventHandler.setInputAction(viewModel.tiltMouseMoveFunction, ScreenSpaceEventType.MOUSE_MOVE)\n  viewModel.screenSpaceEventHandler.setInputAction(viewModel.tiltMouseUpFunction, ScreenSpaceEventType.LEFT_UP)\n}\n\nfunction getTiltbarPosition () {\n  const { Math: CesiumMath } = Cesium\n  const pitch = CesiumMath.PI_OVER_TWO + this.viewer.scene.camera.pitch\n  const length = Math.PI / 2 / 20\n  let level = Math.floor(pitch / length)\n  level = level > 19 ? 19 : level\n  level = level < 0 ? 0 : level\n  this.tiltbarLeft = positions[level].x\n  this.tiltbarTop = positions[level].y\n}\n\nfunction viewerChange (viewModel) {\n  const { defined, Math: CesiumMath } = Cesium\n  if (defined(viewModel.viewer)) {\n    if (viewModel._unsubcribeFromPostRender) {\n      viewModel._unsubcribeFromPostRender()\n      viewModel._unsubcribeFromPostRender = undefined\n    }\n    viewModel._unsubcribeFromPostRender = viewModel.viewer.scene.postRender.addEventListener(() => {\n      viewModel.heading = viewModel.viewer.scene.camera.heading\n      if (!viewModel.isTilting) {\n        const angle = viewModel.viewer.scene.camera.pitch + CesiumMath.PI_OVER_TWO\n        const length = CesiumMath.PI_OVER_TWO / 20\n        let level = Math.floor(angle / length)\n        level = level > 19 ? 19 : level\n        level = level < 0 ? 0 : level\n        viewModel.tiltbarLeft = positions[level].x\n        viewModel.tiltbarTop = positions[level].y\n      }\n    })\n  } else {\n    if (viewModel._unsubcribeFromPostRender) {\n      viewModel._unsubcribeFromPostRender()\n      viewModel._unsubcribeFromPostRender = undefined\n    }\n  }\n}\n","<template>\n  <div\n    :title=\"$vc.lang.navigation.compass.description\"\n    @dblclick=\"handleDoubleClick\"\n    @mousedown=\"handleMouseDown\"\n    @mouseup=\"handleMouseUp\"\n    @touchend=\"handleMouseUp\"\n    @touchstart=\"handleMouseDown\"\n    class=\"vc-compass-sm\"\n  >\n    <div class=\"vc-compass-tilt-sm\"></div>\n    <div :style=\"tiltbarStyle\" class=\"vc-compass-tiltbar-sm\"></div>\n    <div class=\"vc-compass-arrows-sm\"></div>\n    <div :style=\"outerRingStyle\" class=\"vc-compass-outer-ring-sm\"></div>\n    <div class=\"vc-arrows-e-sm\"></div>\n    <div class=\"vc-arrows-n-sm\"></div>\n    <div class=\"vc-arrows-s-sm\"></div>\n    <div class=\"vc-arrows-w-sm\"></div>\n  </div>\n</template>\n\n<script>\nimport CameraFlightPath from '../../../exts/CameraFlightPath'\nimport { Platform } from '../../../utils/util'\nexport default {\n  name: 'vc-compass-sm',\n  props: {\n    enableCompassOuterRing: Boolean\n  },\n  data () {\n    return {\n      tiltbarLeft: 56,\n      tiltbarTop: 3,\n      heading: 0\n    }\n  },\n  computed: {\n    tiltbarStyle: function () {\n      return {\n        left: this.tiltbarLeft + 'px',\n        top: this.tiltbarTop + 'px'\n      }\n    },\n    outerRingStyle: function () {\n      return {\n        transform: 'rotate(-' + this.heading + 'rad)',\n        '-webkit-transform': 'rotate(-' + this.heading + 'rad)'\n      }\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.heading = viewer.scene.camera.heading\n      this.screenSpaceEventHandler = new Cesium.ScreenSpaceEventHandler(this.$parent.$refs.navigationContainer)\n      this.isRotating = false\n      this.rotateInitialCursorAngle = undefined\n      this.rotateFrame = undefined\n      this.rotateMouseMoveFunction = undefined\n      this.rotateMouseUpFunction = undefined\n      this._unsubcribeFromPostRender = undefined\n      this.isTilting = false\n      this.tiltInitialCursorAngle = 0\n      getTiltbarPosition.call(this)\n      viewerChange(this)\n      if (!Platform().isPc) {\n        document.querySelector('.vc-compass-tiltbar-sm').style.visibility = 'visible'\n        document.querySelector('.vc-compass-arrows-sm').style.visibility = 'visible'\n        document.querySelector('.vc-compass-tilt-sm').style.visibility = 'visible'\n      }\n    })\n  },\n  methods: {\n    handleMouseDown (event) {\n      const { Cartesian2, Math: CesiumMath, SceneMode } = Cesium\n      const scene = this.viewer.scene\n      if (scene.mode === SceneMode.MORPHING) {\n        return true\n      }\n      const compassElement = event.currentTarget\n      const compassRectangle = event.currentTarget.getBoundingClientRect()\n      const center = new Cartesian2(\n        (compassRectangle.right - compassRectangle.left) / 2.0,\n        (compassRectangle.bottom - compassRectangle.top) / 2.0\n      )\n      const clickLocation =\n        event.type === 'mousedown'\n          ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n          : new Cartesian2(\n            event.changedTouches[0].clientX - compassRectangle.left,\n            event.changedTouches[0].clientY - compassRectangle.top\n          )\n      const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n      this.clickStartPosition = new Cartesian2(event.clientX, event.clientY)\n      const distanceFromCenter = Cartesian2.magnitude(vector)\n\n      if (distanceFromCenter > 30 && distanceFromCenter < 45) {\n        rotate(this, compassElement, vector)\n      } else if (!(distanceFromCenter > 50 && distanceFromCenter < 70)) {\n        rotateEast(this, compassElement, vector)\n      } else {\n        const angle = CesiumMath.PI_OVER_TWO - Math.atan2(-vector.y, vector.x)\n        angle >= 0 && angle <= CesiumMath.PI_OVER_TWO && tilt(this, compassElement, vector)\n      }\n    },\n    handleDoubleClick (e) {\n      const { Cartesian2, Cartesian3, defined, Matrix4, Ray, SceneMode, Transforms } = Cesium\n      const scene = this.viewer.scene\n      const camera = scene.camera\n\n      if (scene.mode === SceneMode.MORPHING) {\n        return true\n      }\n      const compassRectangle = e.currentTarget.getBoundingClientRect()\n      const center = new Cartesian2(\n        (compassRectangle.right - compassRectangle.left) / 2.0,\n        (compassRectangle.bottom - compassRectangle.top) / 2.0\n      )\n      const clickLocation =\n        e.type === 'dblclick'\n          ? new Cartesian2(e.clientX - compassRectangle.left, e.clientY - compassRectangle.top)\n          : new Cartesian2(\n            e.changedTouches[0].clientX - compassRectangle.left,\n            e.changedTouches[0].clientY - compassRectangle.top\n          )\n      const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n      this.clickStartPosition = new Cartesian2(e.clientX, e.clientY)\n      const distanceFromCenter = Cartesian2.magnitude(vector)\n\n      if (distanceFromCenter > 30 && distanceFromCenter < 45) {\n        const windowPosition = new Cartesian2()\n        windowPosition.x = scene.canvas.clientWidth / 2\n        windowPosition.y = scene.canvas.clientHeight / 2\n        const pickRayScratch = new Ray()\n        const ray = camera.getPickRay(windowPosition, pickRayScratch)\n\n        const center = scene.globe.pick(ray, scene, centerScratch)\n        if (!defined(center)) {\n          // Globe is barely visible, so reset to home view.\n          return\n        }\n\n        const rotateFrame = Transforms.eastNorthUpToFixedFrame(\n          center,\n          this.viewer.scene.globe.ellipsoid\n        )\n\n        const lookVector = Cartesian3.subtract(\n          center,\n          camera.position,\n          new Cartesian3()\n        )\n\n        const flight = CameraFlightPath.createTween(scene, {\n          destination: Matrix4.multiplyByPoint(\n            rotateFrame,\n            new Cartesian3(0.0, 0.0, Cartesian3.magnitude(lookVector)),\n            new Cartesian3()\n          ),\n          direction: Matrix4.multiplyByPointAsVector(\n            rotateFrame,\n            new Cartesian3(0.0, 0.0, -1.0),\n            new Cartesian3()\n          ),\n          up: Matrix4.multiplyByPointAsVector(\n            rotateFrame,\n            new Cartesian3(0.0, 1.0, 0.0),\n            new Cartesian3()\n          ),\n          duration: 1.5\n        })\n        scene.tweens.add(flight)\n      }\n    },\n    handleMouseUp (event) {\n      const { Cartesian2, Math: CesiumMath } = Cesium\n      const compassRectangle = event.currentTarget.getBoundingClientRect()\n      const center = new Cartesian2(\n        (compassRectangle.right - compassRectangle.left) / 2.0,\n        (compassRectangle.bottom - compassRectangle.top) / 2.0\n      )\n      const clickLocation =\n        event.type === 'mouseup'\n          ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n          : new Cartesian2(\n            event.changedTouches[0].clientX - compassRectangle.left,\n            event.changedTouches[0].clientY - compassRectangle.top\n          )\n      const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n      const magnitude = Cartesian2.magnitude(vector)\n      if (magnitude > 30 && magnitude < 45) {\n        const angle = CesiumMath.toDegrees(Math.atan2(-vector.y, vector.x))\n        const clickStartPosition = new Cartesian2(event.clientX, event.clientY)\n        const dX = clickStartPosition.x - this.clickStartPosition.x\n        const dY = clickStartPosition.y - this.clickStartPosition.y\n        const distance = Math.sqrt(dX * dX + dY * dY)\n        if (distance > 5) {\n          return\n        }\n        const heading = CesiumMath.toDegrees(this.heading)\n        const m = Math.abs(angle - heading)\n        const scene = this.viewer.scene\n        if ((angle > 0 && heading > 0 && heading < 90 && m > 80 && m < 100) || (m > 260 && m < 280)) {\n          scene.camera.flyTo({\n            destination: scene.camera.position,\n            orientation: {\n              heading: 0,\n              pitch: scene.camera.pitch\n            }\n          })\n        }\n      }\n    }\n  },\n  destroyed () {\n    this.screenSpaceEventHandler && this.screenSpaceEventHandler.destroy()\n  }\n}\nconst vectorScratch = {}\nconst oldTransformScratch = {}\nconst newTransformScratch = {}\nconst centerScratch = {}\n\nconst positions = [\n  {\n    x: 56,\n    y: 3\n  },\n  {\n    x: 59,\n    y: 4\n  },\n  {\n    x: 64,\n    y: 5\n  },\n  {\n    x: 69,\n    y: 6\n  },\n  {\n    x: 74,\n    y: 7\n  },\n  {\n    x: 79,\n    y: 9\n  },\n  {\n    x: 84,\n    y: 12\n  },\n  {\n    x: 89,\n    y: 15\n  },\n  {\n    x: 92,\n    y: 19\n  },\n  {\n    x: 94,\n    y: 20\n  },\n  {\n    x: 99,\n    y: 25\n  },\n  {\n    x: 104,\n    y: 34\n  },\n  {\n    x: 106,\n    y: 40\n  },\n  {\n    x: 107,\n    y: 44\n  },\n  {\n    x: 107,\n    y: 46\n  },\n  {\n    x: 107,\n    y: 48\n  },\n  {\n    x: 107,\n    y: 50\n  },\n  {\n    x: 107,\n    y: 52\n  },\n  {\n    x: 107,\n    y: 54\n  },\n  {\n    x: 107,\n    y: 56\n  }\n]\n\nfunction rotate (viewModel, compassElement, cursorVector) {\n  if (!viewModel.enableCompassOuterRing) {\n    return\n  }\n\n  const { Cartesian2, Cartesian3, defined, Math: CesiumMath, Matrix4, Ray, Transforms } = Cesium\n  // Remove existing event handlers, if any.\n  document.removeEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n  document.removeEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n  document.removeEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n  document.removeEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n  viewModel.rotateMouseMoveFunction = undefined\n  viewModel.rotateMouseUpFunction = undefined\n  viewModel.isRotating = true\n  viewModel.rotateInitialCursorAngle = Math.atan2(-cursorVector.y, cursorVector.x)\n  const scene = viewModel.viewer.scene\n  let camera = scene.camera\n  const windowPosition = new Cartesian2()\n  windowPosition.x = scene.canvas.clientWidth / 2\n  windowPosition.y = scene.canvas.clientHeight / 2\n  const pickRayScratch = new Ray()\n  const ray = camera.getPickRay(windowPosition, pickRayScratch)\n  const viewCenter = scene.globe.pick(ray, scene, centerScratch)\n\n  if (!defined(viewCenter)) {\n    viewModel.rotateFrame = Transforms.eastNorthUpToFixedFrame(camera.positionWC, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.rotateIsLook = true\n  } else {\n    viewModel.rotateFrame = Transforms.eastNorthUpToFixedFrame(viewCenter, viewModel.viewer.scene.globe.ellipsoid, newTransformScratch)\n    viewModel.rotateIsLook = false\n  }\n\n  let oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n  camera.lookAtTransform(viewModel.rotateFrame)\n  viewModel.rotateInitialCameraAngle = Math.atan2(camera.position.y, camera.position.x)\n  viewModel.rotateInitialCameraDistance = Cartesian3.magnitude(new Cartesian3(camera.position.x, camera.position.y, 0.0))\n  camera.lookAtTransform(oldTransform)\n  viewModel.rotateMouseMoveFunction = (event) => {\n    const compassRectangle = compassElement.getBoundingClientRect()\n    const center = new Cartesian2(\n      (compassRectangle.right - compassRectangle.left) / 2.0,\n      (compassRectangle.bottom - compassRectangle.top) / 2.0\n    )\n    const clickLocation =\n      event.type === 'mousedown' || event.type === 'mousemove'\n        ? new Cartesian2(event.clientX - compassRectangle.left, event.clientY - compassRectangle.top)\n        : new Cartesian2(\n          event.changedTouches[0].clientX - compassRectangle.left,\n          event.changedTouches[0].clientY - compassRectangle.top\n        )\n    const vector = Cartesian2.subtract(clickLocation, center, vectorScratch)\n    const angle = Math.atan2(-vector.y, vector.x)\n    const angleDifference = angle - viewModel.rotateInitialCursorAngle\n    const newCameraAngle = CesiumMath.zeroToTwoPi(viewModel.rotateInitialCameraAngle - angleDifference)\n    camera = viewModel.viewer.scene.camera\n\n    oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n    camera.lookAtTransform(viewModel.rotateFrame)\n    const currentCameraAngle = Math.atan2(camera.position.y, camera.position.x)\n    camera.rotateRight(newCameraAngle - currentCameraAngle)\n    camera.lookAtTransform(oldTransform)\n  }\n\n  viewModel.rotateMouseUpFunction = () => {\n    viewModel.isRotating = false\n    document.removeEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n    document.removeEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n    document.removeEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n    document.removeEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n\n    viewModel.rotateMouseMoveFunction = undefined\n    viewModel.rotateMouseUpFunction = undefined\n  }\n\n  document.addEventListener('mousemove', viewModel.rotateMouseMoveFunction, false)\n  document.addEventListener('touchmove', viewModel.rotateMouseMoveFunction, false)\n  document.addEventListener('mouseup', viewModel.rotateMouseUpFunction, false)\n  document.addEventListener('touchend', viewModel.rotateMouseUpFunction, false)\n}\n\nfunction rotateEast (viewModel, compassElement, cursorVector) {\n  const { defined, getTimestamp, Math: CesiumMath, ScreenSpaceEventType } = Cesium\n  viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n  defined(viewModel.rotateEastTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.rotateEastTickFunction)\n  viewModel.rotateEastMouseUpFunction = undefined\n  viewModel.rotateEastTickFunction = undefined\n  viewModel.isrotateEasting = true\n  viewModel.rotateEastLastTimestamp = getTimestamp()\n  let angle = CesiumMath.PI_OVER_TWO - Math.atan2(-cursorVector.y, cursorVector.x)\n  const a = Math.PI / 4\n  let roateDirection = 0\n  const roateType = {\n    LEFT: 1,\n    RIGHT: 2,\n    UP: 3,\n    DOWN: 4\n  }\n  roateDirection = angle >= -a && a >= angle\n    ? roateType.DOWN\n    : angle >= a && 3 * a >= angle\n      ? roateType.RIGHT\n      : angle >= 3 * a && 5 * a >= angle ? roateType.UP : roateType.LEFT\n  viewModel.rotateEastTickFunction = () => {\n    const scene = viewModel.viewer.scene\n    const camera = scene.camera\n    const timestamp = getTimestamp()\n    angle = 20 * Math.abs(camera.positionCartographic.height / 6378317) * 0.0005\n    switch (roateDirection) {\n      case roateType.LEFT:\n        camera.rotateLeft(angle)\n        break\n      case roateType.RIGHT:\n        camera.rotateRight(angle)\n        break\n      case roateType.UP:\n        camera.rotate(camera.right, -angle)\n        break\n      case roateType.DOWN:\n        camera.rotate(camera.right, angle)\n    }\n    viewModel.rotateEastLastTimestamp = timestamp\n  }\n  viewModel.rotateEastMouseUpFunction = () => {\n    viewModel.isRotateEasting = false\n    viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n    defined(viewModel.rotateEastTickFunction) &&\n      viewModel.viewer.clock.onTick.removeEventListener(viewModel.rotateEastTickFunction)\n    viewModel.rotateEastMouseUpFunction = undefined\n    viewModel.rotateEastTickFunction = undefined\n  }\n\n  viewModel.screenSpaceEventHandler.setInputAction(viewModel.rotateEastMouseUpFunction, ScreenSpaceEventType.LEFT_UP)\n  viewModel.viewer.clock.onTick.addEventListener(viewModel.rotateEastTickFunction)\n}\nfunction tilt (viewModel, compassElement, cursorVector) {\n  const { Cartesian2, defined, Math: CesiumMath, Matrix4, ScreenSpaceEventType, Transforms } = Cesium\n  // Remove existing event handlers, if any.\n  viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.MOUSE_MOVE)\n  viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n  viewModel.tiltMouseMoveFunction = undefined\n  viewModel.tiltMouseUpFunction = undefined\n  let tiltInitialCursorAngle = CesiumMath.PI_OVER_TWO - Math.atan2(-cursorVector.y, cursorVector.x)\n  tiltInitialCursorAngle = tiltInitialCursorAngle < 0 ? 0 : tiltInitialCursorAngle\n  tiltInitialCursorAngle = tiltInitialCursorAngle > CesiumMath.PI_OVER_TWO ? CesiumMath.PI_OVER_TWO : tiltInitialCursorAngle\n  viewModel.tiltInitialCursorAngle = tiltInitialCursorAngle\n  viewModel.isTilting = true\n  const scene = viewModel.viewer.scene\n  const camera = scene.camera\n  const windowPosition = new Cartesian2()\n  windowPosition.x = scene.canvas.clientWidth / 2\n  windowPosition.y = scene.canvas.clientHeight / 2\n  let pickPosition = camera.pickEllipsoid(windowPosition, scene.globe.ellipsoid)\n  if (!defined(pickPosition)) {\n    for (; windowPosition.y < scene.canvas.clientHeight;) {\n      windowPosition.y += 5\n      pickPosition = camera.pickEllipsoid(windowPosition, scene.globe.ellipsoid)\n    }\n  }\n\n  defined(pickPosition) && (viewModel.tiltFrame = Transforms.eastNorthUpToFixedFrame(pickPosition, scene.globe.ellipsoid))\n  viewModel.tiltMouseMoveFunction = (e, n) => {\n    viewModel.isTilting = true\n    const compassRectangle = compassElement.getBoundingClientRect()\n    const center = new Cesium.Cartesian2(\n      (compassRectangle.right - compassRectangle.left) / 2.0,\n      (compassRectangle.bottom - compassRectangle.top) / 2.0\n    )\n    const endPosition = Cartesian2.clone(e.endPosition)\n    const vector = Cartesian2.subtract(endPosition, center, vectorScratch)\n    let angle = CesiumMath.PI_OVER_TWO - Math.atan2(-vector.y, vector.x)\n    angle = angle < 0 ? 0 : angle\n    angle = angle > CesiumMath.PI_OVER_TWO ? CesiumMath.PI_OVER_TWO : angle\n    const camera = viewModel.viewer.scene.camera\n    const oldTransform = Matrix4.clone(camera.transform, oldTransformScratch)\n    camera.lookAtTransform(viewModel.tiltFrame)\n    const rotateUpAngle = angle - viewModel.tiltInitialCursorAngle\n    camera.rotateUp(rotateUpAngle)\n    viewModel.tiltInitialCursorAngle = angle\n    camera.lookAtTransform(oldTransform)\n    let level = Math.ceil(angle / (Math.PI / 40))\n    level = level > 19 ? 19 : level\n    const position = positions[level]\n    viewModel.tiltbarLeft = position.x\n    viewModel.tiltbarTop = position.y\n  }\n\n  viewModel.tiltMouseUpFunction = function (e) {\n    viewModel.isTilting = false\n    viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.MOUSE_MOVE)\n    viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n    viewModel.tiltMouseMoveFunction = undefined\n    viewModel.tiltMouseUpFunction = undefined\n  }\n\n  viewModel.screenSpaceEventHandler.setInputAction(viewModel.tiltMouseMoveFunction, ScreenSpaceEventType.MOUSE_MOVE)\n  viewModel.screenSpaceEventHandler.setInputAction(viewModel.tiltMouseUpFunction, ScreenSpaceEventType.LEFT_UP)\n}\n\nfunction getTiltbarPosition () {\n  const { Math: CesiumMath } = Cesium\n  const pitch = CesiumMath.PI_OVER_TWO + this.viewer.scene.camera.pitch\n  const length = Math.PI / 2 / 20\n  let level = Math.floor(pitch / length)\n  level = level > 19 ? 19 : level\n  level = level < 0 ? 0 : level\n  this.tiltbarLeft = positions[level].x\n  this.tiltbarTop = positions[level].y\n}\n\nfunction viewerChange (viewModel) {\n  const { defined, Math: CesiumMath } = Cesium\n  if (defined(viewModel.viewer)) {\n    if (viewModel._unsubcribeFromPostRender) {\n      viewModel._unsubcribeFromPostRender()\n      viewModel._unsubcribeFromPostRender = undefined\n    }\n    viewModel._unsubcribeFromPostRender = viewModel.viewer.scene.postRender.addEventListener(() => {\n      viewModel.heading = viewModel.viewer.scene.camera.heading\n      if (!viewModel.isTilting) {\n        const angle = viewModel.viewer.scene.camera.pitch + CesiumMath.PI_OVER_TWO\n        const length = CesiumMath.PI_OVER_TWO / 20\n        let level = Math.floor(angle / length)\n        level = level > 19 ? 19 : level\n        level = level < 0 ? 0 : level\n        viewModel.tiltbarLeft = positions[level].x\n        viewModel.tiltbarTop = positions[level].y\n      }\n    })\n  } else {\n    if (viewModel._unsubcribeFromPostRender) {\n      viewModel._unsubcribeFromPostRender()\n      viewModel._unsubcribeFromPostRender = undefined\n    }\n  }\n}\n</script>\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { Platform } from '../../../utils/util'\nexport default {\n  data () {\n    return {\n      zoombarTop: 65\n    }\n  },\n  computed: {\n    zoombarStyle: function () {\n      return {\n        top: this.zoombarTop + 'px'\n      }\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.container = this.$parent.$refs.navigationContainer\n      this.screenSpaceEventHandler = new Cesium.ScreenSpaceEventHandler(this.container)\n      Platform().isPc || (document.querySelector('.sm-zoom').style.visibility = 'visible')\n    })\n  },\n  methods: {\n    handleZoomBarScrollMouseDown (event, viewModel = this) {\n      const { Cartesian2, defined, SceneMode } = Cesium\n      document.removeEventListener('mousemove', viewModel.zoomBarScrollMouseMoveFunction, false)\n      document.removeEventListener('touchmove', viewModel.zoomBarScrollMouseMoveFunction, false)\n      document.removeEventListener('mouseup', viewModel.zoomBarScrollMouseUpFunction, false)\n      document.removeEventListener('touchend', viewModel.zoomBarScrollMouseUpFunction, false)\n      defined(viewModel.zoombarTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoombarTickFunction)\n      viewModel.zoomBarScrollMouseUpFunction = undefined\n      viewModel.zoombarTickFunction = undefined\n      viewModel.isZoomBarScrolling = true\n      const scene = viewModel.viewer.scene\n      const camera = scene.camera\n\n      viewModel.zoombarTickFunction = () => {\n        const zoomOffset = viewModel.zoombarTop - 65\n        if (zoomOffset > 0) {\n          if (viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n            camera.zoomOut()\n          } else {\n            handlezoom(viewModel, -1)\n          }\n        } else if (zoomOffset < 0) {\n          if (viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n            camera.zoomIn()\n          } else {\n            handlezoom(viewModel, 1)\n          }\n        }\n      }\n      viewModel.zoomBarScrollMouseMoveFunction = e => {\n        const zoombarTop = viewModel.zoombarTop\n        const clientRect = e.target.parentElement.getBoundingClientRect()\n        const rectNavigation = viewModel.container.getBoundingClientRect()\n        const endPosition = {}\n        endPosition.x = e.type === 'touchmove' ? e.changedTouches[0].clientX - rectNavigation.left : e.clientX - rectNavigation.left\n        endPosition.y = e.type === 'touchmove' ? e.changedTouches[0].clientY - rectNavigation.top : e.clientY - rectNavigation.top\n        // 加上一个距离顶部的偏移量 rectViewer.top\n        const rectViewer = viewModel.viewer._element.getBoundingClientRect()\n        const padding = new Cartesian2(endPosition.x - clientRect.left, endPosition.y - clientRect.top + rectViewer.top)\n        let offset = padding.y - 16\n        offset = offset < 0 ? 0 : offset\n        offset = offset > 120 ? 120 : offset\n        viewModel.zoombarTop = offset\n\n        const zoomFlag = viewModel.zoombarTop - zoombarTop\n        if (zoomFlag > 0) {\n          if (viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n            camera.zoomOut()\n          } else {\n            handlezoom(viewModel, -1)\n          }\n        } else {\n          if (viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n            camera.zoomIn()\n          } else {\n            handlezoom(viewModel, 1)\n          }\n        }\n      }\n\n      viewModel.zoomBarScrollMouseUpFunction = () => {\n        viewModel.isZoomBarScrolling = false\n        document.removeEventListener('mousemove', viewModel.zoomBarScrollMouseMoveFunction, false)\n        document.removeEventListener('touchmove', viewModel.zoomBarScrollMouseMoveFunction, false)\n        document.removeEventListener('mouseup', viewModel.zoomBarScrollMouseUpFunction, false)\n        document.removeEventListener('touchend', viewModel.zoomBarScrollMouseUpFunction, false)\n        defined(viewModel.zoombarTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoombarTickFunction)\n        viewModel.zoomBarScrollMouseUpFunction = undefined\n        viewModel.zoomBarScrollMouseMoveFunction = undefined\n        viewModel.zoombarTickFunction = undefined\n        viewModel.zoombarTop = 65\n      }\n      document.addEventListener('mousemove', viewModel.zoomBarScrollMouseMoveFunction, false)\n      document.addEventListener('touchmove', viewModel.zoomBarScrollMouseMoveFunction, false)\n      document.addEventListener('mouseup', viewModel.zoomBarScrollMouseUpFunction, false)\n      document.addEventListener('touchend', viewModel.zoomBarScrollMouseUpFunction, false)\n      viewModel.viewer.clock.onTick.addEventListener(viewModel.zoombarTickFunction)\n    },\n\n    handleZoomInMouseDown (event, viewModel = this) {\n      const { defined, getTimestamp, SceneMode, ScreenSpaceEventType } = Cesium\n      viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n      defined(viewModel.zoominTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoominTickFunction)\n      viewModel.zoominMouseUpFunction = undefined\n      viewModel.zoominTickFunction = undefined\n      viewModel.isZoomin = true\n      viewModel.zoominLastTimestamp = getTimestamp()\n      const scene = viewModel.viewer.scene\n      const camera = scene.camera\n      viewModel.zoominTickFunction = () => {\n        viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW ? camera.zoomIn() : handlezoom(viewModel, 1)\n      }\n\n      viewModel.zoominMouseUpFunction = () => {\n        viewModel.isZoomin = false\n        viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n        defined(viewModel.zoominTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoominTickFunction)\n        viewModel.zoominMouseUpFunction = undefined\n        viewModel.zoominTickFunction = undefined\n      }\n\n      viewModel.screenSpaceEventHandler.setInputAction(viewModel.zoominMouseUpFunction, ScreenSpaceEventType.LEFT_UP)\n      viewModel.viewer.clock.onTick.addEventListener(viewModel.zoominTickFunction)\n    },\n\n    handleZoomOutMouseDown (event, viewModel = this) {\n      const { defined, getTimestamp, SceneMode, ScreenSpaceEventType } = Cesium\n      viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n      defined(viewModel.zoomoutTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoomoutTickFunction)\n      viewModel.zoomoutMouseUpFunction = undefined\n      viewModel.zoomoutTickFunction = undefined\n      viewModel.iszoomout = false\n      viewModel.zoomoutLastTimestamp = getTimestamp()\n      const scene = viewModel.viewer.scene\n      const camera = scene.camera\n      viewModel.zoomoutTickFunction = () => {\n        viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW ? camera.zoomOut() : handlezoom(viewModel, -1)\n      }\n\n      viewModel.zoomoutMouseUpFunction = () => {\n        viewModel.iszoomout = false\n        viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n        defined(viewModel.zoomoutTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoomoutTickFunction)\n        viewModel.zoomoutMouseUpFunction = undefined\n        viewModel.zoomoutTickFunction = undefined\n      }\n\n      viewModel.screenSpaceEventHandler.setInputAction(viewModel.zoomoutMouseUpFunction, ScreenSpaceEventType.LEFT_UP)\n      viewModel.viewer.clock.onTick.addEventListener(viewModel.zoomoutTickFunction)\n    }\n  },\n  destroyed () {\n    this.screenSpaceEventHandler && this.screenSpaceEventHandler.destroy()\n  }\n}\nfunction handlezoom (viewModel, i) {\n  const { Cartesian2, Cartesian3, defined, Ellipsoid, Math } = Cesium\n  const scene = viewModel.viewer.scene\n  const camera = scene.camera\n  const canvas = scene.canvas\n  const centerPixel = new Cartesian2()\n  centerPixel.x = canvas.clientWidth / 2\n  centerPixel.y = canvas.clientHeight / 2\n  const centerPosition = pickGlobe(viewModel, centerPixel)\n  if (defined(centerPosition)) {\n    const distance = Cartesian3.distance(camera.position, centerPosition)\n    let factor = 0.0618 * i * 0.2\n    factor = distance > 300 ? factor : 2 * factor\n    const amount = distance * factor\n    const direction = {}\n    Cartesian3.subtract(centerPosition, camera.position, direction)\n    const cameraRight = Cartesian3.clone(camera.right)\n    const dot = Cartesian3.dot(direction, cameraRight)\n    const movementVector = {}\n    Cartesian3.multiplyByScalar(cameraRight, dot, movementVector)\n    Cartesian3.subtract(direction, movementVector, direction)\n    Cartesian3.normalize(direction, direction)\n    camera.move(direction, amount)\n    const centerPositionNormal = {}\n    Cartesian3.normalize(centerPosition, centerPositionNormal)\n\n    const centerDistance = Cartesian3.magnitude(centerPosition)\n    const ellipsoid = Ellipsoid.fromCartesian3(centerDistance)\n    const pickPosition = camera.pickEllipsoid(centerPixel, ellipsoid)\n    if (\n      defined(pickPosition) &&\n      !isNaN(pickPosition.x) &&\n      !isNaN(pickPosition.y) &&\n      !isNaN(pickPosition.z) &&\n      !(camera.positionCartographic.height < 0)\n    ) {\n      Cartesian3.normalize(pickPosition, pickPosition)\n      const angle = Cartesian3.angleBetween(centerPositionNormal, pickPosition)\n      if (!Math.equalsEpsilon(angle, 0, Math.EPSILON10)) {\n        const axis = Cartesian3.cross(centerPositionNormal, pickPosition)\n        camera.rotate(axis, angle)\n      }\n    }\n  }\n}\n\nfunction pickGlobe (viewModel, mousePosition) {\n  const { defined, Cartesian3 } = Cesium\n  const scene = viewModel.viewer.scene\n  const globe = scene.globe\n  const camera = scene.camera\n  if (defined(globe)) {\n    let depthIntersection\n    if (scene.pickPositionSupported) {\n      depthIntersection = scene.pickPositionWorldCoordinates(mousePosition)\n    }\n    const ray = camera.getPickRay(mousePosition)\n    const rayIntersection = globe.pick(ray, scene)\n    const pickDistance = defined(depthIntersection)\n      ? Cartesian3.distance(depthIntersection, camera.positionWC)\n      : Number.POSITIVE_INFINITY\n    const rayDistance = defined(rayIntersection)\n      ? Cartesian3.distance(rayIntersection, camera.positionWC)\n      : Number.POSITIVE_INFINITY\n    return rayDistance > pickDistance ? depthIntersection : rayIntersection\n  }\n}\n","<template>\n  <div class=\"vc-zoom-sm\">\n    <div\n      :title=\"$vc.lang.navigation.zoomCotrol.zoomIn\"\n      @mousedown=\"handleZoomInMouseDown\"\n      @touchstart=\"handleZoomInMouseDown\"\n      class=\"vc-zoomin-sm\"\n    ></div>\n    <div\n      :title=\"$vc.lang.navigation.zoomCotrol.zoomOut\"\n      @mousedown=\"handleZoomOutMouseDown\"\n      @touchstart=\"handleZoomOutMouseDown\"\n      class=\"vc-zoomout-sm\"\n    ></div>\n    <div\n      :style=\"zoombarStyle\"\n      @mousedown=\"handleZoomBarScrollMouseDown\"\n      @touchstart=\"handleZoomBarScrollMouseDown\"\n      class=\"vc-zoombar-sm\"\n    ></div>\n  </div>\n</template>\n\n<script>\nimport { Platform } from '../../../utils/util'\nexport default {\n  data () {\n    return {\n      zoombarTop: 65\n    }\n  },\n  computed: {\n    zoombarStyle: function () {\n      return {\n        top: this.zoombarTop + 'px'\n      }\n    }\n  },\n  mounted () {\n    this.$parent.createPromise.then(({ Cesium, viewer }) => {\n      this.viewer = viewer\n      this.container = this.$parent.$refs.navigationContainer\n      this.screenSpaceEventHandler = new Cesium.ScreenSpaceEventHandler(this.container)\n      Platform().isPc || (document.querySelector('.sm-zoom').style.visibility = 'visible')\n    })\n  },\n  methods: {\n    handleZoomBarScrollMouseDown (event, viewModel = this) {\n      const { Cartesian2, defined, SceneMode } = Cesium\n      document.removeEventListener('mousemove', viewModel.zoomBarScrollMouseMoveFunction, false)\n      document.removeEventListener('touchmove', viewModel.zoomBarScrollMouseMoveFunction, false)\n      document.removeEventListener('mouseup', viewModel.zoomBarScrollMouseUpFunction, false)\n      document.removeEventListener('touchend', viewModel.zoomBarScrollMouseUpFunction, false)\n      defined(viewModel.zoombarTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoombarTickFunction)\n      viewModel.zoomBarScrollMouseUpFunction = undefined\n      viewModel.zoombarTickFunction = undefined\n      viewModel.isZoomBarScrolling = true\n      const scene = viewModel.viewer.scene\n      const camera = scene.camera\n\n      viewModel.zoombarTickFunction = () => {\n        const zoomOffset = viewModel.zoombarTop - 65\n        if (zoomOffset > 0) {\n          if (viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n            camera.zoomOut()\n          } else {\n            handlezoom(viewModel, -1)\n          }\n        } else if (zoomOffset < 0) {\n          if (viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n            camera.zoomIn()\n          } else {\n            handlezoom(viewModel, 1)\n          }\n        }\n      }\n      viewModel.zoomBarScrollMouseMoveFunction = e => {\n        const zoombarTop = viewModel.zoombarTop\n        const clientRect = e.target.parentElement.getBoundingClientRect()\n        const rectNavigation = viewModel.container.getBoundingClientRect()\n        const endPosition = {}\n        endPosition.x = e.type === 'touchmove' ? e.changedTouches[0].clientX - rectNavigation.left : e.clientX - rectNavigation.left\n        endPosition.y = e.type === 'touchmove' ? e.changedTouches[0].clientY - rectNavigation.top : e.clientY - rectNavigation.top\n        // 加上一个距离顶部的偏移量 rectViewer.top\n        const rectViewer = viewModel.viewer._element.getBoundingClientRect()\n        const padding = new Cartesian2(endPosition.x - clientRect.left, endPosition.y - clientRect.top + rectViewer.top)\n        let offset = padding.y - 16\n        offset = offset < 0 ? 0 : offset\n        offset = offset > 120 ? 120 : offset\n        viewModel.zoombarTop = offset\n\n        const zoomFlag = viewModel.zoombarTop - zoombarTop\n        if (zoomFlag > 0) {\n          if (viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n            camera.zoomOut()\n          } else {\n            handlezoom(viewModel, -1)\n          }\n        } else {\n          if (viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW) {\n            camera.zoomIn()\n          } else {\n            handlezoom(viewModel, 1)\n          }\n        }\n      }\n\n      viewModel.zoomBarScrollMouseUpFunction = () => {\n        viewModel.isZoomBarScrolling = false\n        document.removeEventListener('mousemove', viewModel.zoomBarScrollMouseMoveFunction, false)\n        document.removeEventListener('touchmove', viewModel.zoomBarScrollMouseMoveFunction, false)\n        document.removeEventListener('mouseup', viewModel.zoomBarScrollMouseUpFunction, false)\n        document.removeEventListener('touchend', viewModel.zoomBarScrollMouseUpFunction, false)\n        defined(viewModel.zoombarTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoombarTickFunction)\n        viewModel.zoomBarScrollMouseUpFunction = undefined\n        viewModel.zoomBarScrollMouseMoveFunction = undefined\n        viewModel.zoombarTickFunction = undefined\n        viewModel.zoombarTop = 65\n      }\n      document.addEventListener('mousemove', viewModel.zoomBarScrollMouseMoveFunction, false)\n      document.addEventListener('touchmove', viewModel.zoomBarScrollMouseMoveFunction, false)\n      document.addEventListener('mouseup', viewModel.zoomBarScrollMouseUpFunction, false)\n      document.addEventListener('touchend', viewModel.zoomBarScrollMouseUpFunction, false)\n      viewModel.viewer.clock.onTick.addEventListener(viewModel.zoombarTickFunction)\n    },\n\n    handleZoomInMouseDown (event, viewModel = this) {\n      const { defined, getTimestamp, SceneMode, ScreenSpaceEventType } = Cesium\n      viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n      defined(viewModel.zoominTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoominTickFunction)\n      viewModel.zoominMouseUpFunction = undefined\n      viewModel.zoominTickFunction = undefined\n      viewModel.isZoomin = true\n      viewModel.zoominLastTimestamp = getTimestamp()\n      const scene = viewModel.viewer.scene\n      const camera = scene.camera\n      viewModel.zoominTickFunction = () => {\n        viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW ? camera.zoomIn() : handlezoom(viewModel, 1)\n      }\n\n      viewModel.zoominMouseUpFunction = () => {\n        viewModel.isZoomin = false\n        viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n        defined(viewModel.zoominTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoominTickFunction)\n        viewModel.zoominMouseUpFunction = undefined\n        viewModel.zoominTickFunction = undefined\n      }\n\n      viewModel.screenSpaceEventHandler.setInputAction(viewModel.zoominMouseUpFunction, ScreenSpaceEventType.LEFT_UP)\n      viewModel.viewer.clock.onTick.addEventListener(viewModel.zoominTickFunction)\n    },\n\n    handleZoomOutMouseDown (event, viewModel = this) {\n      const { defined, getTimestamp, SceneMode, ScreenSpaceEventType } = Cesium\n      viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n      defined(viewModel.zoomoutTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoomoutTickFunction)\n      viewModel.zoomoutMouseUpFunction = undefined\n      viewModel.zoomoutTickFunction = undefined\n      viewModel.iszoomout = false\n      viewModel.zoomoutLastTimestamp = getTimestamp()\n      const scene = viewModel.viewer.scene\n      const camera = scene.camera\n      viewModel.zoomoutTickFunction = () => {\n        viewModel.viewer.scene.mode === SceneMode.COLUMBUS_VIEW ? camera.zoomOut() : handlezoom(viewModel, -1)\n      }\n\n      viewModel.zoomoutMouseUpFunction = () => {\n        viewModel.iszoomout = false\n        viewModel.screenSpaceEventHandler.removeInputAction(ScreenSpaceEventType.LEFT_UP)\n        defined(viewModel.zoomoutTickFunction) && viewModel.viewer.clock.onTick.removeEventListener(viewModel.zoomoutTickFunction)\n        viewModel.zoomoutMouseUpFunction = undefined\n        viewModel.zoomoutTickFunction = undefined\n      }\n\n      viewModel.screenSpaceEventHandler.setInputAction(viewModel.zoomoutMouseUpFunction, ScreenSpaceEventType.LEFT_UP)\n      viewModel.viewer.clock.onTick.addEventListener(viewModel.zoomoutTickFunction)\n    }\n  },\n  destroyed () {\n    this.screenSpaceEventHandler && this.screenSpaceEventHandler.destroy()\n  }\n}\nfunction handlezoom (viewModel, i) {\n  const { Cartesian2, Cartesian3, defined, Ellipsoid, Math } = Cesium\n  const scene = viewModel.viewer.scene\n  const camera = scene.camera\n  const canvas = scene.canvas\n  const centerPixel = new Cartesian2()\n  centerPixel.x = canvas.clientWidth / 2\n  centerPixel.y = canvas.clientHeight / 2\n  const centerPosition = pickGlobe(viewModel, centerPixel)\n  if (defined(centerPosition)) {\n    const distance = Cartesian3.distance(camera.position, centerPosition)\n    let factor = 0.0618 * i * 0.2\n    factor = distance > 300 ? factor : 2 * factor\n    const amount = distance * factor\n    const direction = {}\n    Cartesian3.subtract(centerPosition, camera.position, direction)\n    const cameraRight = Cartesian3.clone(camera.right)\n    const dot = Cartesian3.dot(direction, cameraRight)\n    const movementVector = {}\n    Cartesian3.multiplyByScalar(cameraRight, dot, movementVector)\n    Cartesian3.subtract(direction, movementVector, direction)\n    Cartesian3.normalize(direction, direction)\n    camera.move(direction, amount)\n    const centerPositionNormal = {}\n    Cartesian3.normalize(centerPosition, centerPositionNormal)\n\n    const centerDistance = Cartesian3.magnitude(centerPosition)\n    const ellipsoid = Ellipsoid.fromCartesian3(centerDistance)\n    const pickPosition = camera.pickEllipsoid(centerPixel, ellipsoid)\n    if (\n      defined(pickPosition) &&\n      !isNaN(pickPosition.x) &&\n      !isNaN(pickPosition.y) &&\n      !isNaN(pickPosition.z) &&\n      !(camera.positionCartographic.height < 0)\n    ) {\n      Cartesian3.normalize(pickPosition, pickPosition)\n      const angle = Cartesian3.angleBetween(centerPositionNormal, pickPosition)\n      if (!Math.equalsEpsilon(angle, 0, Math.EPSILON10)) {\n        const axis = Cartesian3.cross(centerPositionNormal, pickPosition)\n        camera.rotate(axis, angle)\n      }\n    }\n  }\n}\n\nfunction pickGlobe (viewModel, mousePosition) {\n  const { defined, Cartesian3 } = Cesium\n  const scene = viewModel.viewer.scene\n  const globe = scene.globe\n  const camera = scene.camera\n  if (defined(globe)) {\n    let depthIntersection\n    if (scene.pickPositionSupported) {\n      depthIntersection = scene.pickPositionWorldCoordinates(mousePosition)\n    }\n    const ray = camera.getPickRay(mousePosition)\n    const rayIntersection = globe.pick(ray, scene)\n    const pickDistance = defined(depthIntersection)\n      ? Cartesian3.distance(depthIntersection, camera.positionWC)\n      : Number.POSITIVE_INFINITY\n    const rayDistance = defined(rayIntersection)\n      ? Cartesian3.distance(rayIntersection, camera.positionWC)\n      : Number.POSITIVE_INFINITY\n    return rayDistance > pickDistance ? depthIntersection : rayIntersection\n  }\n}\n</script>\n","//\n//\n//\n//\n//\n//\n\nimport cmp from '../../../mixins/virtualCmp'\nimport VcCompassSM from './VcCompassSM.vue'\nimport VcZoomControlSM from './VcZoomControlSM.vue'\nimport '../../../assets/styles/components/navigation-sm.css'\nexport default {\n  name: 'vc-navigation-sm',\n  components: {\n    'vc-compass-sm': VcCompassSM,\n    'vc-zoom-control-sm': VcZoomControlSM\n  },\n  data () {\n    return {\n      defaultOptions: {\n        enableCompass: true,\n        enableCompassOuterRing: true,\n        enableZoomControl: true\n      },\n      ncTop: 0\n    }\n  },\n  mixins: [cmp],\n  props: {\n    options: Object\n  },\n  computed: {\n    navigationContainerStyle: function () {\n      return {\n        top: this.ncTop + 'px'\n      }\n    }\n  },\n  watch: {\n    options: {\n      handler () {\n        this.reload()\n      },\n      deep: true\n    }\n  },\n  methods: {\n    async createCesiumObject () {\n      Object.assign(this.defaultOptions, this.options)\n      this.viewer.widgetResized.addEventListener(this.widgetResized)\n      this.widgetResized()\n    },\n    async mount () {\n      return true\n    },\n    async unmount () {\n      return true\n    },\n    widgetResized () {\n      const { viewer } = this\n      let ncTop = 0\n      viewer._toolbar && (ncTop += viewer._toolbar.getBoundingClientRect().height)\n      this.ncTop = ncTop\n    }\n  },\n  stubVNode: {\n    empty () {\n      return this.$options.name\n    }\n  },\n  created () {\n    Object.defineProperties(this, {\n      cesiumNavigation: {\n        enumerable: true,\n        get: () => this.$services && this.cesiumObject\n      }\n    })\n  }\n}\n","<template>\n  <div :style=\"navigationContainerStyle\" class=\"vc-navigationContainer-sm\" ref=\"navigationContainer\">\n    <vc-compass-sm :enableCompassOuterRing=\"defaultOptions.enableCompassOuterRing\" v-if=\"defaultOptions.enableCompass\"></vc-compass-sm>\n    <vc-zoom-control-sm v-if=\"defaultOptions.enableZoomControl\"></vc-zoom-control-sm>\n  </div>\n</template>\n<script>\nimport cmp from '../../../mixins/virtualCmp'\nimport VcCompassSM from './VcCompassSM.vue'\nimport VcZoomControlSM from './VcZoomControlSM.vue'\nimport '../../../assets/styles/components/navigation-sm.css'\nexport default {\n  name: 'vc-navigation-sm',\n  components: {\n    'vc-compass-sm': VcCompassSM,\n    'vc-zoom-control-sm': VcZoomControlSM\n  },\n  data () {\n    return {\n      defaultOptions: {\n        enableCompass: true,\n        enableCompassOuterRing: true,\n        enableZoomControl: true\n      },\n      ncTop: 0\n    }\n  },\n  mixins: [cmp],\n  props: {\n    options: Object\n  },\n  computed: {\n    navigationContainerStyle: function () {\n      return {\n        top: this.ncTop + 'px'\n      }\n    }\n  },\n  watch: {\n    options: {\n      handler () {\n        this.reload()\n      },\n      deep: true\n    }\n  },\n  methods: {\n    async createCesiumObject () {\n      Object.assign(this.defaultOptions, this.options)\n      this.viewer.widgetResized.addEventListener(this.widgetResized)\n      this.widgetResized()\n    },\n    async mount () {\n      return true\n    },\n    async unmount () {\n      return true\n    },\n    widgetResized () {\n      const { viewer } = this\n      let ncTop = 0\n      viewer._toolbar && (ncTop += viewer._toolbar.getBoundingClientRect().height)\n      this.ncTop = ncTop\n    }\n  },\n  stubVNode: {\n    empty () {\n      return this.$options.name\n    }\n  },\n  created () {\n    Object.defineProperties(this, {\n      cesiumNavigation: {\n        enumerable: true,\n        get: () => this.$services && this.cesiumObject\n      }\n    })\n  }\n}\n</script>\n","import VcNavigationSM from './VcNavigationSM.vue'\n\nfunction plugin (Vue, options = {}) {\n  if (plugin.installed) {\n    return\n  }\n  plugin.installed = true\n\n  Vue.component(VcNavigationSM.name, VcNavigationSM)\n}\n\nexport default plugin\n\nexport {\n  VcNavigationSM,\n  plugin as install\n}\n"],"names":["name","props","enableCompassOuterRing","Boolean","data","tiltbarLeft","tiltbarTop","heading","computed","tiltbarStyle","left","top","outerRingStyle","transform","mounted","$parent","createPromise","then","Cesium","viewer","scene","camera","screenSpaceEventHandler","ScreenSpaceEventHandler","$refs","navigationContainer","isRotating","rotateInitialCursorAngle","undefined","rotateFrame","rotateMouseMoveFunction","rotateMouseUpFunction","_unsubcribeFromPostRender","isTilting","tiltInitialCursorAngle","getTiltbarPosition","call","viewerChange","Platform","isPc","document","querySelector","style","visibility","methods","handleMouseDown","event","Cartesian2","CesiumMath","Math","SceneMode","mode","MORPHING","compassElement","currentTarget","compassRectangle","getBoundingClientRect","center","right","bottom","clickLocation","type","clientX","clientY","changedTouches","vector","subtract","vectorScratch","clickStartPosition","distanceFromCenter","magnitude","rotate","rotateEast","angle","PI_OVER_TWO","atan2","y","x","tilt","handleDoubleClick","e","Cartesian3","defined","Matrix4","Ray","Transforms","windowPosition","canvas","clientWidth","clientHeight","pickRayScratch","ray","getPickRay","globe","pick","centerScratch","eastNorthUpToFixedFrame","ellipsoid","lookVector","position","flight","CameraFlightPath","createTween","destination","multiplyByPoint","direction","multiplyByPointAsVector","up","duration","tweens","add","handleMouseUp","toDegrees","dX","dY","distance","sqrt","m","abs","flyTo","orientation","pitch","destroyed","destroy","oldTransformScratch","newTransformScratch","positions","viewModel","cursorVector","removeEventListener","viewCenter","positionWC","rotateIsLook","oldTransform","clone","lookAtTransform","rotateInitialCameraAngle","rotateInitialCameraDistance","angleDifference","newCameraAngle","zeroToTwoPi","currentCameraAngle","rotateRight","addEventListener","getTimestamp","ScreenSpaceEventType","removeInputAction","LEFT_UP","rotateEastTickFunction","clock","onTick","rotateEastMouseUpFunction","isrotateEasting","rotateEastLastTimestamp","a","PI","roateDirection","roateType","LEFT","RIGHT","UP","DOWN","timestamp","positionCartographic","height","rotateLeft","isRotateEasting","setInputAction","MOUSE_MOVE","tiltMouseMoveFunction","tiltMouseUpFunction","pickPosition","pickEllipsoid","tiltFrame","n","endPosition","rotateUpAngle","rotateUp","level","ceil","length","floor","postRender","zoombarTop","zoombarStyle","container","handleZoomBarScrollMouseDown","zoomBarScrollMouseMoveFunction","zoomBarScrollMouseUpFunction","zoombarTickFunction","isZoomBarScrolling","zoomOffset","COLUMBUS_VIEW","zoomOut","handlezoom","zoomIn","clientRect","target","parentElement","rectNavigation","rectViewer","_element","padding","offset","zoomFlag","handleZoomInMouseDown","zoominTickFunction","zoominMouseUpFunction","isZoomin","zoominLastTimestamp","handleZoomOutMouseDown","zoomoutTickFunction","zoomoutMouseUpFunction","iszoomout","zoomoutLastTimestamp","i","Ellipsoid","centerPixel","centerPosition","pickGlobe","factor","amount","cameraRight","dot","movementVector","multiplyByScalar","normalize","move","centerPositionNormal","centerDistance","fromCartesian3","isNaN","z","angleBetween","equalsEpsilon","EPSILON10","axis","cross","mousePosition","depthIntersection","pickPositionSupported","pickPositionWorldCoordinates","rayIntersection","pickDistance","Number","POSITIVE_INFINITY","rayDistance","components","VcCompassSM","VcZoomControlSM","defaultOptions","enableCompass","enableZoomControl","ncTop","mixins","cmp","options","Object","navigationContainerStyle","watch","handler","reload","deep","createCesiumObject","widgetResized","mount","unmount","_toolbar","stubVNode","empty","$options","created","defineProperties","cesiumNavigation","enumerable","get","$services","cesiumObject","plugin","Vue","installed","component","VcNavigationSM"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAwBA,aAAe;AACbA,EAAAA,IAAI,EAAE,eADO;AAEbC,EAAAA,KAAK,EAAE;AACLC,IAAAA,sBAAsB,EAAEC;AADnB,GAFM;AAKbC,EAAAA,IALa,kBAKL;AACN,WAAO;AACLC,MAAAA,WAAW,EAAE,EADR;AAELC,MAAAA,UAAU,EAAE,CAFP;AAGLC,MAAAA,OAAO,EAAE;AAHJ,KAAP;AAKD,GAXY;AAYbC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,YAAY,EAAE,wBAAY;AACxB,aAAO;AACLC,QAAAA,IAAI,EAAE,KAAKL,WAAL,GAAmB,IADpB;AAELM,QAAAA,GAAG,EAAE,KAAKL,UAAL,GAAkB;AAFlB,OAAP;AAID,KANO;AAORM,IAAAA,cAAc,EAAE,0BAAY;AAC1B,aAAO;AACLC,QAAAA,SAAS,EAAE,aAAa,KAAKN,OAAlB,GAA4B,MADlC;AAEL,6BAAqB,aAAa,KAAKA,OAAlB,GAA4B;AAF5C,OAAP;AAID;AAZO,GAZG;AA0BbO,EAAAA,OA1Ba,qBA0BF;AAAA;;AACT,SAAKC,OAAL,CAAaC,aAAb,CAA2BC,IAA3B,CAAgC,gBAAwB;AAAA,UAArBC,MAAqB,QAArBA,MAAqB;AAAA,UAAbC,MAAa,QAAbA,MAAa;AACtD,MAAA,KAAI,CAACA,MAAL,GAAcA,MAAd;AACA,MAAA,KAAI,CAACZ,OAAL,GAAeY,MAAM,CAACC,KAAP,CAAaC,MAAb,CAAoBd,OAAnC;AACA,MAAA,KAAI,CAACe,uBAAL,GAA+B,IAAIJ,MAAM,CAACK,uBAAX,CAAmC,KAAI,CAACR,OAAL,CAAaS,KAAb,CAAmBC,mBAAtD,CAA/B;AACA,MAAA,KAAI,CAACC,UAAL,GAAkB,KAAlB;AACA,MAAA,KAAI,CAACC,wBAAL,GAAgCC,SAAhC;AACA,MAAA,KAAI,CAACC,WAAL,GAAmBD,SAAnB;AACA,MAAA,KAAI,CAACE,uBAAL,GAA+BF,SAA/B;AACA,MAAA,KAAI,CAACG,qBAAL,GAA6BH,SAA7B;AACA,MAAA,KAAI,CAACI,yBAAL,GAAiCJ,SAAjC;AACA,MAAA,KAAI,CAACK,SAAL,GAAiB,KAAjB;AACA,MAAA,KAAI,CAACC,sBAAL,GAA8B,CAA9B;AACAC,MAAAA,kBAAkB,CAACC,IAAnB,CAAwB,KAAxB;AACAC,MAAAA,YAAY,CAAC,KAAD,CAAZ;;AACA,UAAI,CAACC,QAAQ,GAAGC,IAAhB,EAAsB;AACpBC,QAAAA,QAAQ,CAACC,aAAT,CAAuB,wBAAvB,EAAiDC,KAAjD,CAAuDC,UAAvD,GAAoE,SAApE;AACAH,QAAAA,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,EAAgDC,KAAhD,CAAsDC,UAAtD,GAAmE,SAAnE;AACAH,QAAAA,QAAQ,CAACC,aAAT,CAAuB,qBAAvB,EAA8CC,KAA9C,CAAoDC,UAApD,GAAiE,SAAjE;AACD;AACF,KAnBD;AAoBD,GA/CY;AAgDbC,EAAAA,OAAO,EAAE;AACPC,IAAAA,eADO,2BACUC,KADV,EACiB;AACtB,oBAAoD5B,MAApD;AAAA,UAAQ6B,UAAR,WAAQA,UAAR;AAAA,UAA0BC,UAA1B,WAAoBC,IAApB;AAAA,UAAsCC,SAAtC,WAAsCA,SAAtC;AACA,UAAM9B,KAAK,GAAG,KAAKD,MAAL,CAAYC,KAA1B;;AACA,UAAIA,KAAK,CAAC+B,IAAN,KAAeD,SAAS,CAACE,QAA7B,EAAuC;AACrC,eAAO,IAAP;AACD;;AACD,UAAMC,cAAc,GAAGP,KAAK,CAACQ,aAA7B;AACA,UAAMC,gBAAgB,GAAGT,KAAK,CAACQ,aAAN,CAAoBE,qBAApB,EAAzB;AACA,UAAMC,MAAM,GAAG,IAAIV,UAAJ,CACb,CAACQ,gBAAgB,CAACG,KAAjB,GAAyBH,gBAAgB,CAAC7C,IAA3C,IAAmD,GADtC,EAEb,CAAC6C,gBAAgB,CAACI,MAAjB,GAA0BJ,gBAAgB,CAAC5C,GAA5C,IAAmD,GAFtC,CAAf;AAIA,UAAMiD,aAAa,GACjBd,KAAK,CAACe,IAAN,KAAe,WAAf,GACI,IAAId,UAAJ,CAAeD,KAAK,CAACgB,OAAN,GAAgBP,gBAAgB,CAAC7C,IAAhD,EAAsDoC,KAAK,CAACiB,OAAN,GAAgBR,gBAAgB,CAAC5C,GAAvF,CADJ,GAEI,IAAIoC,UAAJ,CACAD,KAAK,CAACkB,cAAN,CAAqB,CAArB,EAAwBF,OAAxB,GAAkCP,gBAAgB,CAAC7C,IADnD,EAEAoC,KAAK,CAACkB,cAAN,CAAqB,CAArB,EAAwBD,OAAxB,GAAkCR,gBAAgB,CAAC5C,GAFnD,CAHN;AAOA,UAAMsD,MAAM,GAAGlB,UAAU,CAACmB,QAAX,CAAoBN,aAApB,EAAmCH,MAAnC,EAA2CU,aAA3C,CAAf;AACA,WAAKC,kBAAL,GAA0B,IAAIrB,UAAJ,CAAeD,KAAK,CAACgB,OAArB,EAA8BhB,KAAK,CAACiB,OAApC,CAA1B;AACA,UAAMM,kBAAkB,GAAGtB,UAAU,CAACuB,SAAX,CAAqBL,MAArB,CAA3B;;AAEA,UAAII,kBAAkB,GAAG,EAArB,IAA2BA,kBAAkB,GAAG,EAApD,EAAwD;AACtDE,QAAAA,MAAM,CAAC,IAAD,EAAOlB,cAAP,EAAuBY,MAAvB,CAAN;AACD,OAFD,MAEO,IAAI,EAAEI,kBAAkB,GAAG,EAArB,IAA2BA,kBAAkB,GAAG,EAAlD,CAAJ,EAA2D;AAChEG,QAAAA,UAAU,CAAC,IAAD,EAAOnB,cAAP,EAAuBY,MAAvB,CAAV;AACD,OAFM,MAEA;AACL,YAAMQ,KAAK,GAAGzB,UAAU,CAAC0B,WAAX,GAAyBzB,IAAI,CAAC0B,KAAL,CAAW,CAACV,MAAM,CAACW,CAAnB,EAAsBX,MAAM,CAACY,CAA7B,CAAvC;AACAJ,QAAAA,KAAK,IAAI,CAAT,IAAcA,KAAK,IAAIzB,UAAU,CAAC0B,WAAlC,IAAiDI,IAAI,CAAC,IAAD,EAAOzB,cAAP,EAAuBY,MAAvB,CAArD;AACD;AACF,KAhCM;AAiCPc,IAAAA,iBAjCO,6BAiCYC,CAjCZ,EAiCe;AACpB,qBAAiF9D,MAAjF;AAAA,UAAQ6B,UAAR,YAAQA,UAAR;AAAA,UAAoBkC,UAApB,YAAoBA,UAApB;AAAA,UAAgCC,OAAhC,YAAgCA,OAAhC;AAAA,UAAyCC,OAAzC,YAAyCA,OAAzC;AAAA,UAAkDC,GAAlD,YAAkDA,GAAlD;AAAA,UAAuDlC,SAAvD,YAAuDA,SAAvD;AAAA,UAAkEmC,UAAlE,YAAkEA,UAAlE;AACA,UAAMjE,KAAK,GAAG,KAAKD,MAAL,CAAYC,KAA1B;AACA,UAAMC,MAAM,GAAGD,KAAK,CAACC,MAArB;;AAEA,UAAID,KAAK,CAAC+B,IAAN,KAAeD,SAAS,CAACE,QAA7B,EAAuC;AACrC,eAAO,IAAP;AACD;;AACD,UAAMG,gBAAgB,GAAGyB,CAAC,CAAC1B,aAAF,CAAgBE,qBAAhB,EAAzB;AACA,UAAMC,MAAM,GAAG,IAAIV,UAAJ,CACb,CAACQ,gBAAgB,CAACG,KAAjB,GAAyBH,gBAAgB,CAAC7C,IAA3C,IAAmD,GADtC,EAEb,CAAC6C,gBAAgB,CAACI,MAAjB,GAA0BJ,gBAAgB,CAAC5C,GAA5C,IAAmD,GAFtC,CAAf;AAIA,UAAMiD,aAAa,GACjBoB,CAAC,CAACnB,IAAF,KAAW,UAAX,GACI,IAAId,UAAJ,CAAeiC,CAAC,CAAClB,OAAF,GAAYP,gBAAgB,CAAC7C,IAA5C,EAAkDsE,CAAC,CAACjB,OAAF,GAAYR,gBAAgB,CAAC5C,GAA/E,CADJ,GAEI,IAAIoC,UAAJ,CACAiC,CAAC,CAAChB,cAAF,CAAiB,CAAjB,EAAoBF,OAApB,GAA8BP,gBAAgB,CAAC7C,IAD/C,EAEAsE,CAAC,CAAChB,cAAF,CAAiB,CAAjB,EAAoBD,OAApB,GAA8BR,gBAAgB,CAAC5C,GAF/C,CAHN;AAOA,UAAMsD,MAAM,GAAGlB,UAAU,CAACmB,QAAX,CAAoBN,aAApB,EAAmCH,MAAnC,EAA2CU,aAA3C,CAAf;AACA,WAAKC,kBAAL,GAA0B,IAAIrB,UAAJ,CAAeiC,CAAC,CAAClB,OAAjB,EAA0BkB,CAAC,CAACjB,OAA5B,CAA1B;AACA,UAAMM,kBAAkB,GAAGtB,UAAU,CAACuB,SAAX,CAAqBL,MAArB,CAA3B;;AAEA,UAAII,kBAAkB,GAAG,EAArB,IAA2BA,kBAAkB,GAAG,EAApD,EAAwD;AACtD,YAAMiB,cAAc,GAAG,IAAIvC,UAAJ,EAAvB;AACAuC,QAAAA,cAAc,CAACT,CAAf,GAAmBzD,KAAK,CAACmE,MAAN,CAAaC,WAAb,GAA2B,CAA9C;AACAF,QAAAA,cAAc,CAACV,CAAf,GAAmBxD,KAAK,CAACmE,MAAN,CAAaE,YAAb,GAA4B,CAA/C;AACA,YAAMC,cAAc,GAAG,IAAIN,GAAJ,EAAvB;AACA,YAAMO,GAAG,GAAGtE,MAAM,CAACuE,UAAP,CAAkBN,cAAlB,EAAkCI,cAAlC,CAAZ;;AAEA,YAAMjC,OAAM,GAAGrC,KAAK,CAACyE,KAAN,CAAYC,IAAZ,CAAiBH,GAAjB,EAAsBvE,KAAtB,EAA6B2E,aAA7B,CAAf;;AACA,YAAI,CAACb,OAAO,CAACzB,OAAD,CAAZ,EAAsB;AACpB;AACA;AACD;;AAED,YAAM5B,WAAW,GAAGwD,UAAU,CAACW,uBAAX,CAClBvC,OADkB,EAElB,KAAKtC,MAAL,CAAYC,KAAZ,CAAkByE,KAAlB,CAAwBI,SAFN,CAApB;AAKA,YAAMC,UAAU,GAAGjB,UAAU,CAACf,QAAX,CACjBT,OADiB,EAEjBpC,MAAM,CAAC8E,QAFU,EAGjB,IAAIlB,UAAJ,EAHiB,CAAnB;AAMA,YAAMmB,MAAM,GAAGC,gBAAgB,CAACC,WAAjB,CAA6BlF,KAA7B,EAAoC;AACjDmF,UAAAA,WAAW,EAAEpB,OAAO,CAACqB,eAAR,CACX3E,WADW,EAEX,IAAIoD,UAAJ,CAAe,GAAf,EAAoB,GAApB,EAAyBA,UAAU,CAACX,SAAX,CAAqB4B,UAArB,CAAzB,CAFW,EAGX,IAAIjB,UAAJ,EAHW,CADoC;AAMjDwB,UAAAA,SAAS,EAAEtB,OAAO,CAACuB,uBAAR,CACT7E,WADS,EAET,IAAIoD,UAAJ,CAAe,GAAf,EAAoB,GAApB,EAAyB,CAAC,GAA1B,CAFS,EAGT,IAAIA,UAAJ,EAHS,CANsC;AAWjD0B,UAAAA,EAAE,EAAExB,OAAO,CAACuB,uBAAR,CACF7E,WADE,EAEF,IAAIoD,UAAJ,CAAe,GAAf,EAAoB,GAApB,EAAyB,GAAzB,CAFE,EAGF,IAAIA,UAAJ,EAHE,CAX6C;AAgBjD2B,UAAAA,QAAQ,EAAE;AAhBuC,SAApC,CAAf;AAkBAxF,QAAAA,KAAK,CAACyF,MAAN,CAAaC,GAAb,CAAiBV,MAAjB;AACD;AACF,KArGM;AAsGPW,IAAAA,aAtGO,yBAsGQjE,KAtGR,EAsGe;AACpB,qBAAyC5B,MAAzC;AAAA,UAAQ6B,UAAR,YAAQA,UAAR;AAAA,UAA0BC,UAA1B,YAAoBC,IAApB;AACA,UAAMM,gBAAgB,GAAGT,KAAK,CAACQ,aAAN,CAAoBE,qBAApB,EAAzB;AACA,UAAMC,MAAM,GAAG,IAAIV,UAAJ,CACb,CAACQ,gBAAgB,CAACG,KAAjB,GAAyBH,gBAAgB,CAAC7C,IAA3C,IAAmD,GADtC,EAEb,CAAC6C,gBAAgB,CAACI,MAAjB,GAA0BJ,gBAAgB,CAAC5C,GAA5C,IAAmD,GAFtC,CAAf;AAIA,UAAMiD,aAAa,GACjBd,KAAK,CAACe,IAAN,KAAe,SAAf,GACI,IAAId,UAAJ,CAAeD,KAAK,CAACgB,OAAN,GAAgBP,gBAAgB,CAAC7C,IAAhD,EAAsDoC,KAAK,CAACiB,OAAN,GAAgBR,gBAAgB,CAAC5C,GAAvF,CADJ,GAEI,IAAIoC,UAAJ,CACAD,KAAK,CAACkB,cAAN,CAAqB,CAArB,EAAwBF,OAAxB,GAAkCP,gBAAgB,CAAC7C,IADnD,EAEAoC,KAAK,CAACkB,cAAN,CAAqB,CAArB,EAAwBD,OAAxB,GAAkCR,gBAAgB,CAAC5C,GAFnD,CAHN;AAOA,UAAMsD,MAAM,GAAGlB,UAAU,CAACmB,QAAX,CAAoBN,aAApB,EAAmCH,MAAnC,EAA2CU,aAA3C,CAAf;AACA,UAAMG,SAAS,GAAGvB,UAAU,CAACuB,SAAX,CAAqBL,MAArB,CAAlB;;AACA,UAAIK,SAAS,GAAG,EAAZ,IAAkBA,SAAS,GAAG,EAAlC,EAAsC;AACpC,YAAMG,KAAK,GAAGzB,UAAU,CAACgE,SAAX,CAAqB/D,IAAI,CAAC0B,KAAL,CAAW,CAACV,MAAM,CAACW,CAAnB,EAAsBX,MAAM,CAACY,CAA7B,CAArB,CAAd;AACA,YAAMT,kBAAkB,GAAG,IAAIrB,UAAJ,CAAeD,KAAK,CAACgB,OAArB,EAA8BhB,KAAK,CAACiB,OAApC,CAA3B;AACA,YAAMkD,EAAE,GAAG7C,kBAAkB,CAACS,CAAnB,GAAuB,KAAKT,kBAAL,CAAwBS,CAA1D;AACA,YAAMqC,EAAE,GAAG9C,kBAAkB,CAACQ,CAAnB,GAAuB,KAAKR,kBAAL,CAAwBQ,CAA1D;AACA,YAAMuC,QAAQ,GAAGlE,IAAI,CAACmE,IAAL,CAAUH,EAAE,GAAGA,EAAL,GAAUC,EAAE,GAAGA,EAAzB,CAAjB;;AACA,YAAIC,QAAQ,GAAG,CAAf,EAAkB;AAChB;AACD;;AACD,YAAM5G,OAAO,GAAGyC,UAAU,CAACgE,SAAX,CAAqB,KAAKzG,OAA1B,CAAhB;AACA,YAAM8G,CAAC,GAAGpE,IAAI,CAACqE,GAAL,CAAS7C,KAAK,GAAGlE,OAAjB,CAAV;AACA,YAAMa,KAAK,GAAG,KAAKD,MAAL,CAAYC,KAA1B;;AACA,YAAKqD,KAAK,GAAG,CAAR,IAAalE,OAAO,GAAG,CAAvB,IAA4BA,OAAO,GAAG,EAAtC,IAA4C8G,CAAC,GAAG,EAAhD,IAAsDA,CAAC,GAAG,GAA3D,IAAoEA,CAAC,GAAG,GAAJ,IAAWA,CAAC,GAAG,GAAvF,EAA6F;AAC3FjG,UAAAA,KAAK,CAACC,MAAN,CAAakG,KAAb,CAAmB;AACjBhB,YAAAA,WAAW,EAAEnF,KAAK,CAACC,MAAN,CAAa8E,QADT;AAEjBqB,YAAAA,WAAW,EAAE;AACXjH,cAAAA,OAAO,EAAE,CADE;AAEXkH,cAAAA,KAAK,EAAErG,KAAK,CAACC,MAAN,CAAaoG;AAFT;AAFI,WAAnB;AAOD;AACF;AACF;AA5IM,GAhDI;AA8LbC,EAAAA,SA9La,uBA8LA;AACX,SAAKpG,uBAAL,IAAgC,KAAKA,uBAAL,CAA6BqG,OAA7B,EAAhC;AACD;AAhMY,CAAf;AAkMA,IAAMxD,aAAa,GAAG,EAAtB;AACA,IAAMyD,mBAAmB,GAAG,EAA5B;AACA,IAAMC,mBAAmB,GAAG,EAA5B;AACA,IAAM9B,aAAa,GAAG,EAAtB;AAEA,IAAM+B,SAAS,GAAG,CAChB;AACEjD,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CADgB,EAKhB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CALgB,EAShB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CATgB,EAahB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAbgB,EAiBhB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAjBgB,EAqBhB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CArBgB,EAyBhB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAzBgB,EA6BhB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CA7BgB,EAiChB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAjCgB,EAqChB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CArCgB,EAyChB;AACEC,EAAAA,CAAC,EAAE,EADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAzCgB,EA6ChB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CA7CgB,EAiDhB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAjDgB,EAqDhB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CArDgB,EAyDhB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAzDgB,EA6DhB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CA7DgB,EAiEhB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAjEgB,EAqEhB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CArEgB,EAyEhB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CAzEgB,EA6EhB;AACEC,EAAAA,CAAC,EAAE,GADL;AAEED,EAAAA,CAAC,EAAE;AAFL,CA7EgB,CAAlB;;AAmFA,SAASL,MAAT,CAAiBwD,SAAjB,EAA4B1E,cAA5B,EAA4C2E,YAA5C,EAA0D;AACxD,MAAI,CAACD,SAAS,CAAC7H,sBAAf,EAAuC;AACrC;AACD;;AAED,iBAAwFgB,MAAxF;AAAA,MAAQ6B,UAAR,YAAQA,UAAR;AAAA,MAAoBkC,UAApB,YAAoBA,UAApB;AAAA,MAAgCC,OAAhC,YAAgCA,OAAhC;AAAA,MAA+ClC,UAA/C,YAAyCC,IAAzC;AAAA,MAA2DkC,OAA3D,YAA2DA,OAA3D;AAAA,MAAoEC,GAApE,YAAoEA,GAApE;AAAA,MAAyEC,UAAzE,YAAyEA,UAAzE,CALwD;;AAOxD7C,EAAAA,QAAQ,CAACyF,mBAAT,CAA6B,WAA7B,EAA0CF,SAAS,CAACjG,uBAApD,EAA6E,KAA7E;AACAU,EAAAA,QAAQ,CAACyF,mBAAT,CAA6B,WAA7B,EAA0CF,SAAS,CAACjG,uBAApD,EAA6E,KAA7E;AACAU,EAAAA,QAAQ,CAACyF,mBAAT,CAA6B,SAA7B,EAAwCF,SAAS,CAAChG,qBAAlD,EAAyE,KAAzE;AACAS,EAAAA,QAAQ,CAACyF,mBAAT,CAA6B,UAA7B,EAAyCF,SAAS,CAAChG,qBAAnD,EAA0E,KAA1E;AACAgG,EAAAA,SAAS,CAACjG,uBAAV,GAAoCF,SAApC;AACAmG,EAAAA,SAAS,CAAChG,qBAAV,GAAkCH,SAAlC;AACAmG,EAAAA,SAAS,CAACrG,UAAV,GAAuB,IAAvB;AACAqG,EAAAA,SAAS,CAACpG,wBAAV,GAAqCsB,IAAI,CAAC0B,KAAL,CAAW,CAACqD,YAAY,CAACpD,CAAzB,EAA4BoD,YAAY,CAACnD,CAAzC,CAArC;AACA,MAAMzD,KAAK,GAAG2G,SAAS,CAAC5G,MAAV,CAAiBC,KAA/B;AACA,MAAIC,MAAM,GAAGD,KAAK,CAACC,MAAnB;AACA,MAAMiE,cAAc,GAAG,IAAIvC,UAAJ,EAAvB;AACAuC,EAAAA,cAAc,CAACT,CAAf,GAAmBzD,KAAK,CAACmE,MAAN,CAAaC,WAAb,GAA2B,CAA9C;AACAF,EAAAA,cAAc,CAACV,CAAf,GAAmBxD,KAAK,CAACmE,MAAN,CAAaE,YAAb,GAA4B,CAA/C;AACA,MAAMC,cAAc,GAAG,IAAIN,GAAJ,EAAvB;AACA,MAAMO,GAAG,GAAGtE,MAAM,CAACuE,UAAP,CAAkBN,cAAlB,EAAkCI,cAAlC,CAAZ;AACA,MAAMwC,UAAU,GAAG9G,KAAK,CAACyE,KAAN,CAAYC,IAAZ,CAAiBH,GAAjB,EAAsBvE,KAAtB,EAA6B2E,aAA7B,CAAnB;;AAEA,MAAI,CAACb,OAAO,CAACgD,UAAD,CAAZ,EAA0B;AACxBH,IAAAA,SAAS,CAAClG,WAAV,GAAwBwD,UAAU,CAACW,uBAAX,CAAmC3E,MAAM,CAAC8G,UAA1C,EAAsDJ,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuByE,KAAvB,CAA6BI,SAAnF,EAA8F4B,mBAA9F,CAAxB;AACAE,IAAAA,SAAS,CAACK,YAAV,GAAyB,IAAzB;AACD,GAHD,MAGO;AACLL,IAAAA,SAAS,CAAClG,WAAV,GAAwBwD,UAAU,CAACW,uBAAX,CAAmCkC,UAAnC,EAA+CH,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuByE,KAAvB,CAA6BI,SAA5E,EAAuF4B,mBAAvF,CAAxB;AACAE,IAAAA,SAAS,CAACK,YAAV,GAAyB,KAAzB;AACD;;AAED,MAAIC,YAAY,GAAGlD,OAAO,CAACmD,KAAR,CAAcjH,MAAM,CAACR,SAArB,EAAgC+G,mBAAhC,CAAnB;AACAvG,EAAAA,MAAM,CAACkH,eAAP,CAAuBR,SAAS,CAAClG,WAAjC;AACAkG,EAAAA,SAAS,CAACS,wBAAV,GAAqCvF,IAAI,CAAC0B,KAAL,CAAWtD,MAAM,CAAC8E,QAAP,CAAgBvB,CAA3B,EAA8BvD,MAAM,CAAC8E,QAAP,CAAgBtB,CAA9C,CAArC;AACAkD,EAAAA,SAAS,CAACU,2BAAV,GAAwCxD,UAAU,CAACX,SAAX,CAAqB,IAAIW,UAAJ,CAAe5D,MAAM,CAAC8E,QAAP,CAAgBtB,CAA/B,EAAkCxD,MAAM,CAAC8E,QAAP,CAAgBvB,CAAlD,EAAqD,GAArD,CAArB,CAAxC;AACAvD,EAAAA,MAAM,CAACkH,eAAP,CAAuBF,YAAvB;;AACAN,EAAAA,SAAS,CAACjG,uBAAV,GAAoC,UAACgB,KAAD,EAAW;AAC7C,QAAMS,gBAAgB,GAAGF,cAAc,CAACG,qBAAf,EAAzB;AACA,QAAMC,MAAM,GAAG,IAAIV,UAAJ,CACb,CAACQ,gBAAgB,CAACG,KAAjB,GAAyBH,gBAAgB,CAAC7C,IAA3C,IAAmD,GADtC,EAEb,CAAC6C,gBAAgB,CAACI,MAAjB,GAA0BJ,gBAAgB,CAAC5C,GAA5C,IAAmD,GAFtC,CAAf;AAIA,QAAMiD,aAAa,GACjBd,KAAK,CAACe,IAAN,KAAe,WAAf,IAA8Bf,KAAK,CAACe,IAAN,KAAe,WAA7C,GACI,IAAId,UAAJ,CAAeD,KAAK,CAACgB,OAAN,GAAgBP,gBAAgB,CAAC7C,IAAhD,EAAsDoC,KAAK,CAACiB,OAAN,GAAgBR,gBAAgB,CAAC5C,GAAvF,CADJ,GAEI,IAAIoC,UAAJ,CACAD,KAAK,CAACkB,cAAN,CAAqB,CAArB,EAAwBF,OAAxB,GAAkCP,gBAAgB,CAAC7C,IADnD,EAEAoC,KAAK,CAACkB,cAAN,CAAqB,CAArB,EAAwBD,OAAxB,GAAkCR,gBAAgB,CAAC5C,GAFnD,CAHN;AAOA,QAAMsD,MAAM,GAAGlB,UAAU,CAACmB,QAAX,CAAoBN,aAApB,EAAmCH,MAAnC,EAA2CU,aAA3C,CAAf;AACA,QAAMM,KAAK,GAAGxB,IAAI,CAAC0B,KAAL,CAAW,CAACV,MAAM,CAACW,CAAnB,EAAsBX,MAAM,CAACY,CAA7B,CAAd;AACA,QAAM6D,eAAe,GAAGjE,KAAK,GAAGsD,SAAS,CAACpG,wBAA1C;AACA,QAAMgH,cAAc,GAAG3F,UAAU,CAAC4F,WAAX,CAAuBb,SAAS,CAACS,wBAAV,GAAqCE,eAA5D,CAAvB;AACArH,IAAAA,MAAM,GAAG0G,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuBC,MAAhC;AAEAgH,IAAAA,YAAY,GAAGlD,OAAO,CAACmD,KAAR,CAAcjH,MAAM,CAACR,SAArB,EAAgC+G,mBAAhC,CAAf;AACAvG,IAAAA,MAAM,CAACkH,eAAP,CAAuBR,SAAS,CAAClG,WAAjC;AACA,QAAMgH,kBAAkB,GAAG5F,IAAI,CAAC0B,KAAL,CAAWtD,MAAM,CAAC8E,QAAP,CAAgBvB,CAA3B,EAA8BvD,MAAM,CAAC8E,QAAP,CAAgBtB,CAA9C,CAA3B;AACAxD,IAAAA,MAAM,CAACyH,WAAP,CAAmBH,cAAc,GAAGE,kBAApC;AACAxH,IAAAA,MAAM,CAACkH,eAAP,CAAuBF,YAAvB;AACD,GAxBD;;AA0BAN,EAAAA,SAAS,CAAChG,qBAAV,GAAkC,YAAM;AACtCgG,IAAAA,SAAS,CAACrG,UAAV,GAAuB,KAAvB;AACAc,IAAAA,QAAQ,CAACyF,mBAAT,CAA6B,WAA7B,EAA0CF,SAAS,CAACjG,uBAApD,EAA6E,KAA7E;AACAU,IAAAA,QAAQ,CAACyF,mBAAT,CAA6B,WAA7B,EAA0CF,SAAS,CAACjG,uBAApD,EAA6E,KAA7E;AACAU,IAAAA,QAAQ,CAACyF,mBAAT,CAA6B,SAA7B,EAAwCF,SAAS,CAAChG,qBAAlD,EAAyE,KAAzE;AACAS,IAAAA,QAAQ,CAACyF,mBAAT,CAA6B,UAA7B,EAAyCF,SAAS,CAAChG,qBAAnD,EAA0E,KAA1E;AAEAgG,IAAAA,SAAS,CAACjG,uBAAV,GAAoCF,SAApC;AACAmG,IAAAA,SAAS,CAAChG,qBAAV,GAAkCH,SAAlC;AACD,GATD;;AAWAY,EAAAA,QAAQ,CAACuG,gBAAT,CAA0B,WAA1B,EAAuChB,SAAS,CAACjG,uBAAjD,EAA0E,KAA1E;AACAU,EAAAA,QAAQ,CAACuG,gBAAT,CAA0B,WAA1B,EAAuChB,SAAS,CAACjG,uBAAjD,EAA0E,KAA1E;AACAU,EAAAA,QAAQ,CAACuG,gBAAT,CAA0B,SAA1B,EAAqChB,SAAS,CAAChG,qBAA/C,EAAsE,KAAtE;AACAS,EAAAA,QAAQ,CAACuG,gBAAT,CAA0B,UAA1B,EAAsChB,SAAS,CAAChG,qBAAhD,EAAuE,KAAvE;AACD;;AAED,SAASyC,UAAT,CAAqBuD,SAArB,EAAgC1E,cAAhC,EAAgD2E,YAAhD,EAA8D;AAC5D,iBAA0E9G,MAA1E;AAAA,MAAQgE,OAAR,YAAQA,OAAR;AAAA,MAAiB8D,YAAjB,YAAiBA,YAAjB;AAAA,MAAqChG,UAArC,YAA+BC,IAA/B;AAAA,MAAiDgG,oBAAjD,YAAiDA,oBAAjD;AACAlB,EAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACE,OAAzE;AACAjE,EAAAA,OAAO,CAAC6C,SAAS,CAACqB,sBAAX,CAAP,IAA6CrB,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BrB,mBAA9B,CAAkDF,SAAS,CAACqB,sBAA5D,CAA7C;AACArB,EAAAA,SAAS,CAACwB,yBAAV,GAAsC3H,SAAtC;AACAmG,EAAAA,SAAS,CAACqB,sBAAV,GAAmCxH,SAAnC;AACAmG,EAAAA,SAAS,CAACyB,eAAV,GAA4B,IAA5B;AACAzB,EAAAA,SAAS,CAAC0B,uBAAV,GAAoCT,YAAY,EAAhD;AACA,MAAIvE,KAAK,GAAGzB,UAAU,CAAC0B,WAAX,GAAyBzB,IAAI,CAAC0B,KAAL,CAAW,CAACqD,YAAY,CAACpD,CAAzB,EAA4BoD,YAAY,CAACnD,CAAzC,CAArC;AACA,MAAM6E,CAAC,GAAGzG,IAAI,CAAC0G,EAAL,GAAU,CAApB;AACA,MAAIC,cAAc,GAAG,CAArB;AACA,MAAMC,SAAS,GAAG;AAChBC,IAAAA,IAAI,EAAE,CADU;AAEhBC,IAAAA,KAAK,EAAE,CAFS;AAGhBC,IAAAA,EAAE,EAAE,CAHY;AAIhBC,IAAAA,IAAI,EAAE;AAJU,GAAlB;AAMAL,EAAAA,cAAc,GAAGnF,KAAK,IAAI,CAACiF,CAAV,IAAeA,CAAC,IAAIjF,KAApB,GACboF,SAAS,CAACI,IADG,GAEbxF,KAAK,IAAIiF,CAAT,IAAc,IAAIA,CAAJ,IAASjF,KAAvB,GACEoF,SAAS,CAACE,KADZ,GAEEtF,KAAK,IAAI,IAAIiF,CAAb,IAAkB,IAAIA,CAAJ,IAASjF,KAA3B,GAAmCoF,SAAS,CAACG,EAA7C,GAAkDH,SAAS,CAACC,IAJlE;;AAKA/B,EAAAA,SAAS,CAACqB,sBAAV,GAAmC,YAAM;AACvC,QAAMhI,KAAK,GAAG2G,SAAS,CAAC5G,MAAV,CAAiBC,KAA/B;AACA,QAAMC,MAAM,GAAGD,KAAK,CAACC,MAArB;AACA,QAAM6I,SAAS,GAAGlB,YAAY,EAA9B;AACAvE,IAAAA,KAAK,GAAG,KAAKxB,IAAI,CAACqE,GAAL,CAASjG,MAAM,CAAC8I,oBAAP,CAA4BC,MAA5B,GAAqC,OAA9C,CAAL,GAA8D,MAAtE;;AACA,YAAQR,cAAR;AACE,WAAKC,SAAS,CAACC,IAAf;AACEzI,QAAAA,MAAM,CAACgJ,UAAP,CAAkB5F,KAAlB;AACA;;AACF,WAAKoF,SAAS,CAACE,KAAf;AACE1I,QAAAA,MAAM,CAACyH,WAAP,CAAmBrE,KAAnB;AACA;;AACF,WAAKoF,SAAS,CAACG,EAAf;AACE3I,QAAAA,MAAM,CAACkD,MAAP,CAAclD,MAAM,CAACqC,KAArB,EAA4B,CAACe,KAA7B;AACA;;AACF,WAAKoF,SAAS,CAACI,IAAf;AACE5I,QAAAA,MAAM,CAACkD,MAAP,CAAclD,MAAM,CAACqC,KAArB,EAA4Be,KAA5B;AAXJ;;AAaAsD,IAAAA,SAAS,CAAC0B,uBAAV,GAAoCS,SAApC;AACD,GAnBD;;AAoBAnC,EAAAA,SAAS,CAACwB,yBAAV,GAAsC,YAAM;AAC1CxB,IAAAA,SAAS,CAACuC,eAAV,GAA4B,KAA5B;AACAvC,IAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACE,OAAzE;AACAjE,IAAAA,OAAO,CAAC6C,SAAS,CAACqB,sBAAX,CAAP,IACErB,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BrB,mBAA9B,CAAkDF,SAAS,CAACqB,sBAA5D,CADF;AAEArB,IAAAA,SAAS,CAACwB,yBAAV,GAAsC3H,SAAtC;AACAmG,IAAAA,SAAS,CAACqB,sBAAV,GAAmCxH,SAAnC;AACD,GAPD;;AASAmG,EAAAA,SAAS,CAACzG,uBAAV,CAAkCiJ,cAAlC,CAAiDxC,SAAS,CAACwB,yBAA3D,EAAsFN,oBAAoB,CAACE,OAA3G;AACApB,EAAAA,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BP,gBAA9B,CAA+ChB,SAAS,CAACqB,sBAAzD;AACD;;AACD,SAAStE,IAAT,CAAeiD,SAAf,EAA0B1E,cAA1B,EAA0C2E,YAA1C,EAAwD;AACtD,iBAA6F9G,MAA7F;AAAA,MAAQ6B,UAAR,YAAQA,UAAR;AAAA,MAAoBmC,OAApB,YAAoBA,OAApB;AAAA,MAAmClC,UAAnC,YAA6BC,IAA7B;AAAA,MAA+CkC,OAA/C,YAA+CA,OAA/C;AAAA,MAAwD8D,oBAAxD,YAAwDA,oBAAxD;AAAA,MAA8E5D,UAA9E,YAA8EA,UAA9E,CADsD;;AAGtD0C,EAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACuB,UAAzE;AACAzC,EAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACE,OAAzE;AACApB,EAAAA,SAAS,CAAC0C,qBAAV,GAAkC7I,SAAlC;AACAmG,EAAAA,SAAS,CAAC2C,mBAAV,GAAgC9I,SAAhC;AACA,MAAIM,sBAAsB,GAAGc,UAAU,CAAC0B,WAAX,GAAyBzB,IAAI,CAAC0B,KAAL,CAAW,CAACqD,YAAY,CAACpD,CAAzB,EAA4BoD,YAAY,CAACnD,CAAzC,CAAtD;AACA3C,EAAAA,sBAAsB,GAAGA,sBAAsB,GAAG,CAAzB,GAA6B,CAA7B,GAAiCA,sBAA1D;AACAA,EAAAA,sBAAsB,GAAGA,sBAAsB,GAAGc,UAAU,CAAC0B,WAApC,GAAkD1B,UAAU,CAAC0B,WAA7D,GAA2ExC,sBAApG;AACA6F,EAAAA,SAAS,CAAC7F,sBAAV,GAAmCA,sBAAnC;AACA6F,EAAAA,SAAS,CAAC9F,SAAV,GAAsB,IAAtB;AACA,MAAMb,KAAK,GAAG2G,SAAS,CAAC5G,MAAV,CAAiBC,KAA/B;AACA,MAAMC,MAAM,GAAGD,KAAK,CAACC,MAArB;AACA,MAAMiE,cAAc,GAAG,IAAIvC,UAAJ,EAAvB;AACAuC,EAAAA,cAAc,CAACT,CAAf,GAAmBzD,KAAK,CAACmE,MAAN,CAAaC,WAAb,GAA2B,CAA9C;AACAF,EAAAA,cAAc,CAACV,CAAf,GAAmBxD,KAAK,CAACmE,MAAN,CAAaE,YAAb,GAA4B,CAA/C;AACA,MAAIkF,YAAY,GAAGtJ,MAAM,CAACuJ,aAAP,CAAqBtF,cAArB,EAAqClE,KAAK,CAACyE,KAAN,CAAYI,SAAjD,CAAnB;;AACA,MAAI,CAACf,OAAO,CAACyF,YAAD,CAAZ,EAA4B;AAC1B,WAAOrF,cAAc,CAACV,CAAf,GAAmBxD,KAAK,CAACmE,MAAN,CAAaE,YAAvC,GAAsD;AACpDH,MAAAA,cAAc,CAACV,CAAf,IAAoB,CAApB;AACA+F,MAAAA,YAAY,GAAGtJ,MAAM,CAACuJ,aAAP,CAAqBtF,cAArB,EAAqClE,KAAK,CAACyE,KAAN,CAAYI,SAAjD,CAAf;AACD;AACF;;AAEDf,EAAAA,OAAO,CAACyF,YAAD,CAAP,KAA0B5C,SAAS,CAAC8C,SAAV,GAAsBxF,UAAU,CAACW,uBAAX,CAAmC2E,YAAnC,EAAiDvJ,KAAK,CAACyE,KAAN,CAAYI,SAA7D,CAAhD;;AACA8B,EAAAA,SAAS,CAAC0C,qBAAV,GAAkC,UAACzF,CAAD,EAAI8F,CAAJ,EAAU;AAC1C/C,IAAAA,SAAS,CAAC9F,SAAV,GAAsB,IAAtB;AACA,QAAMsB,gBAAgB,GAAGF,cAAc,CAACG,qBAAf,EAAzB;AACA,QAAMC,MAAM,GAAG,IAAIvC,MAAM,CAAC6B,UAAX,CACb,CAACQ,gBAAgB,CAACG,KAAjB,GAAyBH,gBAAgB,CAAC7C,IAA3C,IAAmD,GADtC,EAEb,CAAC6C,gBAAgB,CAACI,MAAjB,GAA0BJ,gBAAgB,CAAC5C,GAA5C,IAAmD,GAFtC,CAAf;AAIA,QAAMoK,WAAW,GAAGhI,UAAU,CAACuF,KAAX,CAAiBtD,CAAC,CAAC+F,WAAnB,CAApB;AACA,QAAM9G,MAAM,GAAGlB,UAAU,CAACmB,QAAX,CAAoB6G,WAApB,EAAiCtH,MAAjC,EAAyCU,aAAzC,CAAf;AACA,QAAIM,KAAK,GAAGzB,UAAU,CAAC0B,WAAX,GAAyBzB,IAAI,CAAC0B,KAAL,CAAW,CAACV,MAAM,CAACW,CAAnB,EAAsBX,MAAM,CAACY,CAA7B,CAArC;AACAJ,IAAAA,KAAK,GAAGA,KAAK,GAAG,CAAR,GAAY,CAAZ,GAAgBA,KAAxB;AACAA,IAAAA,KAAK,GAAGA,KAAK,GAAGzB,UAAU,CAAC0B,WAAnB,GAAiC1B,UAAU,CAAC0B,WAA5C,GAA0DD,KAAlE;AACA,QAAMpD,MAAM,GAAG0G,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuBC,MAAtC;AACA,QAAMgH,YAAY,GAAGlD,OAAO,CAACmD,KAAR,CAAcjH,MAAM,CAACR,SAArB,EAAgC+G,mBAAhC,CAArB;AACAvG,IAAAA,MAAM,CAACkH,eAAP,CAAuBR,SAAS,CAAC8C,SAAjC;AACA,QAAMG,aAAa,GAAGvG,KAAK,GAAGsD,SAAS,CAAC7F,sBAAxC;AACAb,IAAAA,MAAM,CAAC4J,QAAP,CAAgBD,aAAhB;AACAjD,IAAAA,SAAS,CAAC7F,sBAAV,GAAmCuC,KAAnC;AACApD,IAAAA,MAAM,CAACkH,eAAP,CAAuBF,YAAvB;AACA,QAAI6C,KAAK,GAAGjI,IAAI,CAACkI,IAAL,CAAU1G,KAAK,IAAIxB,IAAI,CAAC0G,EAAL,GAAU,EAAd,CAAf,CAAZ;AACAuB,IAAAA,KAAK,GAAGA,KAAK,GAAG,EAAR,GAAa,EAAb,GAAkBA,KAA1B;AACA,QAAM/E,QAAQ,GAAG2B,SAAS,CAACoD,KAAD,CAA1B;AACAnD,IAAAA,SAAS,CAAC1H,WAAV,GAAwB8F,QAAQ,CAACtB,CAAjC;AACAkD,IAAAA,SAAS,CAACzH,UAAV,GAAuB6F,QAAQ,CAACvB,CAAhC;AACD,GAxBD;;AA0BAmD,EAAAA,SAAS,CAAC2C,mBAAV,GAAgC,UAAU1F,CAAV,EAAa;AAC3C+C,IAAAA,SAAS,CAAC9F,SAAV,GAAsB,KAAtB;AACA8F,IAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACuB,UAAzE;AACAzC,IAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACE,OAAzE;AACApB,IAAAA,SAAS,CAAC0C,qBAAV,GAAkC7I,SAAlC;AACAmG,IAAAA,SAAS,CAAC2C,mBAAV,GAAgC9I,SAAhC;AACD,GAND;;AAQAmG,EAAAA,SAAS,CAACzG,uBAAV,CAAkCiJ,cAAlC,CAAiDxC,SAAS,CAAC0C,qBAA3D,EAAkFxB,oBAAoB,CAACuB,UAAvG;AACAzC,EAAAA,SAAS,CAACzG,uBAAV,CAAkCiJ,cAAlC,CAAiDxC,SAAS,CAAC2C,mBAA3D,EAAgFzB,oBAAoB,CAACE,OAArG;AACD;;AAED,SAAShH,kBAAT,GAA+B;AAC7B,iBAA6BjB,MAA7B;AAAA,MAAc8B,UAAd,YAAQC,IAAR;AACA,MAAMwE,KAAK,GAAGzE,UAAU,CAAC0B,WAAX,GAAyB,KAAKvD,MAAL,CAAYC,KAAZ,CAAkBC,MAAlB,CAAyBoG,KAAhE;AACA,MAAM2D,MAAM,GAAGnI,IAAI,CAAC0G,EAAL,GAAU,CAAV,GAAc,EAA7B;AACA,MAAIuB,KAAK,GAAGjI,IAAI,CAACoI,KAAL,CAAW5D,KAAK,GAAG2D,MAAnB,CAAZ;AACAF,EAAAA,KAAK,GAAGA,KAAK,GAAG,EAAR,GAAa,EAAb,GAAkBA,KAA1B;AACAA,EAAAA,KAAK,GAAGA,KAAK,GAAG,CAAR,GAAY,CAAZ,GAAgBA,KAAxB;AACA,OAAK7K,WAAL,GAAmByH,SAAS,CAACoD,KAAD,CAAT,CAAiBrG,CAApC;AACA,OAAKvE,UAAL,GAAkBwH,SAAS,CAACoD,KAAD,CAAT,CAAiBtG,CAAnC;AACD;;AAED,SAASvC,YAAT,CAAuB0F,SAAvB,EAAkC;AAChC,iBAAsC7G,MAAtC;AAAA,MAAQgE,OAAR,YAAQA,OAAR;AAAA,MAAuBlC,UAAvB,YAAiBC,IAAjB;;AACA,MAAIiC,OAAO,CAAC6C,SAAS,CAAC5G,MAAX,CAAX,EAA+B;AAC7B,QAAI4G,SAAS,CAAC/F,yBAAd,EAAyC;AACvC+F,MAAAA,SAAS,CAAC/F,yBAAV;;AACA+F,MAAAA,SAAS,CAAC/F,yBAAV,GAAsCJ,SAAtC;AACD;;AACDmG,IAAAA,SAAS,CAAC/F,yBAAV,GAAsC+F,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuBkK,UAAvB,CAAkCvC,gBAAlC,CAAmD,YAAM;AAC7FhB,MAAAA,SAAS,CAACxH,OAAV,GAAoBwH,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuBC,MAAvB,CAA8Bd,OAAlD;;AACA,UAAI,CAACwH,SAAS,CAAC9F,SAAf,EAA0B;AACxB,YAAMwC,KAAK,GAAGsD,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuBC,MAAvB,CAA8BoG,KAA9B,GAAsCzE,UAAU,CAAC0B,WAA/D;AACA,YAAM0G,MAAM,GAAGpI,UAAU,CAAC0B,WAAX,GAAyB,EAAxC;AACA,YAAIwG,KAAK,GAAGjI,IAAI,CAACoI,KAAL,CAAW5G,KAAK,GAAG2G,MAAnB,CAAZ;AACAF,QAAAA,KAAK,GAAGA,KAAK,GAAG,EAAR,GAAa,EAAb,GAAkBA,KAA1B;AACAA,QAAAA,KAAK,GAAGA,KAAK,GAAG,CAAR,GAAY,CAAZ,GAAgBA,KAAxB;AACAnD,QAAAA,SAAS,CAAC1H,WAAV,GAAwByH,SAAS,CAACoD,KAAD,CAAT,CAAiBrG,CAAzC;AACAkD,QAAAA,SAAS,CAACzH,UAAV,GAAuBwH,SAAS,CAACoD,KAAD,CAAT,CAAiBtG,CAAxC;AACD;AACF,KAXqC,CAAtC;AAYD,GAjBD,MAiBO;AACL,QAAImD,SAAS,CAAC/F,yBAAd,EAAyC;AACvC+F,MAAAA,SAAS,CAAC/F,yBAAV;;AACA+F,MAAAA,SAAS,CAAC/F,yBAAV,GAAsCJ,SAAtC;AACD;AACF;AACF;;;ACzhBW,2BAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHZ;AACA,AAwBA,eAAe;AACbxB,EAAAA,IADa,kBACL;AACN,WAAO;AACLmL,MAAAA,UAAU,EAAE;AADP,KAAP;AAGD,GALY;AAMb/K,EAAAA,QAAQ,EAAE;AACRgL,IAAAA,YAAY,EAAE,wBAAY;AACxB,aAAO;AACL7K,QAAAA,GAAG,EAAE,KAAK4K,UAAL,GAAkB;AADlB,OAAP;AAGD;AALO,GANG;AAabzK,EAAAA,OAba,qBAaF;AAAA;;AACT,SAAKC,OAAL,CAAaC,aAAb,CAA2BC,IAA3B,CAAgC,gBAAwB;AAAA,UAArBC,MAAqB,QAArBA,MAAqB;AAAA,UAAbC,MAAa,QAAbA,MAAa;AACtD,MAAA,KAAI,CAACA,MAAL,GAAcA,MAAd;AACA,MAAA,KAAI,CAACsK,SAAL,GAAiB,KAAI,CAAC1K,OAAL,CAAaS,KAAb,CAAmBC,mBAApC;AACA,MAAA,KAAI,CAACH,uBAAL,GAA+B,IAAIJ,MAAM,CAACK,uBAAX,CAAmC,KAAI,CAACkK,SAAxC,CAA/B;AACAnJ,MAAAA,QAAQ,GAAGC,IAAX,KAAoBC,QAAQ,CAACC,aAAT,CAAuB,UAAvB,EAAmCC,KAAnC,CAAyCC,UAAzC,GAAsD,SAA1E;AACD,KALD;AAMD,GApBY;AAqBbC,EAAAA,OAAO,EAAE;AACP8I,IAAAA,4BADO,wCACuB5I,KADvB,EACgD;AAAA,UAAlBiF,SAAkB,uEAAN,IAAM;AACrD,oBAA2C7G,MAA3C;AAAA,UAAQ6B,UAAR,WAAQA,UAAR;AAAA,UAAoBmC,OAApB,WAAoBA,OAApB;AAAA,UAA6BhC,SAA7B,WAA6BA,SAA7B;AACAV,MAAAA,QAAQ,CAACyF,mBAAT,CAA6B,WAA7B,EAA0CF,SAAS,CAAC4D,8BAApD,EAAoF,KAApF;AACAnJ,MAAAA,QAAQ,CAACyF,mBAAT,CAA6B,WAA7B,EAA0CF,SAAS,CAAC4D,8BAApD,EAAoF,KAApF;AACAnJ,MAAAA,QAAQ,CAACyF,mBAAT,CAA6B,SAA7B,EAAwCF,SAAS,CAAC6D,4BAAlD,EAAgF,KAAhF;AACApJ,MAAAA,QAAQ,CAACyF,mBAAT,CAA6B,UAA7B,EAAyCF,SAAS,CAAC6D,4BAAnD,EAAiF,KAAjF;AACA1G,MAAAA,OAAO,CAAC6C,SAAS,CAAC8D,mBAAX,CAAP,IAA0C9D,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BrB,mBAA9B,CAAkDF,SAAS,CAAC8D,mBAA5D,CAA1C;AACA9D,MAAAA,SAAS,CAAC6D,4BAAV,GAAyChK,SAAzC;AACAmG,MAAAA,SAAS,CAAC8D,mBAAV,GAAgCjK,SAAhC;AACAmG,MAAAA,SAAS,CAAC+D,kBAAV,GAA+B,IAA/B;AACA,UAAM1K,KAAK,GAAG2G,SAAS,CAAC5G,MAAV,CAAiBC,KAA/B;AACA,UAAMC,MAAM,GAAGD,KAAK,CAACC,MAArB;;AAEA0G,MAAAA,SAAS,CAAC8D,mBAAV,GAAgC,YAAM;AACpC,YAAME,UAAU,GAAGhE,SAAS,CAACwD,UAAV,GAAuB,EAA1C;;AACA,YAAIQ,UAAU,GAAG,CAAjB,EAAoB;AAClB,cAAIhE,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuB+B,IAAvB,KAAgCD,SAAS,CAAC8I,aAA9C,EAA6D;AAC3D3K,YAAAA,MAAM,CAAC4K,OAAP;AACD,WAFD,MAEO;AACLC,YAAAA,UAAU,CAACnE,SAAD,EAAY,CAAC,CAAb,CAAV;AACD;AACF,SAND,MAMO,IAAIgE,UAAU,GAAG,CAAjB,EAAoB;AACzB,cAAIhE,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuB+B,IAAvB,KAAgCD,SAAS,CAAC8I,aAA9C,EAA6D;AAC3D3K,YAAAA,MAAM,CAAC8K,MAAP;AACD,WAFD,MAEO;AACLD,YAAAA,UAAU,CAACnE,SAAD,EAAY,CAAZ,CAAV;AACD;AACF;AACF,OAfD;;AAgBAA,MAAAA,SAAS,CAAC4D,8BAAV,GAA2C,UAAA3G,CAAC,EAAI;AAC9C,YAAMuG,UAAU,GAAGxD,SAAS,CAACwD,UAA7B;AACA,YAAMa,UAAU,GAAGpH,CAAC,CAACqH,MAAF,CAASC,aAAT,CAAuB9I,qBAAvB,EAAnB;AACA,YAAM+I,cAAc,GAAGxE,SAAS,CAAC0D,SAAV,CAAoBjI,qBAApB,EAAvB;AACA,YAAMuH,WAAW,GAAG,EAApB;AACAA,QAAAA,WAAW,CAAClG,CAAZ,GAAgBG,CAAC,CAACnB,IAAF,KAAW,WAAX,GAAyBmB,CAAC,CAAChB,cAAF,CAAiB,CAAjB,EAAoBF,OAApB,GAA8ByI,cAAc,CAAC7L,IAAtE,GAA6EsE,CAAC,CAAClB,OAAF,GAAYyI,cAAc,CAAC7L,IAAxH;AACAqK,QAAAA,WAAW,CAACnG,CAAZ,GAAgBI,CAAC,CAACnB,IAAF,KAAW,WAAX,GAAyBmB,CAAC,CAAChB,cAAF,CAAiB,CAAjB,EAAoBD,OAApB,GAA8BwI,cAAc,CAAC5L,GAAtE,GAA4EqE,CAAC,CAACjB,OAAF,GAAYwI,cAAc,CAAC5L,GAAvH,CAN8C;;AAQ9C,YAAM6L,UAAU,GAAGzE,SAAS,CAAC5G,MAAV,CAAiBsL,QAAjB,CAA0BjJ,qBAA1B,EAAnB;;AACA,YAAMkJ,OAAO,GAAG,IAAI3J,UAAJ,CAAegI,WAAW,CAAClG,CAAZ,GAAgBuH,UAAU,CAAC1L,IAA1C,EAAgDqK,WAAW,CAACnG,CAAZ,GAAgBwH,UAAU,CAACzL,GAA3B,GAAiC6L,UAAU,CAAC7L,GAA5F,CAAhB;AACA,YAAIgM,MAAM,GAAGD,OAAO,CAAC9H,CAAR,GAAY,EAAzB;AACA+H,QAAAA,MAAM,GAAGA,MAAM,GAAG,CAAT,GAAa,CAAb,GAAiBA,MAA1B;AACAA,QAAAA,MAAM,GAAGA,MAAM,GAAG,GAAT,GAAe,GAAf,GAAqBA,MAA9B;AACA5E,QAAAA,SAAS,CAACwD,UAAV,GAAuBoB,MAAvB;AAEA,YAAMC,QAAQ,GAAG7E,SAAS,CAACwD,UAAV,GAAuBA,UAAxC;;AACA,YAAIqB,QAAQ,GAAG,CAAf,EAAkB;AAChB,cAAI7E,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuB+B,IAAvB,KAAgCD,SAAS,CAAC8I,aAA9C,EAA6D;AAC3D3K,YAAAA,MAAM,CAAC4K,OAAP;AACD,WAFD,MAEO;AACLC,YAAAA,UAAU,CAACnE,SAAD,EAAY,CAAC,CAAb,CAAV;AACD;AACF,SAND,MAMO;AACL,cAAIA,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuB+B,IAAvB,KAAgCD,SAAS,CAAC8I,aAA9C,EAA6D;AAC3D3K,YAAAA,MAAM,CAAC8K,MAAP;AACD,WAFD,MAEO;AACLD,YAAAA,UAAU,CAACnE,SAAD,EAAY,CAAZ,CAAV;AACD;AACF;AACF,OA7BD;;AA+BAA,MAAAA,SAAS,CAAC6D,4BAAV,GAAyC,YAAM;AAC7C7D,QAAAA,SAAS,CAAC+D,kBAAV,GAA+B,KAA/B;AACAtJ,QAAAA,QAAQ,CAACyF,mBAAT,CAA6B,WAA7B,EAA0CF,SAAS,CAAC4D,8BAApD,EAAoF,KAApF;AACAnJ,QAAAA,QAAQ,CAACyF,mBAAT,CAA6B,WAA7B,EAA0CF,SAAS,CAAC4D,8BAApD,EAAoF,KAApF;AACAnJ,QAAAA,QAAQ,CAACyF,mBAAT,CAA6B,SAA7B,EAAwCF,SAAS,CAAC6D,4BAAlD,EAAgF,KAAhF;AACApJ,QAAAA,QAAQ,CAACyF,mBAAT,CAA6B,UAA7B,EAAyCF,SAAS,CAAC6D,4BAAnD,EAAiF,KAAjF;AACA1G,QAAAA,OAAO,CAAC6C,SAAS,CAAC8D,mBAAX,CAAP,IAA0C9D,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BrB,mBAA9B,CAAkDF,SAAS,CAAC8D,mBAA5D,CAA1C;AACA9D,QAAAA,SAAS,CAAC6D,4BAAV,GAAyChK,SAAzC;AACAmG,QAAAA,SAAS,CAAC4D,8BAAV,GAA2C/J,SAA3C;AACAmG,QAAAA,SAAS,CAAC8D,mBAAV,GAAgCjK,SAAhC;AACAmG,QAAAA,SAAS,CAACwD,UAAV,GAAuB,EAAvB;AACD,OAXD;;AAYA/I,MAAAA,QAAQ,CAACuG,gBAAT,CAA0B,WAA1B,EAAuChB,SAAS,CAAC4D,8BAAjD,EAAiF,KAAjF;AACAnJ,MAAAA,QAAQ,CAACuG,gBAAT,CAA0B,WAA1B,EAAuChB,SAAS,CAAC4D,8BAAjD,EAAiF,KAAjF;AACAnJ,MAAAA,QAAQ,CAACuG,gBAAT,CAA0B,SAA1B,EAAqChB,SAAS,CAAC6D,4BAA/C,EAA6E,KAA7E;AACApJ,MAAAA,QAAQ,CAACuG,gBAAT,CAA0B,UAA1B,EAAsChB,SAAS,CAAC6D,4BAAhD,EAA8E,KAA9E;AACA7D,MAAAA,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BP,gBAA9B,CAA+ChB,SAAS,CAAC8D,mBAAzD;AACD,KA9EM;AAgFPgB,IAAAA,qBAhFO,iCAgFgB/J,KAhFhB,EAgFyC;AAAA,UAAlBiF,SAAkB,uEAAN,IAAM;AAC9C,qBAAmE7G,MAAnE;AAAA,UAAQgE,OAAR,YAAQA,OAAR;AAAA,UAAiB8D,YAAjB,YAAiBA,YAAjB;AAAA,UAA+B9F,SAA/B,YAA+BA,SAA/B;AAAA,UAA0C+F,oBAA1C,YAA0CA,oBAA1C;AACAlB,MAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACE,OAAzE;AACAjE,MAAAA,OAAO,CAAC6C,SAAS,CAAC+E,kBAAX,CAAP,IAAyC/E,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BrB,mBAA9B,CAAkDF,SAAS,CAAC+E,kBAA5D,CAAzC;AACA/E,MAAAA,SAAS,CAACgF,qBAAV,GAAkCnL,SAAlC;AACAmG,MAAAA,SAAS,CAAC+E,kBAAV,GAA+BlL,SAA/B;AACAmG,MAAAA,SAAS,CAACiF,QAAV,GAAqB,IAArB;AACAjF,MAAAA,SAAS,CAACkF,mBAAV,GAAgCjE,YAAY,EAA5C;AACA,UAAM5H,KAAK,GAAG2G,SAAS,CAAC5G,MAAV,CAAiBC,KAA/B;AACA,UAAMC,MAAM,GAAGD,KAAK,CAACC,MAArB;;AACA0G,MAAAA,SAAS,CAAC+E,kBAAV,GAA+B,YAAM;AACnC/E,QAAAA,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuB+B,IAAvB,KAAgCD,SAAS,CAAC8I,aAA1C,GAA0D3K,MAAM,CAAC8K,MAAP,EAA1D,GAA4ED,UAAU,CAACnE,SAAD,EAAY,CAAZ,CAAtF;AACD,OAFD;;AAIAA,MAAAA,SAAS,CAACgF,qBAAV,GAAkC,YAAM;AACtChF,QAAAA,SAAS,CAACiF,QAAV,GAAqB,KAArB;AACAjF,QAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACE,OAAzE;AACAjE,QAAAA,OAAO,CAAC6C,SAAS,CAAC+E,kBAAX,CAAP,IAAyC/E,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BrB,mBAA9B,CAAkDF,SAAS,CAAC+E,kBAA5D,CAAzC;AACA/E,QAAAA,SAAS,CAACgF,qBAAV,GAAkCnL,SAAlC;AACAmG,QAAAA,SAAS,CAAC+E,kBAAV,GAA+BlL,SAA/B;AACD,OAND;;AAQAmG,MAAAA,SAAS,CAACzG,uBAAV,CAAkCiJ,cAAlC,CAAiDxC,SAAS,CAACgF,qBAA3D,EAAkF9D,oBAAoB,CAACE,OAAvG;AACApB,MAAAA,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BP,gBAA9B,CAA+ChB,SAAS,CAAC+E,kBAAzD;AACD,KAxGM;AA0GPI,IAAAA,sBA1GO,kCA0GiBpK,KA1GjB,EA0G0C;AAAA,UAAlBiF,SAAkB,uEAAN,IAAM;AAC/C,qBAAmE7G,MAAnE;AAAA,UAAQgE,OAAR,YAAQA,OAAR;AAAA,UAAiB8D,YAAjB,YAAiBA,YAAjB;AAAA,UAA+B9F,SAA/B,YAA+BA,SAA/B;AAAA,UAA0C+F,oBAA1C,YAA0CA,oBAA1C;AACAlB,MAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACE,OAAzE;AACAjE,MAAAA,OAAO,CAAC6C,SAAS,CAACoF,mBAAX,CAAP,IAA0CpF,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BrB,mBAA9B,CAAkDF,SAAS,CAACoF,mBAA5D,CAA1C;AACApF,MAAAA,SAAS,CAACqF,sBAAV,GAAmCxL,SAAnC;AACAmG,MAAAA,SAAS,CAACoF,mBAAV,GAAgCvL,SAAhC;AACAmG,MAAAA,SAAS,CAACsF,SAAV,GAAsB,KAAtB;AACAtF,MAAAA,SAAS,CAACuF,oBAAV,GAAiCtE,YAAY,EAA7C;AACA,UAAM5H,KAAK,GAAG2G,SAAS,CAAC5G,MAAV,CAAiBC,KAA/B;AACA,UAAMC,MAAM,GAAGD,KAAK,CAACC,MAArB;;AACA0G,MAAAA,SAAS,CAACoF,mBAAV,GAAgC,YAAM;AACpCpF,QAAAA,SAAS,CAAC5G,MAAV,CAAiBC,KAAjB,CAAuB+B,IAAvB,KAAgCD,SAAS,CAAC8I,aAA1C,GAA0D3K,MAAM,CAAC4K,OAAP,EAA1D,GAA6EC,UAAU,CAACnE,SAAD,EAAY,CAAC,CAAb,CAAvF;AACD,OAFD;;AAIAA,MAAAA,SAAS,CAACqF,sBAAV,GAAmC,YAAM;AACvCrF,QAAAA,SAAS,CAACsF,SAAV,GAAsB,KAAtB;AACAtF,QAAAA,SAAS,CAACzG,uBAAV,CAAkC4H,iBAAlC,CAAoDD,oBAAoB,CAACE,OAAzE;AACAjE,QAAAA,OAAO,CAAC6C,SAAS,CAACoF,mBAAX,CAAP,IAA0CpF,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BrB,mBAA9B,CAAkDF,SAAS,CAACoF,mBAA5D,CAA1C;AACApF,QAAAA,SAAS,CAACqF,sBAAV,GAAmCxL,SAAnC;AACAmG,QAAAA,SAAS,CAACoF,mBAAV,GAAgCvL,SAAhC;AACD,OAND;;AAQAmG,MAAAA,SAAS,CAACzG,uBAAV,CAAkCiJ,cAAlC,CAAiDxC,SAAS,CAACqF,sBAA3D,EAAmFnE,oBAAoB,CAACE,OAAxG;AACApB,MAAAA,SAAS,CAAC5G,MAAV,CAAiBkI,KAAjB,CAAuBC,MAAvB,CAA8BP,gBAA9B,CAA+ChB,SAAS,CAACoF,mBAAzD;AACD;AAlIM,GArBI;AAyJbzF,EAAAA,SAzJa,uBAyJA;AACX,SAAKpG,uBAAL,IAAgC,KAAKA,uBAAL,CAA6BqG,OAA7B,EAAhC;AACD;AA3JY,CAAf;;AA6JA,SAASuE,UAAT,CAAqBnE,SAArB,EAAgCwF,CAAhC,EAAmC;AACjC,iBAA6DrM,MAA7D;AAAA,MAAQ6B,UAAR,YAAQA,UAAR;AAAA,MAAoBkC,UAApB,YAAoBA,UAApB;AAAA,MAAgCC,OAAhC,YAAgCA,OAAhC;AAAA,MAAyCsI,SAAzC,YAAyCA,SAAzC;AAAA,MAAoDvK,IAApD,YAAoDA,IAApD;AACA,MAAM7B,KAAK,GAAG2G,SAAS,CAAC5G,MAAV,CAAiBC,KAA/B;AACA,MAAMC,MAAM,GAAGD,KAAK,CAACC,MAArB;AACA,MAAMkE,MAAM,GAAGnE,KAAK,CAACmE,MAArB;AACA,MAAMkI,WAAW,GAAG,IAAI1K,UAAJ,EAApB;AACA0K,EAAAA,WAAW,CAAC5I,CAAZ,GAAgBU,MAAM,CAACC,WAAP,GAAqB,CAArC;AACAiI,EAAAA,WAAW,CAAC7I,CAAZ,GAAgBW,MAAM,CAACE,YAAP,GAAsB,CAAtC;AACA,MAAMiI,cAAc,GAAGC,SAAS,CAAC5F,SAAD,EAAY0F,WAAZ,CAAhC;;AACA,MAAIvI,OAAO,CAACwI,cAAD,CAAX,EAA6B;AAC3B,QAAMvG,QAAQ,GAAGlC,UAAU,CAACkC,QAAX,CAAoB9F,MAAM,CAAC8E,QAA3B,EAAqCuH,cAArC,CAAjB;AACA,QAAIE,MAAM,GAAG,SAASL,CAAT,GAAa,GAA1B;AACAK,IAAAA,MAAM,GAAGzG,QAAQ,GAAG,GAAX,GAAiByG,MAAjB,GAA0B,IAAIA,MAAvC;AACA,QAAMC,MAAM,GAAG1G,QAAQ,GAAGyG,MAA1B;AACA,QAAMnH,SAAS,GAAG,EAAlB;AACAxB,IAAAA,UAAU,CAACf,QAAX,CAAoBwJ,cAApB,EAAoCrM,MAAM,CAAC8E,QAA3C,EAAqDM,SAArD;AACA,QAAMqH,WAAW,GAAG7I,UAAU,CAACqD,KAAX,CAAiBjH,MAAM,CAACqC,KAAxB,CAApB;AACA,QAAMqK,GAAG,GAAG9I,UAAU,CAAC8I,GAAX,CAAetH,SAAf,EAA0BqH,WAA1B,CAAZ;AACA,QAAME,cAAc,GAAG,EAAvB;AACA/I,IAAAA,UAAU,CAACgJ,gBAAX,CAA4BH,WAA5B,EAAyCC,GAAzC,EAA8CC,cAA9C;AACA/I,IAAAA,UAAU,CAACf,QAAX,CAAoBuC,SAApB,EAA+BuH,cAA/B,EAA+CvH,SAA/C;AACAxB,IAAAA,UAAU,CAACiJ,SAAX,CAAqBzH,SAArB,EAAgCA,SAAhC;AACApF,IAAAA,MAAM,CAAC8M,IAAP,CAAY1H,SAAZ,EAAuBoH,MAAvB;AACA,QAAMO,oBAAoB,GAAG,EAA7B;AACAnJ,IAAAA,UAAU,CAACiJ,SAAX,CAAqBR,cAArB,EAAqCU,oBAArC;AAEA,QAAMC,cAAc,GAAGpJ,UAAU,CAACX,SAAX,CAAqBoJ,cAArB,CAAvB;AACA,QAAMzH,SAAS,GAAGuH,SAAS,CAACc,cAAV,CAAyBD,cAAzB,CAAlB;AACA,QAAM1D,YAAY,GAAGtJ,MAAM,CAACuJ,aAAP,CAAqB6C,WAArB,EAAkCxH,SAAlC,CAArB;;AACA,QACEf,OAAO,CAACyF,YAAD,CAAP,IACA,CAAC4D,KAAK,CAAC5D,YAAY,CAAC9F,CAAd,CADN,IAEA,CAAC0J,KAAK,CAAC5D,YAAY,CAAC/F,CAAd,CAFN,IAGA,CAAC2J,KAAK,CAAC5D,YAAY,CAAC6D,CAAd,CAHN,IAIA,EAAEnN,MAAM,CAAC8I,oBAAP,CAA4BC,MAA5B,GAAqC,CAAvC,CALF,EAME;AACAnF,MAAAA,UAAU,CAACiJ,SAAX,CAAqBvD,YAArB,EAAmCA,YAAnC;AACA,UAAMlG,KAAK,GAAGQ,UAAU,CAACwJ,YAAX,CAAwBL,oBAAxB,EAA8CzD,YAA9C,CAAd;;AACA,UAAI,CAAC1H,IAAI,CAACyL,aAAL,CAAmBjK,KAAnB,EAA0B,CAA1B,EAA6BxB,IAAI,CAAC0L,SAAlC,CAAL,EAAmD;AACjD,YAAMC,IAAI,GAAG3J,UAAU,CAAC4J,KAAX,CAAiBT,oBAAjB,EAAuCzD,YAAvC,CAAb;AACAtJ,QAAAA,MAAM,CAACkD,MAAP,CAAcqK,IAAd,EAAoBnK,KAApB;AACD;AACF;AACF;AACF;;AAED,SAASkJ,SAAT,CAAoB5F,SAApB,EAA+B+G,aAA/B,EAA8C;AAC5C,iBAAgC5N,MAAhC;AAAA,MAAQgE,OAAR,YAAQA,OAAR;AAAA,MAAiBD,UAAjB,YAAiBA,UAAjB;AACA,MAAM7D,KAAK,GAAG2G,SAAS,CAAC5G,MAAV,CAAiBC,KAA/B;AACA,MAAMyE,KAAK,GAAGzE,KAAK,CAACyE,KAApB;AACA,MAAMxE,MAAM,GAAGD,KAAK,CAACC,MAArB;;AACA,MAAI6D,OAAO,CAACW,KAAD,CAAX,EAAoB;AAClB,QAAIkJ,iBAAJ;;AACA,QAAI3N,KAAK,CAAC4N,qBAAV,EAAiC;AAC/BD,MAAAA,iBAAiB,GAAG3N,KAAK,CAAC6N,4BAAN,CAAmCH,aAAnC,CAApB;AACD;;AACD,QAAMnJ,GAAG,GAAGtE,MAAM,CAACuE,UAAP,CAAkBkJ,aAAlB,CAAZ;AACA,QAAMI,eAAe,GAAGrJ,KAAK,CAACC,IAAN,CAAWH,GAAX,EAAgBvE,KAAhB,CAAxB;AACA,QAAM+N,YAAY,GAAGjK,OAAO,CAAC6J,iBAAD,CAAP,GACjB9J,UAAU,CAACkC,QAAX,CAAoB4H,iBAApB,EAAuC1N,MAAM,CAAC8G,UAA9C,CADiB,GAEjBiH,MAAM,CAACC,iBAFX;AAGA,QAAMC,WAAW,GAAGpK,OAAO,CAACgK,eAAD,CAAP,GAChBjK,UAAU,CAACkC,QAAX,CAAoB+H,eAApB,EAAqC7N,MAAM,CAAC8G,UAA5C,CADgB,GAEhBiH,MAAM,CAACC,iBAFX;AAGA,WAAOC,WAAW,GAAGH,YAAd,GAA6BJ,iBAA7B,GAAiDG,eAAxD;AACD;AACF;;;ACrPW,+BAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACQZ,eAAe;AACblP,EAAAA,IAAI,EAAE,kBADO;AAEbuP,EAAAA,UAAU,EAAE;AACV,qBAAiBC,WADP;AAEV,0BAAsBC;AAFZ,GAFC;AAMbrP,EAAAA,IANa,kBAML;AACN,WAAO;AACLsP,MAAAA,cAAc,EAAE;AACdC,QAAAA,aAAa,EAAE,IADD;AAEdzP,QAAAA,sBAAsB,EAAE,IAFV;AAGd0P,QAAAA,iBAAiB,EAAE;AAHL,OADX;AAMLC,MAAAA,KAAK,EAAE;AANF,KAAP;AAQD,GAfY;AAgBbC,EAAAA,MAAM,EAAE,CAACC,GAAD,CAhBK;AAiBb9P,EAAAA,KAAK,EAAE;AACL+P,IAAAA,OAAO,EAAEC;AADJ,GAjBM;AAoBbzP,EAAAA,QAAQ,EAAE;AACR0P,IAAAA,wBAAwB,EAAE,oCAAY;AACpC,aAAO;AACLvP,QAAAA,GAAG,EAAE,KAAKkP,KAAL,GAAa;AADb,OAAP;AAGD;AALO,GApBG;AA2BbM,EAAAA,KAAK,EAAE;AACLH,IAAAA,OAAO,EAAE;AACPI,MAAAA,OADO,qBACI;AACT,aAAKC,MAAL;AACD,OAHM;AAIPC,MAAAA,IAAI,EAAE;AAJC;AADJ,GA3BM;AAmCb1N,EAAAA,OAAO,EAAE;AACD2N,IAAAA,kBADC,gCACqB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAC1B,+BAAc,KAAI,CAACb,cAAnB,EAAmC,KAAI,CAACM,OAAxC;;AACA,gBAAA,KAAI,CAAC7O,MAAL,CAAYqP,aAAZ,CAA0BzH,gBAA1B,CAA2C,KAAI,CAACyH,aAAhD;;AACA,gBAAA,KAAI,CAACA,aAAL;;AAH0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAI3B,KALM;AAMDC,IAAAA,KANC,mBAMQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDACN,IADM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEd,KARM;AASDC,IAAAA,OATC,qBASU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDACR,IADQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEhB,KAXM;AAYPF,IAAAA,aAZO,2BAYU;AACf,UAAQrP,MAAR,GAAmB,IAAnB,CAAQA,MAAR;AACA,UAAI0O,KAAK,GAAG,CAAZ;AACA1O,MAAAA,MAAM,CAACwP,QAAP,KAAoBd,KAAK,IAAI1O,MAAM,CAACwP,QAAP,CAAgBnN,qBAAhB,GAAwC4G,MAArE;AACA,WAAKyF,KAAL,GAAaA,KAAb;AACD;AAjBM,GAnCI;AAsDbe,EAAAA,SAAS,EAAE;AACTC,IAAAA,KADS,mBACA;AACP,aAAO,KAAKC,QAAL,CAAc9Q,IAArB;AACD;AAHQ,GAtDE;AA2Db+Q,EAAAA,OA3Da,qBA2DF;AAAA;;AACTd,IAAAA,MAAM,CAACe,gBAAP,CAAwB,IAAxB,EAA8B;AAC5BC,MAAAA,gBAAgB,EAAE;AAChBC,QAAAA,UAAU,EAAE,IADI;AAEhBC,QAAAA,GAAG,EAAE;AAAA,iBAAM,MAAI,CAACC,SAAL,IAAkB,MAAI,CAACC,YAA7B;AAAA;AAFW;AADU,KAA9B;AAMD;AAlEY,CAAf;;;ACRY,+BAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDZ,SAASC,MAAT,CAAiBC,GAAjB,EAAoC;AAAA;AAClC,MAAID,MAAM,CAACE,SAAX,EAAsB;AACpB;AACD;;AACDF,EAAAA,MAAM,CAACE,SAAP,GAAmB,IAAnB;AAEAD,EAAAA,GAAG,CAACE,SAAJ,CAAcC,cAAc,CAAC1R,IAA7B,EAAmC0R,cAAnC;AACD;;;;;"}