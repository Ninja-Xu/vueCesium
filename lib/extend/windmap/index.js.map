{"version":3,"file":"index.js","sources":["src/components/extend/windmap/VcWindMap.vue?rollup-plugin-vue=script.js","src/components/extend/windmap/VcWindMap.vue","src/components/extend/windmap/index.js"],"sourcesContent":["\nimport cmp from '../../../mixins/virtualCmp'\nimport colorTable from '../../../exts/wind/colorTable'\nimport Wind3D from '../../../exts/wind/wind3D'\nexport default {\n  name: 'vc-windmap',\n  mixins: [cmp],\n  props: {\n    data: Object,\n    colorTable: {\n      type: Object,\n      default: () => {\n        return colorTable\n      }\n    },\n    particleSystemOptions: {\n      type: Object,\n      default: function () {\n        return {\n          particlesTextureSize: 128,\n          maxParticles: 128 * 128,\n          particleHeight: 100.0,\n          fadeOpacity: 0.996,\n          dropRate: 0.003,\n          dropRateBump: 0.01,\n          speedFactor: 4.0,\n          lineWidth: 4.0\n        }\n      }\n    }\n  },\n  watch: {\n    data (val) {\n      this.reload()\n    },\n    particleSystemOptions: {\n      handler (val) {\n        this.windMap.particleSystem.applyParticleSystemOptions(val)\n      },\n      deep: true\n    }\n  },\n  methods: {\n    async createCesiumObject () {\n      const { viewer, particleSystemOptions } = this\n      if (!this.isEmptyObj(this.data)) {\n        this.data.colorTable = this.loadColorTable()\n        const windMap = new Wind3D(viewer, this.data, particleSystemOptions)\n        return windMap\n      }\n      return true\n    },\n    loadColorTable () {\n      const json = this.colorTable\n      const colorNum = json.ncolors\n      const colorTable = json.colorTable\n      const colorsArray = new Float32Array(3 * colorNum)\n      for (let i = 0; i < colorNum; i++) {\n        colorsArray[3 * i] = colorTable[3 * i]\n        colorsArray[3 * i + 1] = colorTable[3 * i + 1]\n        colorsArray[3 * i + 2] = colorTable[3 * i + 2]\n      }\n      const result = {}\n      result.colorNum = colorNum\n      result.array = colorsArray\n      return result\n    },\n    async mount () {\n      return true\n    },\n    async unmount () {\n      if (!this.isEmptyObj(this.windMap)) {\n        this.windMap.destroy()\n      }\n      return true\n    }\n  },\n  stubVNode: {\n    empty () {\n      return this.$options.name\n    }\n  },\n  created () {\n    Object.defineProperties(this, {\n      windMap: {\n        enumerable: true,\n        get: () => this.$services && this.cesiumObject\n      }\n    })\n  }\n}\n","<script>\nimport cmp from '../../../mixins/virtualCmp'\nimport colorTable from '../../../exts/wind/colorTable'\nimport Wind3D from '../../../exts/wind/wind3D'\nexport default {\n  name: 'vc-windmap',\n  mixins: [cmp],\n  props: {\n    data: Object,\n    colorTable: {\n      type: Object,\n      default: () => {\n        return colorTable\n      }\n    },\n    particleSystemOptions: {\n      type: Object,\n      default: function () {\n        return {\n          particlesTextureSize: 128,\n          maxParticles: 128 * 128,\n          particleHeight: 100.0,\n          fadeOpacity: 0.996,\n          dropRate: 0.003,\n          dropRateBump: 0.01,\n          speedFactor: 4.0,\n          lineWidth: 4.0\n        }\n      }\n    }\n  },\n  watch: {\n    data (val) {\n      this.reload()\n    },\n    particleSystemOptions: {\n      handler (val) {\n        this.windMap.particleSystem.applyParticleSystemOptions(val)\n      },\n      deep: true\n    }\n  },\n  methods: {\n    async createCesiumObject () {\n      const { viewer, particleSystemOptions } = this\n      if (!this.isEmptyObj(this.data)) {\n        this.data.colorTable = this.loadColorTable()\n        const windMap = new Wind3D(viewer, this.data, particleSystemOptions)\n        return windMap\n      }\n      return true\n    },\n    loadColorTable () {\n      const json = this.colorTable\n      const colorNum = json.ncolors\n      const colorTable = json.colorTable\n      const colorsArray = new Float32Array(3 * colorNum)\n      for (let i = 0; i < colorNum; i++) {\n        colorsArray[3 * i] = colorTable[3 * i]\n        colorsArray[3 * i + 1] = colorTable[3 * i + 1]\n        colorsArray[3 * i + 2] = colorTable[3 * i + 2]\n      }\n      const result = {}\n      result.colorNum = colorNum\n      result.array = colorsArray\n      return result\n    },\n    async mount () {\n      return true\n    },\n    async unmount () {\n      if (!this.isEmptyObj(this.windMap)) {\n        this.windMap.destroy()\n      }\n      return true\n    }\n  },\n  stubVNode: {\n    empty () {\n      return this.$options.name\n    }\n  },\n  created () {\n    Object.defineProperties(this, {\n      windMap: {\n        enumerable: true,\n        get: () => this.$services && this.cesiumObject\n      }\n    })\n  }\n}\n</script>\n","import VcWindMap from './VcWindMap.vue'\n\nfunction plugin (Vue, options = {}) {\n  if (plugin.installed) {\n    return\n  }\n  plugin.installed = true\n  Vue.component(VcWindMap.name, VcWindMap)\n}\n\nexport default plugin\n\nexport {\n  VcWindMap,\n  plugin as install\n}\n"],"names":["name","mixins","cmp","props","data","Object","colorTable","type","default","particleSystemOptions","particlesTextureSize","maxParticles","particleHeight","fadeOpacity","dropRate","dropRateBump","speedFactor","lineWidth","watch","val","reload","handler","windMap","particleSystem","applyParticleSystemOptions","deep","methods","createCesiumObject","viewer","isEmptyObj","loadColorTable","Wind3D","json","colorNum","ncolors","colorsArray","Float32Array","i","result","array","mount","unmount","destroy","stubVNode","empty","$options","created","defineProperties","enumerable","get","$services","cesiumObject","plugin","Vue","installed","component","VcWindMap"],"mappings":"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"}