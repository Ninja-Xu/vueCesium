{"version":3,"file":"util.js","sources":["src/utils/util.js"],"sourcesContent":["const toString = Object.prototype.toString\n\nexport const checkType = (val) => Object.prototype.toString.call(val).slice(8, -1)\n\nexport const toKebabCase = (str) => str.replace(/[A-Z]/g, (letter) => `-${letter.toLowerCase()}`).replace(/^-/, '')\n\nexport const clone = (object, deep) => {\n  if (object === null || typeof object !== 'object') {\n    return object\n  }\n\n  deep = deep || false\n\n  const result = new object.constructor()\n  for (const propertyName in object) {\n    if (Object.prototype.hasOwnProperty.call(object, propertyName)) {\n      let value = object[propertyName]\n      if (deep) {\n        value = clone(value, deep)\n      }\n      result[propertyName] = value\n    }\n  }\n\n  return result\n}\n\nexport function getString (arrayBuffer, encoding) {\n  if (!(arrayBuffer instanceof Uint8Array) && !(arrayBuffer instanceof ArrayBuffer) && arrayBuffer.buffer) {\n    arrayBuffer = arrayBuffer.buffer\n  }\n  const decoder = new TextDecoder(encoding)\n  const decodedText = decoder.decode(arrayBuffer, { stream: true })\n  return decodedText\n}\n\nexport function isEmptyObj (o) {\n  if (isUndefined(o)) {\n    return true\n  }\n\n  if (o instanceof Element) {\n    return false\n  }\n\n  const arr = Object.keys(o)\n  return arr.length === 0\n}\n/**\n * 通过 class 名获取 Dom 元素。\n * @param {Array<Element>} htmlCollection Dom元素集合。\n * @param {String} className class 名称。\n */\nexport const getDocumentByClassName = (htmlCollection, className) => {\n  let temp\n  const BreakException = {}\n  try {\n    Array.prototype.slice.call(htmlCollection).forEach((element) => {\n      if (element.className === className) {\n        temp = element\n        throw BreakException\n      }\n    })\n  } catch (e) {\n    if (e !== BreakException) throw e\n  }\n  return temp\n}\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nexport function isArray (val) {\n  return toString.call(val) === '[object Array]'\n}\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nexport function isObject (val) {\n  return val !== null && typeof val === 'object'\n}\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nexport function isString (val) {\n  return typeof val === 'string'\n}\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nexport function isNumber (val) {\n  return typeof val === 'number'\n}\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nexport function isUndefined (val) {\n  return typeof val === 'undefined'\n}\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nexport function isFunction (val) {\n  return toString.call(val) === '[object Function]'\n}\n/**\n * 验证是否是经纬度。\n * @param {Number} longitude\n * @param {Number} latitude\n * @returns {Boolean}\n */\nexport function lnglatValidator (longitude, latitude) {\n  // 经度，整数部分为0-180小数部分为0到6位\n  const longreg = /^(-|\\+)?(((\\d|[1-9]\\d|1[0-7]\\d|0{1,3})\\.\\d{0,15})|(\\d|[1-9]\\d|1[0-7]\\d|0{1,3})|180\\.0{0,15}|180)$/\n  if (!longreg.test(longitude)) {\n    return false\n  } // 纬度,整数部分为0-90小数部分为0到6位\n  const latreg = /^(-|\\+)?([0-8]?\\d{1}\\.\\d{0,15}|90\\.0{0,15}|[0-8]?\\d{1}|90)$/\n  if (!latreg.test(latitude)) {\n    return false\n  }\n  return true\n}\n\nexport function dirname (path) {\n  if (typeof path !== 'string') path = path + ''\n  if (path.length === 0) return '.'\n  let code = path.charCodeAt(0)\n  const hasRoot = code === 47 /* / */\n  let end = -1\n  let matchedSlash = true\n  for (let i = path.length - 1; i >= 1; --i) {\n    code = path.charCodeAt(i)\n    if (code === 47 /* / */) {\n      if (!matchedSlash) {\n        end = i\n        break\n      }\n    } else {\n      // We saw the first non-path separator\n      matchedSlash = false\n    }\n  }\n\n  if (end === -1) return hasRoot ? '/' : '.'\n  if (hasRoot && end === 1) {\n    // return '//';\n    // Backwards-compat fix:\n    return '/'\n  }\n  return path.slice(0, end)\n}\n\nexport function Platform () {\n  const ua = navigator.userAgent\n  const isWindowsPhone = /(?:Windows Phone)/.test(ua)\n  const isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone\n  const isAndroid = /(?:Android)/.test(ua)\n  const isFireFox = /(?:Firefox)/.test(ua)\n  const isChrome = /(?:Chrome|CriOS)/.test(ua)\n  const isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua))\n  const isPhone = /(?:iPhone)/.test(ua) && !isTablet\n  const isPc = !isPhone && !isAndroid && !isSymbian\n  return {\n    isTablet: isTablet,\n    isPhone: isPhone,\n    isAndroid: isAndroid,\n    isPc: isPc,\n    isChrome: isChrome\n  }\n}\n\nexport function captureScreenshot (viewer, showSplitter = false) {\n  const { when } = Cesium\n  const deferred = when.defer()\n  const scene = viewer.scene\n  const removeCallback = scene.postRender.addEventListener(function () {\n    removeCallback()\n    try {\n      const cesiumCanvas = viewer.scene.canvas\n\n      // If we're using the splitter, draw the split position as a vertical white line.\n      const canvas = cesiumCanvas\n      // if (showSplitter) {\n      //   canvas = document.createElement('canvas')\n      //   canvas.width = cesiumCanvas.width\n      //   canvas.height = cesiumCanvas.height\n\n      //   const context = canvas.getContext('2d')\n      //   context.drawImage(cesiumCanvas, 0, 0)\n\n      //   const x = viewer.splitPosition * cesiumCanvas.width\n      //   context.strokeStyle = this.terria.baseMapContrastColor\n      //   context.beginPath()\n      //   context.moveTo(x, 0)\n      //   context.lineTo(x, cesiumCanvas.height)\n      //   context.stroke()\n      // }\n\n      deferred.resolve(canvas.toDataURL('image/png'))\n    } catch (e) {\n      deferred.reject(e)\n    }\n  }, this)\n\n  scene.render(viewer.clock.currentTime)\n\n  return deferred.promise\n}\n\nexport function getAllAttribution (viewer) {\n  const credits = viewer.scene.frameState.creditDisplay._currentFrameCredits.screenCredits.values.concat(\n    viewer.scene.frameState.creditDisplay._currentFrameCredits.lightboxCredits.values\n  )\n  return credits.map((credit) => credit.html)\n}\n\nexport function drawTriangle (options) {\n  if (!options) {\n    throw new Error('options is required')\n  }\n  if (!options.width) {\n    throw new Error('options.width is required')\n  }\n  if (!options.height) {\n    throw new Error('options.height is required')\n  }\n  options.backgroundColor = options.backgroundColor || 'black'\n  options.borderColor = options.borderColor || 'orange'\n  options.borderWidth = options.borderWidth || 1\n\n  const cv = document.createElement('canvas')\n  cv.width = options.width\n  cv.height = options.height\n  const ctx = cv.getContext('2d')\n  ctx.beginPath()\n  if (options.direction === 1) {\n    // left\n    ctx.moveTo(cv.width, 0)\n    ctx.lineTo(0, cv.height / 2)\n    ctx.lineTo(cv.width, cv.height)\n  } else if (options.direction === 2) {\n    // top\n    ctx.moveTo(0, cv.height)\n    ctx.lineTo(cv.width / 2, 0)\n    ctx.lineTo(cv.width, cv.height)\n  } else if (options.direction === 3) {\n    // right\n    ctx.moveTo(0, cv.height)\n    ctx.lineTo(cv.width, cv.height / 2)\n    ctx.lineTo(0, 0)\n  } else {\n    // bottom\n    ctx.moveTo(0, 0)\n    ctx.lineTo(cv.width / 2, cv.height)\n    ctx.lineTo(cv.width, 0)\n  }\n  ctx.lineJoin = 'round' // 两条线交汇时的边角类型（miter 尖角默认  bevel斜角 round 圆角 ）\n\n  if (options.backgroundColor) {\n    ctx.fillStyle = options.backgroundColor.toCssColorString()\n    ctx.fill()\n  }\n  if (options.border) {\n    ctx.lineWidth = options.borderWidth\n    ctx.strokeStyle = options.borderColor.toCssColorString()\n    ctx.stroke()\n  }\n  return cv\n}\n\nexport function drawText (text, options) {\n  options = options || {\n    font: '20px sans-serif'\n  }\n  const backcolor = options.backgroundColor\n  const padding = options.padding\n  delete options.backgroundColor\n  delete options.padding\n\n  const lines = text.split(/[\\r]?\\n+/)\n  const lineImgs = []\n  let w = 0\n  let h = 0\n  for (let i = 0; i < lines.length; i++) {\n    const tempCv = Cesium.writeTextToCanvas(lines[i], options)\n    if (tempCv) {\n      lineImgs.push(tempCv)\n      h += tempCv.height\n      w = Math.max(w, tempCv.width)\n    }\n  }\n  options.backgroundColor = backcolor\n  options.padding = padding\n\n  let cv = options.canvas\n  if (!cv) {\n    w += padding * 2\n    h += padding * 2.25\n    cv = document.createElement('canvas')\n    cv.width = w\n    cv.height = h\n  }\n\n  const ctx = cv.getContext('2d')\n  if (backcolor) {\n    ctx.fillStyle = backcolor.toCssColorString()\n  } else {\n    ctx.fillStyle = undefined\n  }\n\n  if (options.border) {\n    ctx.lineWidth = options.borderWidth\n    ctx.strokeStyle = options.borderColor.toCssColorString()\n  }\n\n  if (!options.borderRadius) {\n    if (backcolor) {\n      ctx.fillRect(0, 0, cv.width, cv.height)\n    }\n\n    if (options.border) {\n      ctx.strokeRect(0, 0, cv.width, cv.height)\n    }\n  } else {\n    drawRoundedRect(\n      {\n        x: 0,\n        y: 0,\n        width: cv.width,\n        height: cv.height\n      },\n      options.borderRadius,\n      ctx\n    )\n  }\n\n  delete ctx.strokeStyle\n  delete ctx.fillStyle\n  let y = 0\n  for (let i = 0; i < lineImgs.length; i++) {\n    ctx.drawImage(lineImgs[i], 0 + padding, y + padding)\n    y += lineImgs[i].height\n  }\n  return cv\n}\n\nfunction drawRoundedRect (rect, r, ctx) {\n  ctx.beginPath()\n\n  ctx.moveTo(rect.x + r, rect.y)\n  ctx.arcTo(rect.x + rect.width, rect.y, rect.x + rect.width, rect.y + rect.height, r)\n  ctx.arcTo(rect.x + rect.width, rect.y + rect.height, rect.x, rect.y + rect.height, r)\n  ctx.arcTo(rect.x, rect.y + rect.height, rect.x, rect.y, r)\n  ctx.arcTo(rect.x, rect.y, rect.x + r, rect.y, r)\n\n  ctx.fill()\n  ctx.stroke()\n}\n\nexport function getExtension (fileName) {\n  const start = fileName.lastIndexOf('.')\n  if (start >= 0) {\n    return fileName.substring(start, fileName.length)\n  }\n  return ''\n}\n\nexport function changeExtension (fname, newExt) {\n  return fname.replace(getExtension(fname), newExt)\n}\n\nexport function readAsArrayBuffer (file) {\n  const promise = Cesium.when.defer()\n  const fr = new FileReader()\n  fr.onload = function (e) {\n    promise.resolve(e.target.result)\n  }\n  fr.onprogress = function (e) {\n    promise.progress(e.target.result)\n  }\n  fr.onerror = function (e) {\n    promise.reject(e.error)\n  }\n  fr.readAsArrayBuffer(file)\n  return promise\n}\n\nexport function readAsText (file) {\n  const promise = Cesium.when.defer()\n  const fr = new FileReader()\n  fr.onload = function (e) {\n    promise.resolve(e.target.result)\n  }\n  fr.onprogress = function (e) {\n    promise.progress(e.target.result)\n  }\n  fr.onerror = function (e) {\n    promise.reject(e.error)\n  }\n  fr.readAsText(file)\n  return promise\n}\n\nexport function readAllBytes (file) {\n  const promise = Cesium.when.defer()\n  const fr = new FileReader()\n  fr.onload = function (e) {\n    promise.resolve(new Uint8Array(e.target.result))\n  }\n  fr.onprogress = function (e) {\n    promise.progress(e.target.result)\n  }\n  fr.onerror = function (e) {\n    promise.reject(e.error)\n  }\n  fr.readAsArrayBuffer(file)\n  return promise\n}\n"],"names":["toString","Object","prototype","checkType","val","call","slice","toKebabCase","str","replace","letter","toLowerCase","clone","object","deep","result","constructor","propertyName","hasOwnProperty","value","getString","arrayBuffer","encoding","Uint8Array","ArrayBuffer","buffer","decoder","TextDecoder","decodedText","decode","stream","isEmptyObj","o","isUndefined","Element","arr","length","getDocumentByClassName","htmlCollection","className","temp","BreakException","Array","forEach","element","e","isArray","isObject","isString","isNumber","isFunction","lnglatValidator","longitude","latitude","longreg","test","latreg","dirname","path","code","charCodeAt","hasRoot","end","matchedSlash","i","Platform","ua","navigator","userAgent","isWindowsPhone","isSymbian","isAndroid","isFireFox","isChrome","isTablet","isPhone","isPc","captureScreenshot","viewer","Cesium","when","deferred","defer","scene","removeCallback","postRender","addEventListener","cesiumCanvas","canvas","resolve","toDataURL","reject","render","clock","currentTime","promise","getAllAttribution","credits","frameState","creditDisplay","_currentFrameCredits","screenCredits","values","concat","lightboxCredits","map","credit","html","drawTriangle","options","Error","width","height","backgroundColor","borderColor","borderWidth","cv","document","createElement","ctx","getContext","beginPath","direction","moveTo","lineTo","lineJoin","fillStyle","toCssColorString","fill","border","lineWidth","strokeStyle","stroke","drawText","text","font","backcolor","padding","lines","split","lineImgs","w","h","tempCv","writeTextToCanvas","push","Math","max","undefined","borderRadius","fillRect","strokeRect","drawRoundedRect","x","y","drawImage","rect","r","arcTo","getExtension","fileName","start","lastIndexOf","substring","changeExtension","fname","newExt","readAsArrayBuffer","file","fr","FileReader","onload","target","onprogress","progress","onerror","error","readAsText","readAllBytes"],"mappings":"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"}